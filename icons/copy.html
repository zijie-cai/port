<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <script>
    // Lightweight i18n bootstrap: URL param, storage, and reload helper
    (function () {
      const storageKey = 'selectedLang';
      function getUrlLang() {
        try {
          const p = new URLSearchParams(window.location.search);
          const l = (p.get('lang') || '').toLowerCase();
          return ['en','zh','ja'].includes(l) ? l : null;
        } catch (_) { return null; }
      }
      function setUrlLang(lang) {
        try {
          const url = new URL(window.location.href);
          url.searchParams.set('lang', lang);
          return url.toString();
        } catch (_) { return null; }
      }
      function getInitialLang() {
        // Priority: URL ?lang => localStorage => document lang => 'en'
        const fromUrl = getUrlLang();
        if (fromUrl) {
          try { localStorage.setItem(storageKey, fromUrl); } catch (_) {}
          return fromUrl;
        }
        const stored = (()=>{ try { return localStorage.getItem(storageKey); } catch (_) { return null; } })();
        if (stored && ['en','zh','ja'].includes(stored)) return stored;
        const htmlLang = (document.documentElement.getAttribute('lang') || '').toLowerCase();
        if (['en','zh','ja'].includes(htmlLang)) return htmlLang;
        return 'en';
      }
      function reflectLang(lang) {
        document.documentElement.setAttribute('lang', lang);
        try { localStorage.setItem(storageKey, lang); } catch (_) {}
        // Expose for later scripts
        window.__selectedLang = lang;
      }
      function setLangAndReload(lang, { skipVisited } = {}) {
        if (!['en','zh','ja'].includes(lang)) lang = 'en';
        try { localStorage.setItem(storageKey, lang); } catch (_) {}
        if (!skipVisited) try { localStorage.setItem('hasVisited', 'true'); } catch (_) {}
        const next = setUrlLang(lang);
        if (next) {
          window.location.href = next;
        } else {
          // Fallback if URL API unavailable
          window.location.search = `?lang=${lang}`;
        }
      }
      // Initialize on parse
      reflectLang(getInitialLang());
      // Export helpers
      window.__i18n = { getInitialLang, setLangAndReload };
    })();
  </script>
  <script>
    (function() {
      if (localStorage.getItem("hasVisited")) {
        document.write('<style>#languageOverlay{display:none !important;}</style>');
      }
    })();
  </script>
  <script>
    // Bootstrap theme early to avoid FOUC
    (function () {
      const storageKey = 'theme-preference';
      const getPreferred = () => {
        const stored = localStorage.getItem(storageKey);
        if (stored === 'light' || stored === 'dark') return stored;
        return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      };
      const theme = getPreferred();
      document.documentElement.setAttribute('data-theme', theme);
      // expose current for later scripts
      window.__themePref = theme;
    })();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Zijie Cai — AI Engineer, Researcher, and Creator. Projects include AI SaaS products, computer vision research, and interactive web experiments." />
  <meta property="og:title" content="Zijie Cai — Portfolio" />
  <meta property="og:description" content="AI Engineer • Researcher • Creator — AItinerary, AI Sandbox, depth estimation research, interactive web experiments." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/images/og-card.jpg" />
  <meta name="theme-color" content="#111111" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#f4f4f6" media="(prefers-color-scheme: light)">
  <title>Zijie Cai — Portfolio</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  
  <style>
@import "https://unpkg.com/open-props/easings.min.css";

    /* Floating background shapes */
.background-shapes {
  position: fixed;
  inset: 0;
  overflow: hidden;
  z-index: -1; /* stays behind all content */
  pointer-events: none;
}
#siteContent {
  display: none;
}
#siteContent.visible {
  display: block;
}

  .floating-shape {
    position: absolute;
    border-radius: 28px;
    opacity: 0;
    filter: blur(1px);
    animation: floatShape linear infinite;
    will-change: transform, opacity;
    width: var(--size, 60px);
    height: var(--size, 60px);
  }

  /* Left side icons */
.code-icon {
  position: fixed;
  top: 120px;
  left: 60px;
  width: 70px;
  height: 70px;
  animation: slideLeftRight 3s ease-in-out infinite;
}

.coffee-icon {
  position: fixed;
  top: 450px; /* pushed lower than code */
  left: 40px;
  width: 70px;
  height: 70px;
  animation: floatCoffeeTilt 4s ease-in-out infinite;
}

.world-icon {
  position: fixed;
  bottom: 100px;
  left: 80px;
  width: 80px;
  height: 80px;
  animation: rotateInPlace 12s linear infinite;
}

/* Right side icons */
.cooking-icon {
  position: fixed;
  top: 420px;
  right: 40px;
  width: 85px;
  height: 85px;
  animation: wokStir 2.2s ease-in-out infinite;
}

  .game-icon {
    position: fixed;
    top: 120px; /* middle-right */
    right: 100px;
    width: 80px;
    height: 80px;
    animation: controllerShake 1.8s ease-in-out infinite;
  }

.soccer-wrapper {
  position: fixed;
  bottom: 100px;
  right: 60px;
}
.soccer-icon {
  width: 70px;
  height: 70px;
  animation: bounce2 2s ease infinite;
}
@keyframes controllerPulse {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.1) rotate(-3deg); }
  50% { transform: scale(1.05) rotate(3deg); }
  75% { transform: scale(1.1) rotate(-2deg); }
}

@keyframes joystickShake {
  0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); }
  20% { transform: translate(-5px, 2px) rotate(-5deg) scale(1.05); }
  40% { transform: translate(5px, -2px) rotate(5deg) scale(0.95); }
  60% { transform: translate(-4px, 2px) rotate(-3deg) scale(1.02); }
  80% { transform: translate(4px, -2px) rotate(3deg) scale(0.98); }
}

@keyframes controllerBounce {
  0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
  20% { transform: translateY(-12px) rotate(-4deg) scale(1.05); }
  40% { transform: translateY(-20px) rotate(4deg) scale(0.95); }
  60% { transform: translateY(-10px) rotate(-3deg) scale(1.02); }
  80% { transform: translateY(-4px) rotate(3deg) scale(0.98); }
}

@keyframes controllerShake {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  15% { transform: translate(-6px, 2px) rotate(-6deg); }
  30% { transform: translate(6px, -2px) rotate(6deg); }
  45% { transform: translate(-4px, 1px) rotate(-4deg); }
  60% { transform: translate(4px, -1px) rotate(4deg); }
  75% { transform: translate(-3px, 2px) rotate(-3deg); }
}


  
  .bounce2 {
    animation: bounce2 2s ease infinite;
  }
  @keyframes bounce2 {
    0%, 20%, 50%, 80%, 100% { transform: translate(-50%, 0) rotate(0deg); }
    40% { transform: translate(-50%, -30px) rotate(0deg); }
    60% { transform: translate(-50%, -15px) rotate(0deg); }
  }
  
  /* Old floatCoffee animation (replaced by floatCoffeeTilt) */
  /*
  @keyframes floatCoffee {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-20px); }
  }
  */

  @keyframes floatCoffeeTilt {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    25% { transform: translateY(-15px) rotate(0deg); }
    50% { transform: translateY(-25px) rotate(45deg); }
    75% { transform: translateY(-10px) rotate(0deg); }
  }

  
  @keyframes floatCooking {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-25px); }
  }
  
  @keyframes wokStir {
    0%, 100% { transform: rotate(0deg) scale(1); }
    20% { transform: rotate(-15deg) scale(1.05); }
    40% { transform: rotate(32deg) scale(0.95); }
    60% { transform: rotate(-10deg) scale(1.02); }
    80% { transform: rotate(28deg) scale(0.98); }
  }
  @keyframes sizzleCooking {
    0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
    20% { transform: translateY(-10px) rotate(-3deg) scale(1.05); }
    40% { transform: translateY(-20px) rotate(3deg) scale(0.95); }
    60% { transform: translateY(-12px) rotate(-2deg) scale(1.05); }
    80% { transform: translateY(-5px) rotate(2deg) scale(0.98); }
  }
  
  
  @keyframes rotateInPlace {
    from { transform: rotate(0deg); }
    to { transform: rotate(-360deg); }
  }
  
  /* Eyes floating shape: start more toward top border */
  
  @keyframes slideLeftRight {
    0% { transform: translateX(0); }
    50% { transform: translateX(40px); }
    100% { transform: translateX(0); }
  }

/* Rising cube animation */
@keyframes floatShape {
  0% {
    transform: translateY(120vh) rotate(0deg) scale(0.9);
    opacity: 0;
  }
  10% {
    opacity: 0.7;
  }
  50% {
    transform: translateY(50vh) rotate(-180deg) scale(1);
    opacity: 1;
  }
  90% {
    opacity: 0.5;
  }
  100% {
    transform: translateY(-20vh) rotate(-360deg) scale(0.95);
    opacity: 0;
  }
}


    .scroll-down {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      animation: glideDown 2s infinite;
      color: var(--accent-color);
      text-decoration: none;
      opacity: 0.8;
    }
    .scroll-down:hover {
      opacity: 1;
    }
    @keyframes glideDown {
      0%, 100% { transform: translate(-50%, 0); }
      50% { transform: translate(-50%, 12px); }
    }


    /* --- Load-in + Scroll Reveal Animations --- */
    :root { --load-dur: .7s; --reveal-dur: .6s; }
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
    }
    body.preload .pronounce-btn {
  opacity: 0;
  transform: scale(0.8);
}

/* Visitor map loading spinner */
.map-spinner {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  border: 4px solid rgba(0,0,0,.15);
  border-top-color: var(--accent-color);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  z-index: 3;
}
@keyframes spin {
  to { transform: translate(-50%, -50%) rotate(360deg); }
}
.map-spinner.fade-out {
  opacity: 0;
  transition: opacity .4s ease;
  pointer-events: none;
}

[data-theme="dark"] .map-spinner.fade-out {
  opacity: 0;
  transition: opacity .4s ease;
  pointer-events: none;
}

body.loaded .pronounce-btn {
  opacity: 1;
  transform: scale(1);
  transition: opacity 0.6s ease-out 1.3s, transform 0.6s ease-out 1.3s;
}
    /* Top-level load-in (hero + nav) */
    body.preload .fade-up {
      opacity: 0;
      transform: translateY(18px);
    }
    body.loaded .fade-up {
      opacity: 1;
      transform: translateY(0);
      transition: opacity var(--load-dur) ease, transform var(--load-dur) ease;
    }
    /* Section scroll-reveal (kept separate to not fight theme toggling) */
    .reveal {
      opacity: 0;
      transform: translateY(24px);
    }
    .reveal.visible {
      opacity: 1;
      transform: translateY(0);
      transition: opacity .6s ease, transform .6s ease;
    }
    
  .language-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  /* Ensure the overlay (and its children) render above all effects */
  z-index: 5000;
  background: var(--bg);
  color: var(--text-color);
  opacity: 1;
  visibility: visible;
  transition: background 0.5s ease, opacity 0.6s ease;
  }
.language-overlay::before, .language-overlay::after { content: none; }
.language-overlay.hidden {
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.6s ease;
}

/* Mobile settings card layout */
.settings-card {
  position: relative;
  inline-size: min(340px, 92vw);
  min-block-size: 400px;
  background: var(--surface-1);
  border-radius: 20px;
  border: 1px solid color-mix(in oklab, var(--accent-color) 14%, transparent);
  box-shadow: 0 30px 60px rgba(0,0,0,.35);
  padding: .75rem;
  padding-bottom: 3.2rem; /* space for floating enter button */
  animation: sheetPop .42s var(--ease-3) both;
}
.settings-header { padding: .2rem .2rem .5rem; text-align: left; }
.settings-hero { 
  display: grid; 
  grid-template-columns: auto 1fr; 
  align-items: center; 
  column-gap: 1.2rem; 
  margin: .25rem .25rem .35rem; 
}
.settings-hero .settings-header { padding: 0; padding-left: .15rem; }
.settings-hero .lang-logo-wrap { min-width: 84px; display: inline-grid; place-items: center; }
.settings-hero .settings-title { margin: 0; }
.settings-hero .settings-subtitle { margin: .15rem 0 0; }
.settings-title { margin: 0; font-size: 1.2rem; }
.settings-subtitle { margin: .2rem 0 0; font-size: .95rem; color: color-mix(in oklab, var(--text-color) 60%, transparent); }

/* Modal sheet handle for visual affordance */
.sheet-handle {
  width: 36px;
  height: 4px;
  border-radius: 999px;
  background: color-mix(in oklab, var(--text-color) 30%, transparent);
  opacity: .6;
  margin: .25rem auto .5rem;
}

@keyframes sheetPop {
  0% { opacity: 0; transform: translateY(10px) scale(.98); filter: blur(4px); }
  100% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
}

.settings-section {
  background: color-mix(in oklab, var(--bg) 8%, transparent);
  border: 1px solid color-mix(in oklab, var(--accent-color) 10%, transparent);
  border-radius: 14px;
  padding: .2rem;
  margin: .4rem 0;
}
.settings-item { 
  display: flex; align-items: center; justify-content: space-between; 
  gap: .6rem; padding: .65rem .6rem; border-bottom: 1px solid rgba(0,0,0,.08);
}
.settings-item:last-child { border-bottom: 0; }
.item-text { display: grid; gap: .15rem; }
.item-title { font-weight: 800; }
.item-sub { font-size: .9rem; color: color-mix(in oklab, var(--text-color) 60%, transparent); }

/* Make the overlay theme toggle sit nicely as a row control */
.settings-item .overlay-theme{ margin: 0; background: transparent; border: 0; box-shadow: none; padding: 0; }
.settings-item .overlay-theme .theme-label{ font-size: .9rem; }
.settings-item .theme-toggle{ inline-size: 38px; block-size: 38px; }

/* Language row behaves like a settings row with expandable menu */
.settings-row-btn {
  inline-size: 100%;
  display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: .5rem;
  padding: .65rem .6rem; border-radius: 10px; border: 0; cursor: pointer; background: transparent; color: inherit; font: inherit;
  min-height: 44px;
}
.settings-row-btn .chev { width: 18px; height: 18px; opacity: .8; }
.settings-row-btn:hover { background: color-mix(in oklab, var(--accent-color) 10%, transparent); }

/* Constrain dropdown to card width and align under row */
.settings-card .lang-dd { --w: 100%; }
.settings-card .lang-switcher { margin: 0; width: 100%; align-self: stretch; }
.settings-card .lang-dd .lang-menu { left: 0; right: 0; margin: 0 auto; }
.settings-row-btn { text-align: left; justify-content: start; }

/* Float the enter action within the card */
.settings-card .enter-btn { position: absolute; left: 0; right: 0; bottom: 0.5rem; margin: 0 auto; }

/* Subtle one-time ping to draw attention */
.enter-btn::after {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: 999px;
  border: 2px solid color-mix(in oklab, var(--accent-color) 36%, transparent);
  opacity: 0;
  transform: scale(.9);
  pointer-events: none;
  animation: enterPing 1.6s ease .9s 1 forwards;
}
@keyframes enterPing {
  0% { opacity: .6; transform: scale(.9); }
  100% { opacity: 0; transform: scale(1.2); }
}

/* Logo sizing inside overlay */
.lang-logo-wrap { display: inline-block; }
.language-overlay .lang-logo {
  width: 64px;
  height: auto;
  margin-bottom: 1rem;
}
  .language-overlay .lang-logo { opacity: 0; transform: scale(.98); }
  .language-overlay.showing .lang-logo { 
    opacity: 1; 
    transform: scale(1);
    transition: opacity .6s var(--ease-3), transform .6s var(--ease-3);
  }
  /* Keep globe icon still on the overlay */
  .language-overlay .lang-logo-wrap { animation: none !important; }
/* Center the globe logo in the overlay header */
.language-overlay .settings-hero {
  display: grid;
  grid-template-columns: 1fr;
  place-items: center;
}
@media (prefers-reduced-motion: no-preference){
  .lang-logo-wrap { animation: logoFloat 6s ease-in-out infinite .8s; }
}
@keyframes logoFloat {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

.language-overlay .overlay-theme{
  position: static;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  padding: .3rem .55rem .3rem .35rem;
  border-radius: 999px;
  background:
    linear-gradient(180deg, color-mix(in oklab, var(--surface-1) 70%, transparent), color-mix(in oklab, var(--surface-1) 82%, transparent));
  border: 1px solid color-mix(in oklab, var(--text-color) 14%, transparent);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  box-shadow: 0 4px 16px rgba(0,0,0,.12);
  margin-bottom: .6rem; /* tighter to the globe */
}

.overlay-theme .theme-label{
  font-weight: 800;
  letter-spacing: .02em;
  font-size: .9rem;
  color: var(--text-color);
  user-select: none;
  line-height: 1;
}

.theme-note{
  margin: 0 0 .35rem 0;
  font-weight: 800;
  letter-spacing: .14em;
  font-size: .8rem;
  text-transform: uppercase;
  color: color-mix(in oklab, var(--footer-color) 92%, transparent);
  text-align: center;
  opacity: .95;
}

/* Overlay toggle size refined */
.language-overlay .theme-toggle{
  inline-size: 38px;
  block-size: 38px;
  border-radius: 50%;
  box-shadow: none;
  margin-right: 0;
}

.language-overlay h2 {
  margin: .75rem 0 1rem;
  font-size: 1.35rem;
  letter-spacing: .015em;
}

.language-overlay > nav.lang-menu {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: center;
}

.lang-btn {
  width: 220px;
  padding: 0.65rem 1rem;
  font-size: 1rem;
  border-radius: 0.6rem;
  text-align: center;
  transition: transform 0.18s ease, background 0.28s ease, box-shadow 0.28s ease;
  background: var(--surface-1);
  border: 1px solid color-mix(in oklab, var(--accent-color) 12%, transparent);
}

.lang-btn:hover {
  transform: translateY(-1px);
  background: var(--gradient-accent-soft);
  color: #fff;
  box-shadow: 0 8px 18px rgba(0,0,0,.18);
}
@media (max-width: 460px){
  .theme-note{ font-size: .72rem; letter-spacing: .12em; }
  .language-overlay .theme-toggle{ inline-size: 34px; block-size: 34px; }
  .overlay-theme .theme-label{ font-size: .85rem; }
.language-overlay .lang-logo{ width: 56px; margin-bottom: .8rem; }
  .language-overlay h2{ font-size: 1.2rem; }
  .lang-btn{ width: 200px; }
}

/* Enter button (arrow) — glass, accent icon */
.enter-btn {
  margin-top: .75rem;
  display: inline-grid;
  place-items: center;
  inline-size: 52px;
  block-size: 52px;
  padding: 0;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--accent-color) 28%, transparent);
  background: color-mix(in oklab, var(--surface-2) 70%, transparent);
  color: var(--accent-color);
  cursor: pointer;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.25),
    0 8px 18px rgba(0,0,0,.22);
  transition: transform .18s ease, box-shadow .25s ease, background .25s ease, border-color .25s ease, filter .25s ease;
}
.enter-btn .enter-icon { width: 20px; height: 20px; transition: transform .2s ease; }
.enter-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 22px rgba(0,0,0,.28);
  filter: saturate(1.04);
}
.enter-btn:hover .enter-icon { transform: translateX(3px); }
.enter-btn:active { transform: translateY(0) scale(.98); }
.enter-btn:focus-visible { outline: none; box-shadow: var(--focus-ring), 0 8px 18px rgba(0,0,0,.22); }

/* Theme-specific refinement for the Enter button */
html[data-theme="light"] .enter-btn {
  background:
    linear-gradient(180deg, rgba(255,255,255,.75), rgba(255,255,255,.55)),
    color-mix(in oklab, #ffffff 85%, var(--surface-2));
  border-color: color-mix(in oklab, var(--accent-color) 24%, rgba(0,0,0,.06));
  box-shadow: inset 0 1px 0 rgba(255,255,255,.55), 0 8px 16px rgba(0,0,0,.16);
}
html[data-theme="dark"] .enter-btn {
  background:
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.12)),
    color-mix(in oklab, var(--bg) 80%, var(--surface-1));
  border-color: color-mix(in oklab, var(--accent-color) 32%, rgba(255,255,255,.10));
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 12px 24px rgba(0,0,0,.35);
}

/* Compact spacing for short viewports */
@media (max-height: 740px) {
  .settings-card { padding: .65rem; padding-bottom: 2.8rem; min-block-size: 360px; }
  .settings-hero { margin: .15rem .15rem .25rem; gap: .6rem; }
  .language-overlay .lang-logo { width: 56px; }
  .settings-section { margin: .3rem 0; }
  .settings-item { padding: .55rem .55rem; }
  .settings-row-btn { padding: .55rem .55rem; }
  .enter-btn { inline-size: 46px; block-size: 46px; }
}

/* Confetti particles */
.confetti {
  position: fixed;
  width: 8px;
  height: 12px;
  border-radius: 2px;
  pointer-events: none;
  z-index: 3000;
  will-change: transform, opacity;
  animation: confettiFall 1200ms ease-out forwards;
}
@keyframes confettiFall {
  0% { opacity: 1; transform: translate(var(--x, 0), var(--y, 0)) rotate(0deg); }
  100% { opacity: 0; transform: translate(calc(var(--x, 0) + var(--dx, 0px)), calc(var(--y, 0) + var(--dy, 60vh))) rotate(var(--rot, 180deg)); }
}

/* Staggered child reveal inside overlay card */
.ov-item { opacity: 0; transform: translateY(8px); }
.language-overlay.showing .ov-item { opacity: 1; transform: translateY(0); transition: opacity .6s var(--ease-3), transform .6s var(--ease-3); transition-delay: var(--d, 0s); }

/* Faster transform response for magnetized enter button */
.enter-btn.magnet { transition: transform .05s ease, box-shadow .25s ease, background .25s ease; }
    /* Allow JS-controlled fade on experience timeline dots */
.xp-item::before { opacity: var(--dot-opacity, 0.2); transition: opacity 0s; }
/* Small percentage chip above each skill bar (injected by JS) */
.bar .bar-label { position: absolute; right: 8px; top: -22px; font-weight: 800; font-size: .8rem; opacity: .9; }


    /* GSAP drives these during scroll; disable CSS transitions for inline styles */
.reveal[style*="opacity"],
.reveal[style*="transform"] { transition: none !important; }

    /* Extra scroll reveal animations */
    .reveal.fade-in { opacity: 0; transform: none; }
    .reveal.fade-in.visible { opacity: 1; transform: none; transition: opacity .8s ease; }

    .reveal.slide-left { opacity: 0; transform: translateX(-30px); }
    .reveal.slide-left.visible { opacity: 1; transform: translateX(0); transition: opacity .7s ease, transform .7s ease; }

    .reveal.slide-right { opacity: 0; transform: translateX(30px); }
    .reveal.slide-right.visible { opacity: 1; transform: translateX(0); transition: opacity .7s ease, transform .7s ease; }

    .reveal.flip { opacity: 0; transform: rotateY(90deg); transform-origin: left; }
    .reveal.flip.visible { opacity: 1; transform: rotateY(0); transition: transform .8s ease, opacity .8s ease; }

    .reveal.scale-up { opacity: 0; transform: scale(0.8); }
    .reveal.scale-up.visible { opacity: 1; transform: scale(1); transition: transform .7s ease, opacity .7s ease; }
    /* Delightful micro-interactions */
    .card, .project-card, .skill, .talk-card, .xp-panel { transition: transform .22s ease, box-shadow .22s ease; will-change: transform; }
    .card:hover, .project-card:hover, .skill:hover, .talk-card:hover, .xp-panel:hover { transform: translateY(-4px); box-shadow: 0 10px 26px rgba(0,0,0,.22); }
    .btn { transition: transform .15s ease, background .3s ease, color .3s ease; }
    .btn:active { transform: translateY(1px) scale(.99); }

    html, body { transition: background 0.5s ease; }
    /* Skip link */
    .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip-link:focus{left:1rem;top:1rem;width:auto;height:auto;z-index:1000;background:var(--accent-color);color:#fff;padding:.5rem .75rem;border-radius:.375rem;outline:none}
    body {
      margin: 0;
      overflow-x: hidden;
      overflow-y: auto;
      background: var(--bg, #000);
      color: var(--text-color, #eee);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }

    /* ——— Theme vars ——— */
    :root {
      --on: 0;
      --bg: #48443d;
      --cord-light: hsl(0 0% 25%);
      --cord-dark: #C0C0C0;
      --cord: var(--cord-light);
      --cord-hover-light: #777;
      --cord-hover-dark: #EEE;
      --cord-hover: var(--cord-hover-light);

      --text-color: #e6e2d3;
      --surface-1: #446b68;
      --surface-2: #a28c7b;
      --accent-color: #c85c42;  /* warm red */
      --accent-hover: #a64732;
      --accent-2: #48a5a2;  /* slightly brighter teal */
      --accent-2-hover: #2d5c55;
      --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-2) 100%);
      --gradient-accent-soft: linear-gradient(135deg, color-mix(in oklab, var(--accent-color) 18%, transparent) 0%, color-mix(in oklab, var(--accent-2) 18%, transparent) 100%);
      --accent-warm: #e6e2d3;
      --badge-bg: #bca48b;
      --badge-color: #2b2a27;
      --timeline-line: #bca48b;
      --footer-bg: #2b2a27;
      --footer-color: #f2eada;
      --backtotop-bg: var(--accent-color);
      --backtotop-color: #fff;
      --focus-ring: 0 0 0 3px color-mix(in oklab, var(--accent-color) 30%, transparent);
      /* Enter button defaults (overridden per theme) */
      
    }
    [data-theme="dark"] {
      --cord: var(--cord-dark);
      --cord-hover: var(--cord-hover-dark);
      --bg: #23211e;
      --text-color: #e6e2d3;
      --surface-1: #35312b;
      --surface-2: #446b68;
      --accent-2: #48a5a2;
      --accent-2-hover: #2d5c55;
      --badge-bg: #9d8574;
      --timeline-line: #9d8574;
      --footer-bg: #23211e;
      --footer-color: #f5e7c8;
      
    }
    html[data-theme="light"] {
      --bg: #ece7d5;
      --text-color: #2b2a27;
      --surface-1: #fff;
      --surface-2: #f5f1e8;
      --badge-bg: #e2d3b8;
      --badge-color: #4e4943;
      --timeline-line: #d6c7b2;
      --footer-bg: #ece7d5;
      --footer-color: #3a332b;
      --accent-color: #c85c42;
      --accent-hover: #a64732;
      --accent-2: #48a5a2;
      --accent-2-hover: #2d5c55;
      --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-2) 100%);
      --gradient-accent-soft: linear-gradient(135deg, color-mix(in oklab, var(--accent-color) 18%, transparent) 0%, color-mix(in oklab, var(--accent-2) 18%, transparent) 100%);
      --accent-warm: #ece7d5;
      
    }
    html[data-theme="light"] body { background: #ece7d5 !important; }

    /* ——— Sun/Moon icon ——— */
    .theme-toggle {
      --icon-fill: #f39c12;
      --icon-fill-hover: #e67e22;
      color: var(--icon-fill);
      background: none;
      border: none;
      cursor: pointer;
      padding: 0rem;
      inline-size: 58px;
      block-size: 58px;
      display: inline-grid;
      place-items: center;
      margin-right: -0.5rem; /* shift button to the right */
    }
    .theme-toggle svg {
      width: 32px;
      height: 32px;
    }

    /* --- Custom Cursor Ripple Only --- */

/* Click ripple effect */
.cursor-ripple {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent-color);
  pointer-events: none;
  transform: translate(-50%, -50%);
  animation: rippleAnim 0.6s ease-out forwards;
  z-index: 1500;
}
@keyframes rippleAnim {
  from { opacity: 0.7; transform: translate(-50%, -50%) scale(1); }
  to { opacity: 0; transform: translate(-50%, -50%) scale(8); }
}

    /* Accessible focus ring */
    :is(a, button, .btn, select):focus-visible{outline: none; box-shadow: var(--focus-ring);} 
    .sun-and-moon > :is(.moon, .sun, .sun-beams) { transform-origin: center; }
    .sun-and-moon > .sun { transform: scale(1); }
    .sun-and-moon > .sun-beams { opacity: 1; transform: rotateZ(0); }
    .sun-and-moon > .moon > circle { transform: translateX(0); cx: 24; }
    .sun-and-moon > :is(.moon, .sun) { fill: var(--icon-fill); }
    .theme-toggle:is(:hover, :focus-visible) > .sun-and-moon > :is(.moon, .sun) { fill: var(--icon-fill-hover); }
    .sun-and-moon > .sun-beams { stroke: var(--icon-fill); stroke-width: 2px; }
    .theme-toggle:is(:hover, :focus-visible) .sun-and-moon > .sun-beams { stroke: var(--icon-fill-hover); }
    [data-theme="dark"] .sun-and-moon > .sun { transform: scale(1.75); }
    [data-theme="dark"] .sun-and-moon > .sun-beams { opacity: 0; }
    [data-theme="dark"] .sun-and-moon > .moon > circle { transform: translateX(-7px); }
    @supports (cx: 1) {
      [data-theme="dark"] .sun-and-moon > .moon > circle { cx: 17; transform: translateX(0); }
    }
    @media (prefers-reduced-motion: no-preference) {
      .sun-and-moon > .sun { transition: transform .5s var(--ease-elastic-3); }
      .sun-and-moon > .sun-beams { transition: transform .5s var(--ease-elastic-4), opacity .5s var(--ease-3); }
      .sun-and-moon .moon > circle { transition: transform .25s var(--ease-out-5); }
      @supports (cx: 1) {
        .sun-and-moon .moon > circle { transition: cx .25s var(--ease-out-5); }
      }
      [data-theme="dark"] .sun-and-moon > .sun { transition: .25s var(--ease-3); }
      [data-theme="dark"] .sun-and-moon > .sun-beams { transition-duration: .15s; transform: rotateZ(-25deg); }
      [data-theme="dark"] .sun-and-moon > .moon > circle { transition-duration: .5s; transition-delay: .25s; }
    }

    

    /* ——— New Portfolio Template: Typography & Utilities ——— */
    /* ——— Wix-inspired minimal top bar + hello hero ——— */

    .hello {
      min-height: 100vh;       /* full screen */
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
      display: grid;
      grid-template-columns: 340px 1fr;
      gap: 3rem;
      align-items: start;
      justify-content: center;
      padding-top: 10rem;
    }
    .hello .avatar {
      position: relative;
      overflow: hidden;
      width: 360px; aspect-ratio: 1/1; border-radius: 50%; 
      background: radial-gradient(circle at 30% 30%, #666 0%, #444 60%, #333 100%);
      box-shadow: 0 10px 40px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.05);
      justify-self:center;
    }
    .intro-labels {
      display: flex;
      gap: .5rem;
      margin: .75rem 0 1rem;
      flex-wrap: wrap;
    }
    .hello .avatar img {
      width: 100%; height: 100%; object-fit: cover; display:block;
      opacity: 0;
      filter: blur(20px);
      transform: scale(1.05);
      animation: blurReveal 1.3s ease forwards;
      animation-delay: 0.4s;
    }
    @keyframes blurReveal {
      to {
        opacity: 1;
        filter: blur(0);
        transform: scale(1);
      }
    }
    .hello .avatar::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 50%;
      box-shadow: 0 0 0 0 rgba(255,255,255,0.4);
      animation: pulseGlow 3s infinite;
    }

    @keyframes pulseGlow {
      0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }
      70% { box-shadow: 0 0 20px 40px rgba(255,255,255,0); }
      100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); }
    }
    .hello h1 {
      font-size: clamp(3rem, 6vw, 4.2rem);
      margin: 0 0 .4rem;
      letter-spacing: .2px;
    }
    .hello .blurb { max-width: 680px; color: var(--footer-color); padding-top: 0.25rem; font-size: 1.25rem;}
    .hello .cta-row {
      display:flex; gap: .75rem; align-items:center; margin-top: 1rem; flex-wrap:wrap;
    }
    .hello .cta {
      display: grid;
      place-items: center;
      width: 130px;
      height: 130px;
      border-radius: 50%;
      font-weight: 800;
      text-decoration: none;
      color: #000;
      background: linear-gradient(to bottom, rgba(255,255,255,0.85) 0%, var(--accent-color) 100%);
      border: 2px solid rgba(0,0,0,.15);
      box-shadow: inset 0 2px 4px rgba(255,255,255,.6),
                  inset 0 -2px 4px rgba(0,0,0,.15),
                  0 6px 14px rgba(0,0,0,.25);
      transition: transform .2s ease, box-shadow .2s ease, background .3s ease;
      font-size: 1.25rem;
      position: relative;
      overflow: hidden;
      z-index: 1;

      /* Fun bouncy reveal effect */
      opacity: 0;
      transform: scale(0.8) translateY(40px);
      animation: ctaBounceReveal 1s cubic-bezier(.68,-0.55,.27,1.55) forwards;
    }

    .hello .cta.resume  { animation-delay: 1.4s; }
    .hello .cta.projects{ animation-delay: 1.6s; }
    .hello .cta.contact { animation-delay: 1.8s; }

    @keyframes ctaBounceReveal {
      0% {
        opacity: 0;
        transform: scale(0.8) translateY(40px);
      }
      60% {
        opacity: 1;
        transform: scale(1.05) translateY(-6px);
      }
      80% {
        transform: scale(0.98) translateY(3px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .hello .cta::after {
      content: "";
      position: absolute;
      inset: -4px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,.25);
      animation: ringGlow 4s linear infinite;
    }

    /* Orbiting ring pseudo-element for CTA circles */
    .hello .cta::before {
      content: "";
      position: absolute;
      inset: -6px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.4);
      animation: orbitRing 6s linear infinite;
      pointer-events: none;
      z-index: 0;
    }

    /* Reflective highlight effect for glossy reflection */
    .hello .cta::selection { background: transparent; }
    .hello .cta .shine {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(ellipse at top left, rgba(255,255,255,0.35), transparent 70%);
      transform: rotate(25deg);
      pointer-events: none;
      z-index: 2;
      mix-blend-mode: screen;
    }
    @keyframes orbitRing {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .hello .cta:hover::before {
      animation-duration: 3s;
      border-color: rgba(255,255,255,0.7);
    }

    .hello .cta {
      position: relative;
      overflow: hidden;
    }
    .hello .cta::before,
    .hello .cta::after,
    .hello .cta .shine { pointer-events:none; }

    @keyframes shineMove {
      0% { transform: translateX(-100%) rotate(25deg); }
      100% { transform: translateX(100%) rotate(25deg); }
    }
    .hello .cta:hover .shine {
      animation: shineMove 1.5s ease-in-out;
    }

    @keyframes ringGlow {
      0% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.15); opacity: 0.2; }
      100% { transform: scale(1); opacity: 0.6; }
    }
    .hello .cta:hover {
      transform: translateY(-3px);
      box-shadow: inset 0 2px 4px rgba(255,255,255,.7),
                  inset 0 -2px 4px rgba(0,0,0,.2),
                  0 10px 20px rgba(0,0,0,.3);
    }
    .hello .cta:active {
      transform: translateY(2px) scale(.97);
      box-shadow: inset 0 1px 2px rgba(0,0,0,.25),
                  inset 0 -1px 2px rgba(255,255,255,.4),
                  0 4px 10px rgba(0,0,0,.2);
    }
    .cta.resume  { background: var(--accent-color); color:#0b2818; }
    .cta.projects{ background: var(--accent-2);    color:#2b0d0d; }
    .cta.contact { background: color-mix(in oklab, var(--accent-color) 40%, var(--accent-2) 20%); color:#0f1412; }

    .hello-meta {
      display: grid;
      grid-template-columns: repeat(3,1fr);
      gap: 1rem;
      max-width: 1200px;
      margin: -27rem auto 5rem;
      padding: 2rem 1rem 5rem;
      border-top: 1px solid rgba(255,255,255,.08);
      padding-top: 2rem;
      justify-content: center;
      text-align: center;
    }
    .hello-meta .item {
      font-size: 1.05rem;
      color: var(--footer-color);
      justify-content: center;
      text-align: center;
    }
    .hello-meta .item strong { display:block; color: var(--text-color); font-size: 1.15rem; }

    @media (max-width: 900px) {
      .hello {
        min-height: 100vh;
        grid-template-columns: 1fr;
        text-align: left;
        justify-items: center;
      }
      .hello .avatar { width: 220px; }
      .hello-meta { grid-template-columns: 1fr; }
    }
    h1,h2,h3 { line-height: 1.15; color: var(--accent-color); }
    /* Section titles use base text color (not warm accent) */
    .section h2 { color: var(--text-color); }
    .intro-wave {
      display: inline-block;
      animation: wave 2s infinite;
      font-weight: 700;
      color: var(--text-color);
      background: none;
      -webkit-background-clip: initial;
      -webkit-text-fill-color: initial;
    }
    /* Slightly smaller greeting text in Japanese to balance layout */
    html[lang="ja"] .intro-wave { font-size: 0.8em; }
    @keyframes wave {
      0% { transform: rotate(0deg); }
      10% { transform: rotate(10deg); }
      20% { transform: rotate(-8deg); }
      30% { transform: rotate(6deg); }
      40% { transform: rotate(-4deg); }
      50% { transform: rotate(2deg); }
      60%, 100% { transform: rotate(0deg); }
    }

    .highlight-name {
      display: inline-block;
      font-weight: 800;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* --- Animated name reveal for About section --- */
    .highlight-name {
      display: inline-block;
      font-weight: 800;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      opacity: 0;
      transform: translateY(20px);
      animation: nameSmoothReveal 1s ease-out forwards;
      animation-delay: 0.6s;
    }

    @keyframes nameSmoothReveal {
      0% {
        opacity: 0;
        transform: translateY(20px);
        filter: blur(6px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
        filter: blur(0);
      }
    }

    .hello h1 .highlight-name {
      font-size: 1.25em; /* bigger only in the Hello, I’m section */
    }

    /* --- Pinyin tone note under name --- */
    .name-pinyin{
      margin: .2rem 0 .5rem;
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: .2px;
      color: var(--footer-color);
    }
    .name-pinyin .tone-ascii{
      font-weight: 600;
      opacity: .85;
      margin-left: .35rem;
    }
    @media (max-width: 900px){
      .name-pinyin{ font-size: .9rem; }
    }



    h1 { font-size: clamp(1.8rem, 3vw + 1rem, 2.6rem); margin: 0 0 .5rem; }
    h2 { font-size: clamp(1.4rem, 2vw + .5rem, 1.8rem); margin: 0 0 .75rem; }
    h3 { font-size: 1.15rem; margin: 0 0 .35rem; }
    p { line-height: 1.6; }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
    .section { padding: 3rem 0; scroll-margin-top: 60px; }
    /* Extra spacing below the featured section */
    #featured {
      margin-bottom: 10rem; /* adjust value as needed */
      scroll-margin-top: 100px;
    }
    #projects {
      margin-bottom: 10rem; /* adjust value as needed */
      scroll-margin-top: 120px;
    }
      #experience {
      margin-bottom: 10rem; /* adjust value as needed */
      scroll-margin-top: 90px;
    }
      #skills {
      margin-bottom: 10rem; /* adjust value as needed */
      scroll-margin-top: 250px;
    }
      #writing {
      margin-bottom: 12rem; /* adjust value as needed */
      scroll-margin-top: 132px;
    }
    .muted { color: var(--footer-color); }
    .chip { display:inline-flex; align-items:center; gap:.35rem; padding:.25rem .55rem; border-radius:999px; background: var(--badge-bg); color: var(--badge-color); font-size:.8rem; font-weight:600; }
    .chip i { width:.6rem; height:.6rem; border-radius:50%; background: currentColor; opacity:.6; }
    .pill {
      display:inline-block;
      padding:.45rem .9rem;
      border-radius:999px;
      background: var(--gradient-accent-soft);
      color: var(--text-color);
      font-weight:700;
      font-size:1rem;
      position: relative;
      overflow: hidden;
      margin-top: -0.25rem;
      white-space: nowrap;
      vertical-align: middle;
      opacity: 0;
      visibility: hidden;
      transform: translateY(18px) scale(.96);
      animation: pillFlip3D .9s cubic-bezier(.25,.85,.25,1) forwards;
    }
    .pill:nth-of-type(1) { animation-delay: 0.7s; }
    .pill:nth-of-type(2) { animation-delay: 1s; }
    .pill:nth-of-type(3) { animation-delay: 1.3s; }

    .pill::before {
      content:"";
      position:absolute;
      top:0;
      left:-75%;
      width:50%;
      height:100%;
      background: linear-gradient(120deg, rgba(255,255,255,.2) 0%, rgba(255,255,255,.6) 50%, rgba(255,255,255,.2) 100%);
      transform: skewX(-20deg);
      animation: shine 2s infinite;
    }
    @keyframes shine {
      0% { left: -75%; }
      60% { left: 125%; }
      100% { left: 125%; }
    }
    @keyframes revealUp {
      from { opacity: 0; visibility: hidden; transform: translateY(40px); }
      to   { opacity: 1; visibility: visible; transform: translateY(0); }
    }
    /* --- Alternative pill animations --- */
    @keyframes pillPop {
      0%   { opacity: 0; visibility: hidden; transform: translateY(18px) scale(.96); filter: blur(3px); }
      60%  { opacity: 1; visibility: visible; transform: translateY(-2px) scale(1.02); filter: blur(0); }
      100% { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
    }
    @keyframes pillSlideLeft {
      0%   { opacity: 0; visibility: hidden; transform: translateX(-18px); }
      100% { opacity: 1; visibility: visible; transform: translateX(0); }
    }
    @keyframes pillFadeScale {
      0%   { opacity: 0; visibility: hidden; transform: scale(.9); filter: blur(3px); }
      100% { opacity: 1; visibility: visible; transform: scale(1); filter: blur(0); }
    }

    /* --- Extra-unique pill animations --- */
    /* 1) 3D Flip toward the viewer */
    @keyframes pillFlip3D {
      0%   { opacity: 0; visibility: hidden; transform: rotateX(80deg) translateY(8px) scale(.92); filter: blur(3px); }
      60%  { opacity: 1; visibility: visible; transform: rotateX(-8deg) translateY(-2px) scale(1.02); filter: blur(0); }
      100% { opacity: 1; visibility: visible; transform: rotateX(0) translateY(0) scale(1); }
    }

    /* 2) Arc drop: swoops along an arc with gentle spin */
    @keyframes pillArcDrop {
      0%   { opacity: 0; visibility: hidden; transform: translate(-18px, -22px) rotate(-12deg) scale(.94); }
      50%  { opacity: 1; visibility: visible; transform: translate(6px, 6px) rotate(6deg) scale(1.02); }
      100% { opacity: 1; visibility: visible; transform: translate(0, 0) rotate(0) scale(1); }
    }

    /* 3) Wipe reveal: clip-path from the right like a glossy swipe */
    @keyframes pillWipeIn {
      0%   { opacity: 0; visibility: hidden; clip-path: inset(0 100% 0 0 round 999px); transform: translateY(8px); }
      60%  { opacity: 1; visibility: visible; clip-path: inset(0 0 0 0 round 999px); transform: translateY(-2px); }
      100% { opacity: 1; visibility: visible; clip-path: inset(0 0 0 0 round 999px); transform: translateY(0); }
    }

    /* 4) Spring skew: elastic entry with skewed bounce */
    @keyframes pillSpringSkew {
      0%   { opacity: 0; visibility: hidden; transform: translateY(22px) skewX(-10deg) scale(.94); filter: blur(2px); }
      50%  { opacity: 1; visibility: visible; transform: translateY(-4px) skewX(6deg)  scale(1.03); filter: blur(0); }
      100% { opacity: 1; visibility: visible; transform: translateY(0)  skewX(0)      scale(1); }
    }

    /* Switch animation by setting data-pill-anim on any ancestor (e.g., <body data-pill-anim="slide">) */
    [data-pill-anim="pop"]   .pill { animation-name: pillPop;   }
    [data-pill-anim="slide"] .pill { animation-name: pillSlideLeft; }
    [data-pill-anim="fade"]  .pill { animation-name: pillFadeScale; }
    [data-pill-anim="flip3d"] .pill {
      perspective: 1000px;            /* enable a 3D feel */
      transform-style: preserve-3d;
      animation-name: pillFlip3D;
    }
    [data-pill-anim="arcdrop"] .pill {
      animation-name: pillArcDrop;
    }
    [data-pill-anim="wipe"] .pill {
      animation-name: pillWipeIn;
      clip-path: inset(0 100% 0 0 round 999px); /* match starting keyframe so no flash */
    }
    [data-pill-anim="springskew"] .pill {
      animation-name: pillSpringSkew;
    }

    [data-pill-anim="wipe"] .pill::after {
      content: "";
      position: absolute; inset: -2px; border-radius: 999px;
      background: linear-gradient(120deg, rgba(255,255,255,.18), rgba(255,255,255,0) 40%);
      opacity: 0; pointer-events: none;
      animation: pillAfterShine 1.2s ease .3s 1 forwards;
    }
    @keyframes pillAfterShine {
      0%   { opacity: 0; transform: translateX(-40%) skewX(-15deg); }
      40%  { opacity: .9; transform: translateX(10%)  skewX(-15deg); }
      100% { opacity: 0; transform: translateX(50%)  skewX(-15deg); }
    }
    /* Default to pop if no attribute is set */
    /* Hide empty/ghost pills visually but keep them in the DOM flow for nth-of-type etc. */
.pill.pill--ghost,
.pill:empty {
  display: inline-block;   /* stays in flow so nth-of-type still counts */
  width: 0;                /* take no width */
  padding: 0;
  margin: 0;
  border: 0;
  background: transparent;
  box-shadow: none;
  overflow: hidden;
}

/* Prevent shine highlight on ghost/empty pills */
.pill.pill--ghost::before,
.pill:empty::before {
  content: none;
}
    .accent { color: var(--accent-color); }
    .accent-2 { color: var(--accent-2); }
    .shadow-soft { box-shadow: 0 8px 30px rgba(0,0,0,.15); }

    /* Header grid */
    .header { padding-top: 7rem; }
    .header-grid {
      display: grid; grid-template-columns: 1.1fr .9fr; gap: 2rem; align-items: stretch;
    }
    .intro .actions { display:flex; gap:.75rem; flex-wrap:wrap; margin: 1rem 0 1rem; }
    .quick-chips { display:flex; gap:.5rem; flex-wrap:wrap; }
    .hero-card { background: var(--surface-2); border-radius:.75rem; }
    .hero-card-inner { padding: 1.25rem; }
    .hero-card h3 { margin-top:0; }
    @media (max-width: 900px){ .header-grid{ grid-template-columns: 1fr; } }
    .filters {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      gap: .5rem;
      margin: .5rem 0 1rem;
      flex-wrap: wrap;
    }
    .filter-buttons {
      display: flex;
      gap: .5rem;
      flex-wrap: wrap;
    }
    .more-github {
      margin-left: auto;
    }

    /* Buttons */
    .btn {
      display:inline-block; background: var(--accent-color); color:#fff; border:none;
      padding:.5rem 1rem; font-weight:600; font-size:1rem; border-radius:.375rem; cursor:pointer;
      text-decoration:none; text-align:center; user-select:none; transition: background .3s, color .3s;
    }
    .btn:hover, .btn:focus-visible { background: var(--accent-hover); color:#fff; outline:none; }
    .btn.outline { background:transparent; color:var(--accent-color); border:2px solid var(--accent-color); }
    .btn.outline:hover { background:var(--accent-color); color:#fff; }
    .btn.subtle { background:transparent; color:var(--accent-color); font-weight:500; }
    .btn.subtle:hover { color:var(--accent-hover); }
    .btn.small { font-size:.875rem; padding:.25rem .5rem; }
    .btn.with-icon { display:inline-flex; align-items:center; gap:.5rem; }
    .btn.with-icon svg { width:1.05em; height:1.05em; display:block; }
    /* Code button: quiet container + mono label */
    .btn.code {
      background: var(--surface-2);
      color: var(--accent-2);
      border: 1px solid color-mix(in oklab, var(--accent-2) 25%, transparent);
      display: inline-flex; align-items: center; gap: .4rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    .btn.code:hover, .btn.code:focus-visible {
      background: color-mix(in oklab, var(--accent-2) 12%, transparent);
      border-color: color-mix(in oklab, var(--accent-2) 45%, transparent);
      color: var(--accent-2);
    }
    .btn .icon { width: 1em; height: 1em; display:inline-block; }
    .card-actions { display:flex; gap:.5rem; flex-wrap:wrap; }

    /* Featured cards layout */
.card {
  background: var(--surface-1);
  border-radius: .75rem;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: .6rem;
  border: 1px solid rgba(255,255,255,.06);
  box-shadow: 0 6px 24px rgba(0,0,0,.2);
  position: relative;
  height: 100%;
}
.cards > .card { height: 100%; }

/* Project cards layout */
.project-card {
  background: var(--surface-1);
  padding: 1rem 1rem;
  border-radius: .5rem;
  box-shadow: 0 2px 8px rgba(0,0,0,.35);
  display: flex;
  flex-direction: column;
  gap: .6rem;
  position: relative;
  height: 100%;
}
.projects-grid > .project-card { height: 100%; }
/* Force all project cards to flip simultaneously */

/* Badges/labels wrap nicely and never collide with actions */
.meta { display:flex; gap:.5rem; flex-wrap:wrap; align-items:flex-start; max-width:100%; }

/* Action buttons are always bottom-left and wrap if needed */
.card-actions {
  display: flex;
  gap: .5rem;
  flex-wrap: wrap;
  margin-top: auto;        /* pushes actions to the bottom */
  align-self: flex-start;  /* keeps actions left-aligned */
}
/* Action buttons stay left, spacing controlled by rules below */
.card-actions { 
  display:flex; 
  gap:.5rem; 
  flex-wrap:wrap; 
  align-self:flex-start; 
}

.card-actions { margin-top: 0 !important; }

/* Put labels (badges) directly above actions, bottom-left */
.card .meta, .card .badges, .project-card .badges { margin-top: auto; }

/* If a card HAS badges/meta, keep a small gap before actions */
.card:has(.meta, .badges) .card-actions,
.project-card:has(.badges) .card-actions { margin-top: .5rem; }

/* If a card has NO badges/meta, push actions to the bottom */
.card:not(:has(.meta)):not(:has(.badges)) .card-actions,
.project-card:not(:has(.badges)) .card-actions { margin-top: auto; }

    /* Cards / grids */
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.5rem;
      padding-top: 0.5rem;
    }
    .projects-cta { display:flex; justify-content:center; margin-top: 6rem; }
    @media (max-width: 800px) {
      .projects-grid {
        grid-template-columns: 1fr;
      }
    }
    .project-card {
      background: var(--surface-1);
      padding: 1rem;
      border-radius: .75rem;
      box-shadow: 0 6px 16px rgba(0,0,0,.2);
      display: flex;
      flex-direction: column;
      transition: transform .3s ease, box-shadow .3s ease;
    }
    .project-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 12px 28px rgba(0,0,0,.35);
    }
    .project-card .thumb {
      aspect-ratio: 16/9;
      border-radius: .75rem;
      overflow: hidden;
      margin-bottom: 1rem;
      background: linear-gradient(
        90deg,
        color-mix(in oklab, var(--accent-color) 18%, transparent),
        color-mix(in oklab, var(--accent-2) 18%, transparent)
      );
      position: relative;
    }
    .project-card .thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform .5s ease; /* match Featured cards */
    }
    .project-card:hover .thumb img {
      transform: scale(1.08); /* match Featured cards */
    }
    .project-card h3 { margin: 0 0 .5rem; color: var(--accent-color); font-size:1.15rem; }
    .project-card p { margin: 0 0 1rem; line-height:1.45; }

    /* Hero */
    .hero {
      background: var(--surface-2);
      padding: 2rem 1rem;
      border-radius: .75rem;
      color: var(--text-color);
    }
    .hero .hero-inner { max-width: 700px; }
    .hero h2 { margin: 0 0 .5rem; font-size: 1.6rem; }
    .hero p { margin: 0 0 1rem; font-size: 1.05rem; }
    .hero .actions { display:flex; gap:.75rem; flex-wrap:wrap; }

    /* Badges */
    .badges { display:flex; flex-wrap:wrap; gap:.5rem }
    .badges .badge {
      background: var(--badge-bg); color: var(--badge-color);
      padding:.25rem .5rem; border-radius:.375rem; font-size:.875rem; font-weight:600;
      box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--accent-color) 20%, transparent);
    }

    /* Writing & Talks */
    .talks { display:grid; gap: 1rem; }
    .talks-header { display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:.75rem; }
    .talks .filters { margin: -1rem 0 0; }
    .talks-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:1rem; }
    .talk-card {
      background: var(--surface-1);
      padding: 1rem;
      border-radius: .6rem;
      border: 1px solid rgba(255,255,255,.06);
      box-shadow: 0 4px 14px rgba(0,0,0,.18);
      display:flex; flex-direction:column; gap:.6rem;
      position:relative; height:100%;
    }
    .talk-card h3 { margin:.25rem 0 .25rem; font-size:1.1rem; color: var(--accent-color); }
    .talk-meta { display:flex; gap:.5rem; flex-wrap:wrap; color: var(--footer-color); font-size:.9rem; align-items:center; }
    .talk-meta span:first-child { background: var(--badge-bg); color: var(--badge-color); border-radius:999px; padding:.1rem .45rem; font-weight:700; font-size:.75rem; }
    .talk-meta span:nth-child(2) { opacity:.6; }
    .talk-type { display:inline-flex; align-items:center; gap:.35rem; padding:.2rem .5rem; border-radius:999px; background: var(--gradient-accent-soft); font-weight:700; font-size:.75rem; }
    .talk-actions { margin-top:auto; display:flex; gap:.5rem; flex-wrap:wrap; }
    .talk-actions .btn.small {
      padding:.3rem .55rem; font-size:.85rem;
      /* Center label vertically without changing size */
      display: inline-flex; align-items: center; justify-content: center; line-height: 1;
    }

    /* Reduce motion for performance/accessibility */
    @media (prefers-reduced-motion: reduce) {
      .floating-shape,
      .code-icon,
      .coffee-icon,
      .world-icon,
      .cooking-icon,
      .game-icon,
      .soccer-icon {
        animation: none !important;
      }
      .reveal { opacity: 1 !important; transform: none !important; }
    }

    /* Timeline */
    .timeline { list-style:none; margin:0; padding:0; border-left:3px solid var(--timeline-line); }
    .timeline li { position:relative; padding-left:1.5rem; margin-bottom:1.25rem; }
    .timeline .time {
      position:absolute; left:-130px; top:0; width:120px; text-align:right; font-weight:600; color:var(--accent-color);
    }
    .timeline .content {
      background: var(--surface-2); padding:.6rem 1rem; border-radius:.375rem; box-shadow:0 1px 4px rgba(0,0,0,.1);
    }
    @media (max-width: 600px) {
      .timeline .time { position: static; width:auto; text-align:left; margin-bottom:.25rem; }
    }

    /* Footer + Back to top */
    .site-footer { background: var(--footer-bg); color: var(--footer-color); text-align:center; padding: 1rem; font-size:.9rem; }
    #backToTop {
      position: fixed; bottom:1.25rem; right:1.25rem; background: var(--backtotop-bg); color: var(--backtotop-color);
      border:none; border-radius:50%; width:40px; height:40px; font-size:1.25rem; cursor:pointer;
      opacity:0; visibility:hidden; transition: opacity .3s, visibility .3s; z-index:100;
    }
    #backToTop.show { opacity:1; visibility:visible; }


    /* ——— Global navbar & new sections ——— */
    .site-nav {
      position: sticky; top: 0; z-index: 50;
      backdrop-filter: blur(8px);
      background: color-mix(in oklab, var(--bg) 80%, transparent);
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .nav-inner { display:flex; align-items:center; justify-content:space-between; gap:1rem; padding:.65rem 1rem; max-width:1200px; margin:0 auto; }
    .brand { 
      display:flex; 
      align-items:center; 
      gap:0.1rem; 
      font-weight:800; 
      letter-spacing:.3px; 
      font-size: 1.5rem;
      line-height: 1.2;
    }
    .brand .dot { width:.6rem; height:.6rem; border-radius:50%; background: var(--accent-color); box-shadow: 0 0 0 4px color-mix(in oklab, var(--accent-color) 25%, transparent); }
    .logo-zc { display: inline-block; color: var(--accent-color); }
    /* --- Name pronunciation UI --- */
    .name-with-audio {
      display: inline-flex;
      align-items: center;
      gap: .35rem; /* slightly tighter to sit close to name */
    }
    /* Pronunciation button: modern audio player style */
    .pronounce-btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--surface-1);
      border: 2px solid var(--accent-color);
      color: var(--accent-color);
      cursor: pointer;
      padding: 0;
      transition: background .25s ease, transform .15s ease, box-shadow .25s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,.15);
    }
    .hello .pronounce-btn {
  width: 36px;
  height: 36px;
  animation-delay: 1.3s; /* hero */
}

.site-nav .pronounce-btn {
  animation-delay: 1.3s; /* nav */
}
    .pronounce-btn:hover,
    .pronounce-btn:focus-visible {
      background: var(--accent-color);
      color: #fff;
      outline: none;
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
    }
    .pronounce-btn:active {
      transform: translateY(0) scale(.96);
      box-shadow: 0 3px 8px rgba(0,0,0,.2);
    }

    .pronounce-btn .icon svg {
      width: 16px;
      height: 16px;
      display: block;
    }
    .hello .pronounce-btn .icon svg {
      width: 18px;
      height: 18px;
    }

/* Default: show play, hide pause */
.pronounce-btn .icon-pause { display:none; }

/* When active (is-playing), swap */
.pronounce-btn.is-playing .icon-play { display:none; }
.pronounce-btn.is-playing .icon-pause { display:inline-block; }
    /* Remove play triangle pseudo-element */
    .pronounce-btn::after{
      content: none !important; 
      border: 0 !important;
    }
    /* Easier to click without changing layout */
    .pronounce-btn::before{
      content:"";
      position:absolute;
      inset:-8px; /* expands hit area */
      border-radius: 999px;
    }
    .pronounce-btn:hover,
    .pronounce-btn:focus-visible{
      outline: none;
      background: color-mix(in oklab, var(--accent-color) 92%, #fff 8%);
      box-shadow: 0 0 0 6px color-mix(in oklab, var(--accent-color) 30%, transparent), 0 6px 14px rgba(0,0,0,.18);
      transform: translateY(-1px);
    }
    .pronounce-btn:active{ transform: translateY(0) scale(.98); box-shadow: 0 0 0 5px color-mix(in oklab, var(--accent-color) 28%, transparent); }

    /* Speaking pulse: simple pulsing border */
    .pronounce-btn.is-speaking {
      animation: pulseBorder 1.4s infinite;
    }
    @keyframes pulseBorder {
      0% { box-shadow: 0 0 0 0 rgba(200,92,66,0.6); }
      70% { box-shadow: 0 0 0 8px rgba(200,92,66,0); }
      100% { box-shadow: 0 0 0 0 rgba(200,92,66,0); }
    }
    .nav-links { display:flex; gap:.9rem; flex-wrap:wrap; }
    .nav-links a {
      text-decoration:none; color:var(--text-color); font-weight:600; font-size:.95rem;
      padding:.35rem .55rem; border-radius:.4rem; opacity:.9;
    }
    .nav-links a:hover, .nav-links a[aria-current="true"] { background: var(--gradient-accent-soft); opacity:1; }
    .nav-cta { display: flex; gap: .25rem; align-items: center; margin-right: -0.5rem; }
    .nav-cta .btn.small { padding:.35rem .6rem; }
    /* --- Glassy dropdown language selector (top-right) --- */
    .lang-switcher { position: relative; margin-right: .25rem; }
    .lang-dd { --w: 100px; --h: 40px; }
    .lang-dd .lang-trigger{
      inline-size: var(--w);
      block-size: var(--h);
      display: inline-flex; align-items: center; justify-content: space-between; gap:.6rem;
      padding: 0 .9rem;
      border-radius: .9rem;
      background:
        linear-gradient(180deg, color-mix(in oklab, var(--surface-2) 60%, transparent), color-mix(in oklab, var(--surface-2) 80%, transparent)),
        var(--surface-2);
      color: var(--text-color);
      border: 1px solid color-mix(in oklab, var(--accent-color) 22%, transparent);
      box-shadow: inset 0 6px 16px rgba(0,0,0,.18), 0 4px 14px rgba(0,0,0,.20);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      font-weight: 800; letter-spacing:.2px; text-transform: none;
      cursor: pointer;
      transition: background .25s ease, border-color .25s ease, transform .15s ease;
    }
    .lang-dd .lang-trigger:hover,
    .lang-dd .lang-trigger:focus-visible{
      outline: none;
      border-color: color-mix(in oklab, var(--accent-color) 45%, transparent);
      transform: translateY(-1px);
    }
    .lang-dd .lang-trigger .chev{ width:18px; height:18px; opacity:.85; transition: transform .2s ease; }
    .lang-dd[data-open="true"] .lang-trigger .chev{ transform: rotate(180deg); }

    .lang-dd .lang-menu{
      position: absolute; top: calc(100% + 8px); right: 0;
      inline-size: var(--w);
      display: grid; gap: .35rem; padding: .5rem;
      border-radius: 1rem;
      background:
        linear-gradient(180deg, color-mix(in oklab, var(--accent-2) 10%, transparent), color-mix(in oklab, var(--accent-color) 10%, transparent)),
        var(--surface-2);
      border: 1px solid color-mix(in oklab, var(--accent-color) 18%, transparent);
      box-shadow: 0 16px 32px rgba(0,0,0,.30);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      z-index: 1000;
      opacity: 0; transform: translateY(-6px) scale(.98);
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
    }
    /* On the overlay setup page, ensure the dropdown sits above all overlay elements */
    .language-overlay .lang-dd .lang-menu { z-index: 6000; }
    /* --- Dark theme: refined language trigger + panel (less shadow, better color) --- */
    [data-theme="dark"] .lang-dd .lang-trigger{
      /* Smoked glass pill: neutral base + subtle warm accent ring */
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.12)),
        color-mix(in oklab, var(--bg) 80%, var(--surface-1));
      border: 1px solid color-mix(in oklab, var(--accent-color) 26%, rgba(255,255,255,.12));
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.06),
        0 2px 10px rgba(0,0,0,.14);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    [data-theme="dark"] .lang-dd .lang-trigger:hover,
    [data-theme="dark"] .lang-dd .lang-trigger:focus-visible{
      background:
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.16)),
        color-mix(in oklab, var(--bg) 76%, var(--surface-1));
      border-color: color-mix(in oklab, var(--accent-color) 40%, rgba(255,255,255,.16));
      transform: translateY(-1px);
    }

    /* Dark theme: OPAQUE panel (no see-through) with accent-infused neutral base */
    [data-theme="dark"] .lang-dd .lang-menu{
      background:
        linear-gradient(135deg,
          color-mix(in oklab, var(--accent-color) 10%, var(--surface-1)),
          color-mix(in oklab, var(--accent-2) 10%, var(--surface-1))
        );
      border: 1px solid color-mix(in oklab, var(--accent-color) 28%, transparent);
      box-shadow: 0 8px 18px rgba(0,0,0,.24);
      backdrop-filter: none !important;
      -webkit-backdrop-filter: none !important;
    }

    /* Options: keep contrast high on dark + use same hover as nav links */
    [data-theme="dark"] .lang-dd .lang-menu button[role="option"]{
      background: transparent;
      color: var(--text-color);
    }
    [data-theme="dark"] .lang-dd .lang-menu button[role="option"]:hover,
    [data-theme="dark"] .lang-dd .lang-menu button[role="option"][aria-selected="true"]{
      background: var(--gradient-accent-soft);
      color: var(--text-color);
    }
    .lang-dd[data-open="true"] .lang-menu{ opacity:1; transform: translateY(0) scale(1); pointer-events:auto; }
    .lang-dd .lang-menu li{ list-style: none; }
    .lang-dd .lang-menu button[role="option"]{
      width: 100%;
      display: inline-flex; align-items:center; justify-content:flex-start;
      padding: .7rem .8rem; border-radius: .75rem; border: 0; cursor:pointer;
      background: color-mix(in oklab, var(--bg) 0%, transparent);
      color: var(--text-color); font-weight: 700;
      transition: background .18s ease, color .18s ease;
    }
    .lang-dd .lang-menu button[role="option"][aria-selected="true"]{
      background: var(--gradient-accent-soft);
      color: var(--text-color);
    }
    .lang-dd .lang-menu button[role="option"]:hover{ background: var(--gradient-accent-soft); }

    /* Fixed label width so the trigger never jitters when changing languages */
    .lang-trigger-label{ display:inline-block; min-width: 40px; text-align:left; }

    /* Hide fallback select if ever visible */
    #languageSelect[hidden]{ display:none !important; }

        /* Light theme: smoked-glass pill to match dark theme vibe */
    html[data-theme="light"] .lang-dd .lang-trigger{
      background:
        linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.55)),
        color-mix(in oklab, #ffffff 85%, var(--surface-2));
      border: 1px solid color-mix(in oklab, var(--accent-color) 28%, rgba(0,0,0,.06));
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.55),
        0 2px 10px rgba(0,0,0,.10);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      color: var(--text-color);
    }
    html[data-theme="light"] .lang-dd .lang-trigger:hover,
    html[data-theme="light"] .lang-dd .lang-trigger:focus-visible{
      background:
        linear-gradient(180deg, rgba(255,255,255,.8), rgba(255,255,255,.6)),
        color-mix(in oklab, #ffffff 82%, var(--surface-2));
      border-color: color-mix(in oklab, var(--accent-color) 42%, rgba(0,0,0,.08));
      transform: translateY(-1px);
    }
    /* Hero (split) */
    .hero-split { padding: 5.5rem 0 3rem; }
    .hero-grid { display:grid; grid-template-columns: 1.2fr .8fr; gap:2rem; align-items:center; }
    .hero-title { font-size: clamp(2rem, 4.2vw, 3rem); margin:0 0 .5rem; }
    .hero-sub { font-size: clamp(1.05rem, 1.8vw, 1.2rem); margin:0 0 1.25rem; color: var(--footer-color); }
    .hero-actions { display:flex; gap:.75rem; flex-wrap:wrap; margin-top:.75rem; }
    .hero-media {
      aspect-ratio: 4/3; border-radius:.9rem; overflow:hidden; position:relative;
      background:
        radial-gradient(1200px 600px at -20% 120%, color-mix(in oklab, var(--accent-color) 25%, transparent) 0%, transparent 60%),
        radial-gradient(800px 400px at 120% -20%, color-mix(in oklab, var(--accent-2) 22%, transparent) 0%, transparent 60%),
        var(--surface-2);
      box-shadow: 0 10px 40px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.05);
    }
    .hero-media img { width:100%; height:100%; object-fit:cover; display:block; opacity:.96; }
    .kpis { display:flex; gap:1rem; flex-wrap:wrap; margin-top:1rem; }
    .kpi { background: var(--surface-1); padding:.65rem .8rem; border-radius:.6rem; border:1px solid rgba(255,255,255,.06); }
    .kpi strong { font-size:1.1rem; }

    /* Featured carousel-like grid */
.cards { display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:1rem; }
/* --- Enhanced Pokémon-style foil/glow for .card --- */
/* Default .card style */
/* --- Card base style --- */
.card {
  /* Theme-aware accent tint so it pops in light and dark */
  background: linear-gradient(
    135deg,
    color-mix(in oklab, var(--accent-color) 14%, var(--surface-1)),
    color-mix(in oklab, var(--accent-2) 14%, var(--surface-1))
  );
  border-radius: 1rem;
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: .8rem;
  /* Pokémon-style gold foil border and glow */
  border: 2px solid rgba(255, 215, 0, 0.6);
  box-shadow:
    0 0 12px rgba(255, 215, 0, 0.5),
    0 0 30px rgba(255, 215, 0, 0.3),
    -5px -5px 5px -5px var(--color1),
    5px 5px 5px -5px var(--color2),
    0 55px 35px -20px rgba(0,0,0,0.5);
  position: relative;
  height: 100%;
  transition: transform .3s ease, box-shadow .3s ease;
  overflow: hidden;
}

html[data-theme="light"] .card {
  /* Slightly stronger blend on light for clarity */
  background: linear-gradient(
    135deg,
    color-mix(in oklab, var(--accent-color) 16%, #ffffff),
    color-mix(in oklab, var(--accent-2) 16%, #ffffff)
  );
}
  .card::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 2px; /* thinner border */
    background: linear-gradient(120deg, var(--accent-color), var(--accent-2), var(--accent-color));
    background-size: 250% 250%;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
            mask-composite: exclude;
    pointer-events: none;
    animation: borderFlow 6s linear infinite;
    filter: brightness(1.1) saturate(1.2); /* softer glow */
    box-shadow: 0 0 8px var(--accent-color), 0 0 14px var(--accent-2); /* lighter shadows */
    z-index: 1;
  }

  html[data-theme="light"] .card::before {
    background: linear-gradient(120deg,
      color-mix(in oklab, var(--accent-color) 70%, white),
      color-mix(in oklab, var(--accent-2) 70%, white),
      color-mix(in oklab, var(--accent-color) 70%, white)
    );
    background-size: 250% 250%;
    animation: borderFlow 6s linear infinite;
    filter: brightness(1.2) saturate(1.1);
    box-shadow: 0 0 10px var(--accent-color), 0 0 18px var(--accent-2);
  }

/* Holo/sparkle overlay removed per design update */
.card::after { content: none; }

/* Light theme: holo overlay is subtle and lets content remain fully visible */
/* Light theme override not needed when overlay is removed */
/* html[data-theme="light"] .card::after { } */

/* Light theme Featured: apply contrast to background only, not content */
html[data-theme="light"] #featured .card { isolation: isolate; }
html[data-theme="light"] #featured .card::after { z-index: 0; }
html[data-theme="light"] #featured .card::before { z-index: 1; }
html[data-theme="light"] #featured .card > * { position: relative; z-index: 2; }

/* Dark theme overlay removed */
/* html[data-theme="dark"] .card::after { } */
html[data-theme="dark"] .card {
  /* Boost accent blend slightly in dark for pop */
  background: linear-gradient(
    135deg,
    color-mix(in oklab, var(--accent-color) 18%, var(--surface-1)),
    color-mix(in oklab, var(--accent-2) 18%, var(--surface-1))
  );
}

/* Overlay positioning rules removed since ::after is disabled */
/*
.cards .card:nth-of-type(1)::after { background-position: 25% 40%; }
.cards .card:nth-of-type(2)::after { background-position: 60% 75%; }
.cards .card:nth-of-type(3)::after { background-position: 90% 25%; }
*/

@keyframes borderFlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 200% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes foilShine {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}
/* Default .card .thumb style */
.card .thumb {
  aspect-ratio: 16/9;
  border-radius: .75rem;
  background: linear-gradient(135deg, color-mix(in oklab, var(--accent-color) 25%, transparent), color-mix(in oklab, var(--accent-2) 25%, transparent));
  position: relative;
  overflow: hidden;
}

/* Light theme: plain white background for .card .thumb */
html[data-theme="light"] .card .thumb {
  background: #fff;
}
.card .thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: transform .5s ease;
}
.card:hover .thumb img {
  transform: scale(1.08);
}
.card .thumb::after {
  content:"";
  position:absolute;
  inset:0;
  background: linear-gradient(120deg, rgba(255,255,255,.15) 0%, rgba(255,255,255,0) 60%);
  opacity: 0;
  transition: opacity .4s ease;
}
.card:hover .thumb::after {
  opacity: 1;
}
@keyframes shimmer{to{transform:translateX(120%);} }
    .meta { display:flex; gap:.5rem; flex-wrap:wrap; }

    /* Experience & Education (two-column cards with vertical timeline) */
    .xp-grid { display:grid; grid-template-columns: 1fr 1fr; gap:1.5rem; align-items:stretch; grid-auto-rows: 1fr; }
    .xp-panel {
      background: var(--surface-1);
      border-radius:.75rem;
      padding:1rem 1.1rem;
      border:1px solid rgba(255,255,255,.06);
      box-shadow: 0 6px 24px rgba(0,0,0,.12);
      display:flex;
      flex-direction:column;
      min-height:auto;
    }
    .xp-head { display:flex; align-items:center; gap:.6rem; margin:.1rem 0 1.1rem; }
    .xp-head .xp-icon { width:24px; height:24px; display:grid; place-items:center; border-radius:8px; background: var(--gradient-accent-soft); color: var(--accent-color); box-shadow: inset 0 0 0 1px rgba(255,255,255,.06); }
    .xp-panel h3 { margin:0; font-size:1.1rem; opacity:.9; }

    .xp-list { list-style:none; margin:0; padding:0 0 0 1.4rem; position:relative; flex:1; }
    .xp-list::before{ content:""; position:absolute; left:.6rem; top:.5rem; bottom:.5rem; width:2px; background: color-mix(in oklab, var(--accent-color) 18%, transparent); opacity:.6; }

    .xp-item {
      position:relative;
      padding:.45rem 0 .75rem 0;
      display:block;
    }
    .xp-item:not(:last-child){ border-bottom: 1px solid rgba(255,255,255,.06); }
    .xp-item:not(:last-child){ margin-bottom:.2rem; }
    .xp-item::before {
      content:"";
      position:absolute;
      left:-1.05rem; /* align exactly with the timeline line */
      top:.3rem;
      width:10px;
      height:10px;
      border-radius:50%;
      background: var(--accent-color);
      box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent-color) 25%, transparent);
    }

    /* Removed per-item icon column */
    .xp-icon { /* panel header only now */ }
    .xp-body { display:grid; gap:.35rem; max-width: 72ch; }
    .xp-date { color: var(--footer-color); font-weight: 700; font-size:.95rem; letter-spacing:.2px; }
    .xp-role { margin:.05rem 0 0; font-weight:800; font-size:1.15rem; line-height:1.25; }
    .xp-org { color: var(--footer-color); font-weight:600; font-size:1rem; }
    .xp-desc { color: var(--text-color); opacity:.92; margin:.25rem 0 0; line-height:1.6; padding-left:1.2rem; }
    .xp-desc strong.kw { font-weight: 800; }
    .xp-desc li { margin-bottom:.35rem; }
    @media (max-width: 900px){ .xp-grid { grid-template-columns: 1fr; } }

    /* Skills grid */
    .skills { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:1rem; }
    .skill { background: var(--surface-1); padding: .9rem 1rem; border-radius:.6rem; border:1px solid rgba(255,255,255,.06); box-shadow: 0 2px 8px rgba(0,0,0,.15); display:grid; gap:.5rem; }
    .skill-head { display:flex; align-items:center; justify-content:space-between; gap:.5rem; }
    .skill strong { font-size:1rem; }
    .level { font-size:.75rem; font-weight:700; padding:.2rem .5rem; border-radius:999px; background: var(--gradient-accent-soft); }
    .tags { display:flex; flex-wrap:wrap; gap:.35rem; }
    .tag { font-size:.75rem; padding:.2rem .45rem; border-radius:.35rem; background: var(--badge-bg); color: var(--badge-color); }
    .bar { height:8px; background: color-mix(in oklab, var(--accent-color) 18%, transparent); border-radius:999px; overflow:hidden; }
    /* Animate skill bar fill on reveal */
    @keyframes fillBar {
      from { width: 0; }
      to { width: var(--w, 60%); }
    }
    .bar > i {
      display: block;
      height: 100%;
      width: 0;
      background: var(--gradient-accent);
      border-radius: 999px;
    }
    .skill.reveal.visible .bar > i {
      animation: fillBar 1.5s ease-out forwards;
    }
    .skill.no-bar .bar { display: none; }

    /* Contact form */
    .contact-form { 
      display: grid; 
      gap: 1rem; 
      margin-bottom: 0.5rem; 
      max-width: 760px;
    }
    .contact-grid { display:grid; grid-template-columns: minmax(0,1fr) minmax(0,1fr); gap: 1rem; align-items: start; }
    @media (max-width: 820px){ .contact-grid { grid-template-columns: 1fr; } }
    .contact-grid > div { min-width: 0; }
    .contact-form label { display:block; font-weight:600; margin-bottom:.25rem; }
    .contact-form input, .contact-form textarea, .contact-form select {
      width:100%; padding:.65rem .8rem; border:1px solid rgba(0,0,0,.15); border-radius:.5rem; font-size:1rem; font-family:inherit; background: var(--surface-1); color: var(--text-color);
      box-sizing: border-box;
    }
    .contact-form input::placeholder, .contact-form textarea::placeholder { color: color-mix(in oklab, var(--text-color) 60%, transparent); }
    .contact-form input:focus, .contact-form textarea:focus, .contact-form select:focus { outline:none; border-color: var(--accent-color); box-shadow: var(--focus-ring); }
    .contact-actions { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; }
    .form-row { display: contents; }
    .char-counter { font-size: .85rem; color: var(--footer-color); text-align:right; margin-top:.25rem; }
    .form-status { font-size:.95rem; margin-top:.25rem; }
    .form-status.success { color:#2ecc71; }
    .form-status.error { color:#e74c3c; }
    .hidden-hp { position:absolute; left:-10000px; width:1px; height:1px; overflow:hidden; }
    .contact-wrap { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; align-items: start; }
    @media (max-width: 820px){ .contact-wrap { grid-template-columns: 1fr; } }

    /* Visitor map container: round corners, hide overflow, center content, and scale embedded content */
    .contact-wrap > div:last-child {
      border-radius: .75rem;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .contact-wrap > div:last-child iframe,
    .contact-wrap > div:last-child script,
    .contact-wrap > div:last-child img {
      max-width: 100%;
      height: auto;
      border-radius: .75rem;
    }

    .contact-card {
      min-height: 460px; /* adjust as needed */
    }
    .contact-form textarea {
      min-height: 200px; /* taller message box */
    }

    .contact-card {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      background: var(--surface-1);
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 8px 30px rgba(0,0,0,.15);
      align-items: start; /* Prevent stretching of grid items vertically */
    }

    .contact-card {
      transition: transform .22s ease, box-shadow .22s ease;
      will-change: transform;
    }
    .contact-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 26px rgba(0,0,0,.22);
    }

    .contact-left, .contact-right {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .contact-right h3 {
      margin: 0;
      font-size: 1.2rem;
      font-weight: 800;
      color: var(--text-color);
    }

    .contact-right p.small {
      font-size: .9rem;
      color: var(--footer-color);
      margin-top: -.25rem;
    }

    @media (max-width: 820px) {
      .contact-card {
        grid-template-columns: 1fr;
      }
    }

    /* Visitor map theme toggling */
    .map-dark { display: none; }
    html[data-theme="dark"] .map-light { display: none; }
    html[data-theme="dark"] .map-dark { display: block; }

    /* Visitor map: simple heading + legend */
    .visitor-map-wrap { display:flex; flex-direction:column; gap:.5rem; }
    .visitor-map-head { display:flex; align-items:center; justify-content:space-between; gap:.75rem; }
    .visitor-map-title { margin:0; font-size:1rem; font-weight:800; letter-spacing:.2px; }
    .map-legend { display:inline-flex; align-items:center; gap:.75rem; font-size:.9rem; color: var(--footer-color); }
    .legend-item { display:inline-flex; align-items:center; gap:.4rem; }
    .legend-dot { width:.7rem; height:.7rem; border-radius:50%; display:inline-block; }
    /* Theme-aware marker colors for map legend */
    .legend-recent { background:#ff8a00; } /* light: recent = orange */
    .legend-past { background:#22c55e; }   /* light: past = green  */

    html[data-theme="dark"] .legend-recent { background:#ff8a00; } /* match light recent (orange) */
    html[data-theme="dark"] .legend-past { background:#22c55e; }   /* match light past (green) */

    .visitor-map-frame {
      border-radius: .75rem;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      background: var(--surface-1);
      flex: 0 0 auto;
      height: 300px;
      width: 100%;
      position: relative; /* keep space reserved */
    }
    .visitor-map-frame iframe {
      width: 100%;
      height: 100%;
      border: none;
      border-radius: .75rem;
      display: block;
      overflow: hidden;
    }

    /* Visitor map placeholder for fade transitions */
    #visitorMapPlaceholder {
      opacity: 1;
      transition: opacity 0.05s linear, opacity 0.8s ease-in;
      width: 100%;
      height: 100%;
      position: absolute; /* sit inside frame without changing layout */
      top: 0;
      left: 0;
    }

    /* Footer links */
    .site-footer a { color: var(--accent-color); text-decoration: none; }
    .site-footer a:hover { text-decoration: underline; }

    /* Global link style override */
    a {
      color: var(--accent-color);
      text-decoration: none;
    }
    a:hover {
      color: var(--accent-hover);
      text-decoration: underline;
    }

    /* SVG icon links in "Follow me" section: no underline on hover */
    .hello-meta .item a {
      text-decoration: none;
      border-bottom: none;
    }
    .hello-meta .item a:hover {
      text-decoration: none;
      border-bottom: none;
    }

    
    /* Mobile menu (optional) */
    .menu-toggle { display:none; }
    @media (max-width: 760px) {
      .nav-links { display:none; }
      .menu-toggle { display:block; }
      .nav-open .nav-links { display:flex; flex-direction:column; position:absolute; left:0; right:0; top:56px; padding: .5rem 1rem; background: var(--surface-2); border-bottom:1px solid rgba(255,255,255,.06); }
      body.nav-open{overflow:hidden}
    }
    /* --- About Me Label --- */
    .about-me-label {
      font-weight: 800;
      text-transform: capitalize;
      font-weight: 700;
      color: var(--text-color);
      background: none;
      -webkit-background-clip: initial;
      -webkit-text-fill-color: initial;
      display: inline-block;
      margin-bottom: 0.5rem;
    }

    /* Remove any previous overlay code for #about section (if present) */

    /* --- Theme background blocking for .hello and .hello-meta --- */
    [data-theme="dark"] .hello,
    [data-theme="dark"] .hello-meta,
    [data-theme="dark"] .hello-meta .item {
      background: transparent !important;
    }

    /* Optionally, keep light theme .hello/.hello-meta transparent if desired */
    /*
    html[data-theme="light"] .hello,
    html[data-theme="light"] .hello-meta,
    html[data-theme="light"] .hello-meta .item {
      background: transparent !important;
    }
    */

    /* Removed or commented out: old lines that forced .hello/.hello-meta to transparent in dark mode */
    /*
    [data-theme="dark"] .hello,
    [data-theme="dark"] .hello-meta {
      background: transparent !important;
    }
    */
  .hithere {
    animation: hithere 1s ease infinite;
    animation-delay: 0s; /* no delay */
  }
  @keyframes hithere {
    30% { transform: scale(1); }
    40%, 60% { transform: rotate(-20deg) scale(1); }
    50% { transform: rotate(20deg) scale(1); }
    70% { transform: rotate(0deg) scale(1); }
    100% { transform: scale(1); }
  }

  .flash {
    animation: flash 500ms ease infinite alternate;
  }
  @keyframes flash {
    from { opacity: 1; }
    to { opacity: 0; }
  }
  </style>
  <style>
  .container_mouse {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: -8rem;
    margin-bottom: 2rem;
  }
  .mouse-btn {
    display: inline-block;
    width: 28px;
    height: 50px;
    border: 2px solid var(--accent-color);
    border-radius: 25px;
    position: relative;
    margin-bottom: 0.5rem;
  }
  .mouse-scroll {
    width: 6px;
    height: 6px;
    background: var(--accent-color);
    border-radius: 50%;
    position: absolute;
    top: 8px;
    left: 50%;
    transform: translateX(-50%);
    animation: scrollAnim 1s linear infinite;
  }
  @keyframes scrollAnim {
    0% {
      opacity: 0;
      transform: translate(-50%, -5px);
    }
    50% {
      opacity: 1;
      transform: translate(-50%, 15px);
    }
    100% {
      opacity: 0;
      transform: translate(-50%, 30px);
    }
  }
    
  .container_mouse span {
    font-size: 0.9rem;
    color: var(--footer-color);
  }
  </style>
  <script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/MorphSVGPlugin.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/Draggable.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
  <!-- Rope-pull toggle -->
  
  
  <!-- GSAP Featured Cards Flip Animation -->
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    if (typeof gsap !== "undefined" && typeof ScrollTrigger !== "undefined") {
      gsap.registerPlugin(ScrollTrigger);

      // Smooth flipping animation for featured cards
      gsap.fromTo("#featured .card", 
        { opacity: 0, rotateY: -90, transformPerspective: 1000, y: 40 },
        { opacity: 1, rotateY: 0, y: 0,
          duration: 1.2,
          ease: "power3.out",
          stagger: 0.2,
          scrollTrigger: {
            trigger: "#featured",
            start: "top 80%",
            end: "top 30%",
            scrub: true
          }
        }
      );

      // Smooth flip and rise animation for project cards (bidirectional)
      gsap.fromTo("#projects .project-card", 
        { opacity: 0, rotateY: -90, y: 80, transformPerspective: 1000 },
        { opacity: 1, rotateY: 0, y: 0,
          duration: 1.4,
          ease: "power3.inOut",
          stagger: { each: 0.25, ease: "power2.inOut" },
          scrollTrigger: {
            trigger: "#projects",
            start: "top 85%",
            end: "bottom 85%",
            scrub: true,
            toggleActions: "play none none reverse"
          }
        }
      );

      // Unique animation for Writing & Talks cards
      gsap.fromTo("#writing .talk-card", 
        { opacity: 0, y: 80, rotateY: 25, transformPerspective: 800, scale: 0.95 },
        { opacity: 1, y: 0, rotateY: 0, scale: 1,
          duration: 1.3,
          ease: "power2.out",
          stagger: 0.25,
          scrollTrigger: {
            trigger: "#writing",
            start: "top 85%",
            end: "bottom 65%",
            scrub: 0.5
          }
        }
      );

      // Playful smooth tilt + bounce-in animation for Contact section card
      gsap.fromTo("#contact .contact-card", 
        { opacity: 0, y: 150, rotateY: -45, rotateX: 15, scale: 0.8, transformPerspective: 1200 },
        { opacity: 1, y: 0, rotateY: 0, rotateX: 0, scale: 1,
          duration: 2,
          ease: "elastic.out(1, 0.6)",
          scrollTrigger: {
            trigger: "#contact",
            start: "top 85%",
            end: "bottom 70%",
            scrub: true,
            toggleActions: "play none none reverse"
          }
        }
      );
    }
  });
  </script>
  <link rel="preload" as="image" href="/images/personal.png">
  <link rel="preload" as="image" href="/images/lang.png">
</head>
<body id="top" class="preload">
  <div class="language-overlay" id="languageOverlay">
    <div class="settings-card" role="dialog" aria-modal="true" aria-label="Setup" aria-labelledby="settingsTitle">
    
      <div class="settings-hero ov-item" style="--d:.05s">
        <div class="lang-logo-wrap">
          <img src="images/lang.png" alt="Globe" class="lang-logo" />
        </div>
      </div>

      <!-- Appearance first -->
      <div class="settings-section ov-item" style="--d:.15s">
        <div class="settings-item">
          <div class="item-text">
            <div class="item-title" data-i18n data-i18n-en="Appearance" data-i18n-zh="外观" data-i18n-ja="外観">Appearance</div>
            <div class="item-sub" data-i18n data-i18n-en="Light or Dark theme" data-i18n-zh="浅色或深色主题" data-i18n-ja="ライトまたはダークのテーマ">Light or Dark theme</div>
          </div>
          <div class="overlay-theme" aria-label="Theme chooser">
            <button class="theme-toggle" id="theme-toggle-overlay" aria-label="Toggle theme" aria-pressed="false" title="Toggle theme">
              <svg class="sun-and-moon" aria-hidden="true" width="24" height="24" viewBox="0 0 24 24">
                <mask class="moon" id="moon-mask-overlay">
                  <rect width="100%" height="100%" fill="white"/>
                  <circle cx="24" cy="10" r="6" fill="black"/>
                </mask>
                <circle class="sun" cx="12" cy="12" r="6" mask="url(#moon-mask-overlay)" fill="currentColor"/>
                <g class="sun-beams" stroke="currentColor">
                  <line x1="12" y1="1"  x2="12" y2="3"/>
                  <line x1="12" y1="21" x2="12" y2="23"/>
                  <line x1="4.22" y1="4.22"  x2="5.64" y2="5.64"/>
                  <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                  <line x1="1" y1="12" x2="3" y2="12"/>
                  <line x1="21" y1="12" x2="23" y2="12"/>
                  <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                  <line x1="18.36" y1="5.64"  x2="19.78" y2="4.22"/>
                </g>
              </svg>
            </button>
            <span class="theme-label" id="overlayThemeLabel">Light</span>
          </div>
        </div>
      </div>

      <!-- Language second -->
      <div class="settings-section ov-item" style="--d:.25s">
        <div class="lang-switcher lang-dd" id="overlayLang" data-open="false" data-current="en" aria-label="Language selector">
          <button id="overlayLangTrigger" class="settings-row-btn" aria-haspopup="listbox" aria-expanded="false" aria-label="Select language">
            <span class="item-title" data-i18n data-i18n-en="Language" data-i18n-zh="语言" data-i18n-ja="言語">Language</span>
            <span id="overlayLangTriggerLabel" class="lang-trigger-label">EN</span>
            <svg class="chev" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M5.23 7.21a.75.75 0 011.06.02L10 11.085l3.71-3.855a.75.75 0 111.08 1.04l-4.24 4.4a.75.75 0 01-1.08 0l-4.24-4.4a.75.75 0 01.02-1.06z"/>
            </svg>
          </button>
          <ul id="overlayLangMenu" class="lang-menu" role="listbox" aria-label="Language">
            <li><button role="option" data-lang="en" aria-selected="true">English</button></li>
            <li><button role="option" data-lang="zh" aria-selected="false">中文</button></li>
            <li><button role="option" data-lang="ja" aria-selected="false">日本語</button></li>
          </ul>
        </div>
      </div>

      <button id="enterSiteBtn" class="enter-btn ov-item magnet" style="--d:.55s" aria-label="Enter site" title="Enter" data-i18n data-i18n-attrs="aria-label,title" data-i18n-aria-label-en="Enter site" data-i18n-aria-label-zh="进入网站" data-i18n-aria-label-ja="サイトに入る" data-i18n-title-en="Enter" data-i18n-title-zh="进入" data-i18n-title-ja="入る">
        <svg class="enter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M13.5 5.5a1 1 0 011.414 0l5.586 5.586a1 1 0 010 1.414L14.914 18.086a1 1 0 11-1.414-1.414L17.172 13H4a1 1 0 110-2h13.172l-3.672-3.672a1 1 0 010-1.414z"/>
        </svg>
      </button>
    </div>
  </div>
  

<div id="siteContent">

  <div class="background-shapes"></div>
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.querySelector(".background-shapes");
    const colorsDark = ["rgba(188,164,139,0.25)", "rgba(200,92,66,0.15)", "rgba(72,165,162,0.15)"];
    const colorsLight = ["rgba(188,164,139,0.35)", "rgba(200,92,66,0.25)", "rgba(72,165,162,0.25)"];
    const numShapes = 8;
    // Deterministic shape properties
    const sizes = [60, 80, 100, 120, 90, 70, 110, 50];
    // Custom sequence for appearance order (delays)
    const delayOrder = [5, 2, 3, 7, 6, 0, 1, 4];
    for (let i = 0; i < numShapes; i++) {
      let shape;
      if (i === 0) {
        shape = document.createElement("img");
        shape.src = "/icons/code.png";
        shape.classList.add("code-icon");
      } else if (i === 1) {
        shape = document.createElement("img");
        shape.src = "/icons/coffee.png";
        shape.classList.add("coffee-icon");
  
      } else if (i === 2) {
        shape = document.createElement("img");
        shape.src = "/icons/cooking.png";
        shape.classList.add("cooking-icon");
      } else if (i === 3) {
        shape = document.createElement("img");
        shape.src = "/icons/game.png";
        shape.classList.add("game-icon");
      } else if (i === 4) {
        shape = document.createElement("img");
        shape.src = "/icons/world.png";
        shape.classList.add("world-icon");
      } else if (i === 5) {
        shape = document.createElement("img");
        shape.src = "/icons/eyes.png";
        shape.classList.add("floating-shape");
      } else if (i === 7) {
        const wrapper = document.createElement("div");
        wrapper.classList.add("soccer-wrapper");

        shape = document.createElement("img");
        shape.src = "/icons/soccer.png";
        shape.classList.add("soccer-icon", "bounce2");

        wrapper.appendChild(shape);
        shape = wrapper;
      } else {
        shape = document.createElement("div");
        shape.classList.add("floating-shape");
      }
      // Deterministic size
      const size = sizes[i % sizes.length];
      shape.style.setProperty("--size", size + "px");

      // Deterministic color from palette
      const theme = document.documentElement.getAttribute("data-theme");
      const palette = theme === "dark" ? colorsDark : colorsLight;
      // Only set background for generic floating-shape divs, not .soccer-wrapper
      if (
        shape.tagName.toLowerCase() === "div" &&
        !shape.classList.contains("soccer-wrapper")
      ) {
        shape.style.background = palette[i % palette.length];
      }
      container.appendChild(shape);
    }
  });
  </script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const overlay = document.getElementById("languageOverlay");
  const siteContent = document.getElementById("siteContent");
  const langSelect = document.getElementById("languageSelect");

  if (localStorage.getItem("hasVisited")) {
    // Returning visitor: remove overlay, show siteContent
    if (overlay) overlay.remove();
    if (siteContent) {
      siteContent.classList.add("visible");
      siteContent.style.display = "block";
    }
    // Set language selection if available
    const savedLang = localStorage.getItem("selectedLang");
    if (langSelect && savedLang) langSelect.value = savedLang;
    // Ensure GSAP/ScrollTrigger recalculates positions in case layout changed
    try { if (window.ScrollTrigger) ScrollTrigger.refresh(); } catch(_) {}
  } else {
    // First time visitor: show overlay, hide siteContent
    if (overlay) overlay.classList.remove("hidden");
    if (siteContent) {
      siteContent.classList.remove("visible");
      siteContent.style.display = "none";
    }
    if (overlay) {
      // Kick off staged entrance animations
      try { requestAnimationFrame(() => overlay.classList.add('showing')); } catch(_) {}
      try { document.body.dataset.prevOverflow = document.body.style.overflow; document.body.style.overflow = 'hidden'; } catch(_) {}
      try { if (siteContent) { siteContent.setAttribute('aria-hidden', 'true'); siteContent.setAttribute('inert', ''); } } catch(_) {}
      // New: overlay dropdown-style language selector
      const oWrap = document.getElementById('overlayLang');
      const oTrigger = document.getElementById('overlayLangTrigger');
      const oLabel = document.getElementById('overlayLangTriggerLabel');
      const oMenu = document.getElementById('overlayLangMenu');
      const oOpts = oMenu ? Array.from(oMenu.querySelectorAll('button[role="option"]')) : [];

      const LABELS = { en: 'EN', zh: '中文', ja: '日本語' };

      function reflectOverlay(lang){
        if (!oWrap) return;
        oWrap.dataset.current = lang;
        if (oLabel) oLabel.textContent = LABELS[lang] || 'EN';
        oOpts.forEach(o => o.setAttribute('aria-selected', String(o.dataset.lang === lang)));
      }

      // init overlay state from storage or default
      const initLang = (window.__i18n && window.__i18n.getInitialLang && window.__i18n.getInitialLang()) || localStorage.getItem('selectedLang') || (document.documentElement.getAttribute('lang')||'en');
      reflectOverlay(initLang);

      function openLangMenu(setOpen){
        if (!oWrap || !oTrigger) return;
        const open = setOpen ?? (oWrap.getAttribute('data-open') !== 'true');
        oWrap.setAttribute('data-open', String(open));
        oTrigger.setAttribute('aria-expanded', String(open));
        if (open && oMenu) {
          const current = oOpts.find(o => o.getAttribute('aria-selected') === 'true') || oOpts[0];
          if (current) current.focus();
        }
      }
      if (oTrigger && oWrap) {
        oTrigger.addEventListener('click', () => openLangMenu());
        oTrigger.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowDown' || e.key === 'ArrowUp' || e.key === ' ') {
            e.preventDefault();
            openLangMenu(true);
          }
        });
      }

      // choose option -> persist and live-apply on overlay (no reload yet)
      oOpts.forEach(o => o.addEventListener('click', () => {
        const lang = o.dataset.lang;
        try { localStorage.setItem('selectedLang', lang); } catch (_) {}
        reflectOverlay(lang);
        try { document.documentElement.setAttribute('lang', lang); } catch(_) {}
        // Live-apply i18n to update overlay labels immediately (Appearance/Language/etc.)
        try { if (window.__i18n && typeof window.__i18n.apply === 'function') window.__i18n.apply(lang); } catch(_) {}
        // Also update the overlay theme label text to match current theme and lang
        try {
          const themeLbl = document.getElementById('overlayThemeLabel');
          const isDark = (document.documentElement.getAttribute('data-theme')||'light') === 'dark';
          const THEME_LABELS = { en: { light: 'Light', dark: 'Dark' }, zh: { light: '浅色', dark: '深色' }, ja: { light: 'ライト', dark: 'ダーク' } };
          const map = THEME_LABELS[lang] || THEME_LABELS.en;
          if (themeLbl) themeLbl.textContent = isDark ? map.dark : map.light;
        } catch(_) {}
        if (oWrap && oTrigger) { oWrap.setAttribute('data-open', 'false'); oTrigger.setAttribute('aria-expanded', 'false'); }
      }));

      // Keyboard nav inside menu


      // Keyboard nav inside menu
      if (oMenu) {
        oMenu.addEventListener('keydown', (e) => {
          const idx = oOpts.indexOf(document.activeElement);
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            const next = oOpts[(idx + 1 + oOpts.length) % oOpts.length];
            if (next) next.focus();
          } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            const prev = oOpts[(idx - 1 + oOpts.length) % oOpts.length];
            if (prev) prev.focus();
          } else if (e.key === 'Home') {
            e.preventDefault();
            if (oOpts[0]) oOpts[0].focus();
          } else if (e.key === 'End') {
            e.preventDefault();
            if (oOpts[oOpts.length - 1]) oOpts[oOpts.length - 1].focus();
          } else if (e.key === 'Escape') {
            e.preventDefault();
            openLangMenu(false);
            if (oTrigger) oTrigger.focus();
          } else if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            if (document.activeElement && typeof document.activeElement.click === 'function') {
              document.activeElement.click();
            }
          }
        });
      }

      // Enter button -> mark visited and reload with selected language
      const enterBtn = document.getElementById('enterSiteBtn');
      if (enterBtn) enterBtn.addEventListener('click', (ev) => {
        // ensure there is some lang value
        const lang = (window.__i18n && window.__i18n.getInitialLang && window.__i18n.getInitialLang()) || localStorage.getItem('selectedLang') || (document.documentElement.getAttribute('lang')||'en');
        try { localStorage.setItem('selectedLang', lang); } catch (_) {}
        try { localStorage.setItem('hasVisited', 'true'); } catch (_) {}
        // small confetti celebration (respects reduced motion)
        try {
          const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
          if (!reduce) {
            const rect = enterBtn.getBoundingClientRect();
            const cx = rect.left + rect.width/2;
            const cy = rect.top + rect.height/2;
            const colors = ['#48A5A2','#C85C42','#BCA48B','#FFE082','#7FB3D5'];
            for (let i=0;i<28;i++){
              const piece = document.createElement('span');
              piece.className = 'confetti';
              const angle = (Math.PI*2) * (i/28) + (Math.random()*0.6 - 0.3);
              const speed = 80 + Math.random()*140;
              const dx = Math.cos(angle) * speed;
              const dy = Math.sin(angle) * speed + 200;
              const rot = (Math.random()*360)|0;
              piece.style.left = cx + 'px';
              piece.style.top = cy + 'px';
              piece.style.setProperty('--x','0px');
              piece.style.setProperty('--y','0px');
              piece.style.setProperty('--dx', dx+'px');
              piece.style.setProperty('--dy', dy+'px');
              piece.style.setProperty('--rot', rot+'deg');
              piece.style.background = colors[i % colors.length];
              document.body.appendChild(piece);
              piece.addEventListener('animationend', () => piece.remove(), { once:true });
            }
          }
        } catch(_) {}
        // Sync header hidden select once more
        if (langSelect) {
          langSelect.value = lang;
          try { langSelect.dispatchEvent(new Event('change', { bubbles: true })); } catch (_) {}
        }
        // Reload to apply language (URL param)
        if (typeof window.__i18n?.setLangAndReload === 'function') {
          window.__i18n.setLangAndReload(lang);
        }
      });

      // close overlay dropdown on outside click / Esc
      document.addEventListener('click', (e) => {
        if (oWrap && !oWrap.contains(e.target)) {
          oWrap.setAttribute('data-open','false');
          if (oTrigger) oTrigger.setAttribute('aria-expanded','false');
        }
      });
      // Gentle magnet effect on enter button
      try {
        const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        if (!reduce && enterBtn){
          const strength = 6; // px
          const onMove = (e) => {
            const r = enterBtn.getBoundingClientRect();
            const x = (e.clientX - (r.left + r.width/2)) / (r.width/2);
            const y = (e.clientY - (r.top + r.height/2)) / (r.height/2);
            enterBtn.style.transform = `translate(${x*strength}px, ${y*strength}px)`;
          };
          const onLeave = () => { enterBtn.style.transform = ''; };
          enterBtn.addEventListener('mousemove', onMove);
          enterBtn.addEventListener('mouseleave', onLeave);
        }
      } catch(_) {}
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && oWrap && oTrigger) {
          oWrap.setAttribute('data-open','false');
          oTrigger.setAttribute('aria-expanded','false');
        }
      });

      // Focus trap within dialog
      const dialog = overlay.querySelector('[role="dialog"]');
      if (dialog) {
        const focusSelector = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
        const getFocusables = () => Array.from(dialog.querySelectorAll(focusSelector)).filter(el => !el.hasAttribute('disabled'));
        setTimeout(() => { try { oTrigger && oTrigger.focus(); } catch(_) {} }, 0);
        dialog.addEventListener('keydown', (e) => {
          if (e.key !== 'Tab') return;
          const els = getFocusables();
          if (!els.length) return;
          const first = els[0];
          const last = els[els.length - 1];
          if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
          else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
        });
      }
    }
  }
  // Save language if dropdown changes (top-right menu)
  if (langSelect) {
    langSelect.addEventListener("change", () => {
      localStorage.setItem("selectedLang", langSelect.value);
    });
  }
});
</script>
  <a class="skip-link" href="#featured">Skip to content</a>
  <nav class="site-nav" aria-label="Primary">
    <div class="nav-inner fade-up">
      <div class="brand">
        <img src="/images/logo.png" alt="ZC Logo" class="logo-zc" width="38" height="38">
        <span class="name-with-audio">
          <span class="highlight-name" id="displayNameNav">Zǐjié Cài</span>
          <button class="pronounce-btn" id="pronounceNav" aria-label="Hear how to pronounce ‘Zǐjié Cài’" title="Hear pronunciation">
  <span class="icon icon-play" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
    </svg>
  </span>
  <span class="icon icon-pause" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
    </svg>
  </span>
</button>
        </span>
      </div>
      <button class="btn small menu-toggle" id="menuToggle" aria-expanded="false" aria-controls="primary-links">Menu</button>
      <div class="nav-links" id="primary-links">
        <a href="#about" data-i18n data-i18n-en="About" data-i18n-zh="关于" data-i18n-ja="自己紹介">About</a>
        <a href="#featured" data-i18n data-i18n-en="Featured" data-i18n-zh="精选" data-i18n-ja="注目">Featured</a>
        <a href="#projects" data-i18n data-i18n-en="Projects" data-i18n-zh="项目" data-i18n-ja="プロジェクト">Projects</a>
        <a href="#experience" data-i18n data-i18n-en="Experience" data-i18n-zh="经历" data-i18n-ja="経験">Experience</a>
        <a href="#skills" data-i18n data-i18n-en="Skills" data-i18n-zh="技能" data-i18n-ja="スキル">Skills</a>
        <a href="#writing" data-i18n data-i18n-en="Writing" data-i18n-zh="写作" data-i18n-ja="記事">Writing</a>
        <a href="#contact" data-i18n data-i18n-en="Contact" data-i18n-zh="联系" data-i18n-ja="連絡先">Contact</a>
      </div>
      <div class="nav-cta">
        <button class="theme-toggle" id="theme-toggle" aria-label="light" title="Toggle theme">
          <svg class="sun-and-moon" aria-hidden="true" width="24" height="24" viewBox="0 0 24 24">
            <mask class="moon" id="moon-mask">
              <rect width="100%" height="100%" fill="white"/>
              <circle cx="24" cy="10" r="6" fill="black"/>
            </mask>
            <circle class="sun" cx="12" cy="12" r="6" mask="url(#moon-mask)" fill="currentColor"/>
            <g class="sun-beams" stroke="currentColor">
              <line x1="12" y1="1"  x2="12" y2="3"/>
              <line x1="12" y1="21" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22"  x2="5.64" y2="5.64"/>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="3" y2="12"/>
              <line x1="21" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
              <line x1="18.36" y1="5.64"  x2="19.78" y2="4.22"/>
            </g>
          </svg>
        </button>
        <div class="lang-switcher lang-dd" data-open="false" data-current="en">
  <script>
  (function(){
    const storageKey = 'theme-preference';
    const $html = document.documentElement;
    const navBtn = document.getElementById('theme-toggle');
    const overlayBtn = document.getElementById('theme-toggle-overlay');
    const overlayLabel = document.getElementById('overlayThemeLabel');

    function reflect(theme){
      $html.setAttribute('data-theme', theme);
      const isDark = theme === 'dark';
      const nextLabel = isDark ? 'Switch to light' : 'Switch to dark';
      // keep labels and pressed state accurate
      if (navBtn) {
        navBtn.setAttribute('aria-pressed', String(isDark));
        navBtn.setAttribute('aria-label', nextLabel);
        navBtn.title = nextLabel;
      }
      if (overlayBtn) {
        overlayBtn.setAttribute('aria-pressed', String(isDark));
        overlayBtn.setAttribute('aria-label', nextLabel);
        overlayBtn.title = nextLabel;
      }
      if (overlayLabel) {
        const lang = (window.__i18n && window.__i18n.getInitialLang && window.__i18n.getInitialLang()) || (document.documentElement.getAttribute('lang')||'en');
        const LABELS = {
          en: { light: 'Light', dark: 'Dark' },
          zh: { light: '浅色', dark: '深色' },
          ja: { light: 'ライト', dark: 'ダーク' }
        };
        const lset = LABELS[lang] || LABELS.en;
        overlayLabel.textContent = isDark ? lset.dark : lset.light;
      }
      // Let components react if they listen
      window.dispatchEvent(new CustomEvent('themechange', { detail: { theme } }));
    }
    function setTheme(theme){
      localStorage.setItem(storageKey, theme);
      reflect(theme);
    }
    function toggleTheme(){
      const current = $html.getAttribute('data-theme') || 'light';
      setTheme(current === 'light' ? 'dark' : 'light');
    }
    // Initialize from storage (or bootstrap value)
    (function init(){
      const stored = localStorage.getItem(storageKey);
      const initial = stored || (window.__themePref || 'light');
      reflect(initial);
    })();

    // Bind both buttons if present
    if (navBtn) navBtn.addEventListener('click', toggleTheme);
    if (overlayBtn) overlayBtn.addEventListener('click', toggleTheme);

    // Optional: keep overlay background in sync immediately
    window.addEventListener('themechange', () => {
      // No-op here; CSS variables update automatically via [data-theme]
    });
  })();
  </script>
          <button id="langTrigger" class="lang-trigger" aria-haspopup="listbox" aria-expanded="false" aria-label="Select language">
            <span id="langTriggerLabel" class="lang-trigger-label">EN</span>
            <svg class="chev" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M5.23 7.21a.75.75 0 011.06.02L10 11.085l3.71-3.855a.75.75 0 111.08 1.04l-4.24 4.4a.75.75 0 01-1.08 0l-4.24-4.4a.75.75 0 01.02-1.06z"/>
            </svg>
          </button>
          <ul id="langMenu" class="lang-menu" role="listbox" aria-label="Language">
            <li><button role="option" data-lang="en" aria-selected="true">English</button></li>
            <li><button role="option" data-lang="zh" aria-selected="false">中文</button></li>
            <li><button role="option" data-lang="ja" aria-selected="false">日本語</button></li>
          </ul>
          <!-- Hidden fallback select to keep current scripts working -->
          <select id="languageSelect" hidden>
            <option value="en" selected>EN</option>
            <option value="zh">中文</option>
            <option value="ja">日本語</option>
          </select>
        </div>
      </div>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const trigger = document.getElementById('langTrigger');
    const label = document.getElementById('langTriggerLabel');
    const menu = document.getElementById('langMenu');
    const hiddenSelect = document.getElementById('languageSelect');
    const wrap = trigger ? trigger.closest('.lang-switcher.lang-dd') : null;
    if (!wrap || !trigger || !menu) return;
    const opts = Array.from(menu.querySelectorAll('button[role="option"]'));

    const LABELS = { en: 'EN', zh: '中文', ja: '日本語' };

    function setLang(lang){
      // persist
      localStorage.setItem('selectedLang', lang);
      // reflect
      wrap.dataset.current = lang;
      label.textContent = LABELS[lang] || 'EN';
      opts.forEach(o => o.setAttribute('aria-selected', String(o.dataset.lang === lang)));
      // sync hidden select for any existing listeners
      if (hiddenSelect) hiddenSelect.value = lang;
    }

    // init from storage (or default)
    setLang((window.__i18n && window.__i18n.getInitialLang && window.__i18n.getInitialLang()) || localStorage.getItem('selectedLang') || (document.documentElement.getAttribute('lang')||'en'));

    // open/close
    trigger.addEventListener('click', () => {
      const open = wrap.getAttribute('data-open') === 'true';
      wrap.setAttribute('data-open', String(!open));
      trigger.setAttribute('aria-expanded', String(!open));
    });

    // choose option
    opts.forEach(o => o.addEventListener('click', () => {
      const lang = o.dataset.lang;
      setLang(lang);
      wrap.setAttribute('data-open', 'false');
      trigger.setAttribute('aria-expanded', 'false');
      if (typeof window.__i18n?.setLangAndReload === 'function') {
        window.__i18n.setLangAndReload(lang, { skipVisited: true });
      }
    }));

    // close on outside click / Esc
    document.addEventListener('click', (e) => {
      if (wrap && !wrap.contains(e.target)) { wrap.setAttribute('data-open','false'); trigger.setAttribute('aria-expanded','false'); }
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') { wrap.setAttribute('data-open','false'); trigger.setAttribute('aria-expanded','false'); }
    });

    // if some external code changes the hidden select, mirror it
    if (hiddenSelect) {
      hiddenSelect.addEventListener('change', () => {
        const lang = hiddenSelect.value;
        setLang(lang);
        if (typeof window.__i18n?.setLangAndReload === 'function') {
          window.__i18n.setLangAndReload(lang, { skipVisited: true });
        }
      });
    }
  });
  </script>
    </div>
  </nav>


  <header class="hello fade-up" id="about">
    
    <figure class="avatar" aria-label="Portrait">
      <!-- Put your headshot at /images/portrait.jpg -->
      <img src="/images/personal.png" alt="Portrait of Zijie Cai" loading="lazy" decoding="async" onerror="this.style.display='none';">
    </figure>
    <div>
      <h1>
        <span class="intro-wave" data-i18n data-i18n-en="Hello, I’m" data-i18n-zh="你好，我是" data-i18n-ja="こんにちは、私は">Hello, I’m</span>
        <span class="name-with-audio">
          <span class="highlight-name" id="displayNameHero">Zǐjié Cài</span>
          <button class="pronounce-btn" id="pronounceHero" aria-label="Hear how to pronounce ‘Zǐjié Cài’" title="Hear pronunciation">
  <span class="icon icon-play" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
    </svg>
  </span>
  <span class="icon icon-pause" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
    </svg>
  </span>
</button>
        </span>
      </h1>
      <p class="blurb" data-i18n data-i18n-html
         data-i18n-en='
  <strong class="about-me-label">A Bit About Me:</strong><br>
  I’m a <span class="pill">AI Engineer</span> <span class="pill">Researcher</span>, <span class="pill">Creator</span>, and <span class="pill pill--ghost" aria-hidden="true"></span>&nbsp;passionate about<br><em>multimodal perception</em>, <em>agentic systems</em>, and <strong>shipping playful products</strong>.<br>
  <span style="display:block; margin-top:.4rem;">I <u>transform research ideas into real-world tools</u> that people actually use.</span>'
         data-i18n-zh='
  <strong class="about-me-label">关于我：</strong><br>
  我是一名 <span class="pill">AI 工程师</span> <span class="pill">研究者</span>、<span class="pill">创作者</span>、<span class="pill pill--ghost" aria-hidden="true"></span>&nbsp;热衷于<br><em>多模态感知</em>、<em>Agent 系统</em>，以及<strong>把有趣的想法做成真正的产品</strong>。<br>
  <span style="display:block; margin-top:.4rem;">我致力于<u>把研究想法转化为真正可用的工具</u>，并让更多人用起来。</span>'
         data-i18n-ja='
  <strong class="about-me-label">私について少し：</strong><br>
  私は <span class="pill">AI エンジニア</span><span class="pill">研究者</span>・<span class="pill">クリエイター</span>・<span class="pill pill--ghost" aria-hidden="true"></span>&nbsp;<em>マルチモーダル知覚</em>、<em>エージェントシステム</em>、<strong>遊び心のある製品の作成</strong>に情熱を注いでいます。<br>
  <span style="display:block; margin-top:.4rem;">研究のアイデアを<u>人々が実際に使う実用的なツール</u>へと形にします。</span>'>
      </p>
      <div class="cta-row">
        <a class="cta resume" href="/cv.pdf" download data-i18n data-i18n-en="Resume" data-i18n-zh="简历" data-i18n-ja="履歴書">Resume</a>
        <a class="cta projects" href="#projects" data-i18n data-i18n-en="Projects" data-i18n-zh="项目" data-i18n-ja="プロジェクト">Projects</a>
        <a class="cta contact" href="#contact" data-i18n data-i18n-en="Contact" data-i18n-zh="联系" data-i18n-ja="連絡先">Contact</a>
      </div>
    </div>
  </header>

  <div class="hello-meta fade-up" aria-label="Quick contact">
    <div class="item"><strong data-i18n data-i18n-en="Phone" data-i18n-zh="电话" data-i18n-ja="電話">Phone</strong> <a href="sms:3012634246">301‑263‑4246</a></div>
    <div class="item"><strong data-i18n data-i18n-en="Email" data-i18n-zh="邮箱" data-i18n-ja="メール">Email</strong> <a href="mailto:zai28@terpmail.umd.edu">zai28@terpmail.umd.edu</a></div>
    <div class="item"><strong data-i18n data-i18n-en="Follow me" data-i18n-zh="关注我" data-i18n-ja="フォローしてください">Follow me</strong>
      <a href="https://www.linkedin.com/in/zai28" target="_blank" rel="noopener" aria-label="LinkedIn">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:middle; margin:0 .25rem;">
          <path d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.5 8h4V24h-4V8zm7.5 0h3.8v2.2h.1c.5-.9 1.7-2.2 3.9-2.2 4.2 0 5 2.7 5 6.2V24h-4v-7.9c0-1.9 0-4.4-2.7-4.4s-3.1 2.1-3.1 4.3V24h-4V8z"/>
        </svg>
      </a>
      <a href="https://github.com/zijie-cai" target="_blank" rel="noopener" aria-label="GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:middle; margin:0 .25rem;">
          <path d="M12 .5C5.65.5.5 5.65.5 12c0 5.1 3.29 9.4 7.86 10.94.58.1.79-.25.79-.56v-2.02c-3.2.7-3.87-1.55-3.87-1.55-.53-1.33-1.3-1.68-1.3-1.68-1.07-.74.08-.73.08-.73 1.19.08 1.82 1.23 1.82 1.23 1.05 1.8 2.75 1.28 3.43.98.1-.76.41-1.28.75-1.58-2.56-.29-5.26-1.28-5.26-5.72 0-1.27.46-2.3 1.22-3.11-.12-.3-.53-1.52.11-3.17 0 0 .99-.32 3.25 1.2a11.3 11.3 0 0 1 5.92 0c2.26-1.52 3.25-1.2 3.25-1.2.64 1.65.23 2.87.11 3.17.76.81 1.22 1.84 1.22 3.11 0 4.45-2.7 5.43-5.27 5.72.42.36.8 1.09.8 2.2v3.26c0 .31.21.66.8.55C20.21 21.4 23.5 17.1 23.5 12c0-6.35-5.15-11.5-11.5-11.5z"/>
        </svg>
      </a>
    </div>
  </div>
  <div class="container_mouse">
      <span class="mouse-btn">
          <span class="mouse-scroll"></span>
      </span>
      <span data-i18n data-i18n-en="Scroll Down" data-i18n-zh="下滑查看更多" data-i18n-ja="下へスクロール">Scroll Down</span>
  </div>

  <main>
    <!-- Featured -->
    <section id="featured" class="section reveal slide-left">
      <div class="container">
        <h2 data-i18n data-i18n-en="Featured" data-i18n-zh="精选" data-i18n-ja="注目">Featured</h2>
        <div class="cards">
          <article class="card reveal">
            <div class="thumb"><img src="/images/aitin-1.png" alt="AItinerary app screenshot" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="AItinerary app screenshot" data-i18n-alt-zh="AItinerary 应用截图" data-i18n-alt-ja="AItinerary アプリのスクリーンショット" loading="lazy" decoding="async"></div>
            <h3 data-i18n data-i18n-en="AItinerary (Preview)" data-i18n-zh="AItinerary（预览）" data-i18n-ja="AItinerary（プレビュー）">AItinerary (Preview)</h3>
            <p data-i18n data-i18n-html
               data-i18n-en='Meet <strong>Aitin</strong>, your AI travel copilot—instantly pulling real-time flights, hotels, events, and weather into personalized, day-by-day itineraries synced seamlessly with your calendar, with smart recommendations that adapt to your preferences. Travel made easy.'
               data-i18n-zh='认识 <strong>Aitin</strong>，你的 AI 旅行副驾——聚合航班、酒店、活动与天气，自动生成日程并同步日历；支持多城市/多日、预算约束与动态重排；推荐随历史与偏好自适应，让出行更省心。'
               data-i18n-ja='あなたのAI旅行コパイロット<strong>Aitin</strong>。フライト・ホテル・イベント・天気をリアルタイムで集約し、カレンダー連携の<strong>日別スケジュール</strong>を自動作成。嗜好に合わせて賢く提案し、旅づくりをもっと簡単にします。'>
              Meet <strong>Aitin</strong>, your AI travel copilot—instantly pulling real-time flights, hotels, events, and weather into personalized, day-by-day itineraries synced seamlessly with your calendar, with smart recommendations that adapt to your preferences. Travel made easy.
</p>
<div class="meta badges">
  <span class="badge" data-i18n data-i18n-en="React" data-i18n-zh="React">React</span>
  <span class="badge" data-i18n data-i18n-en="Node" data-i18n-zh="Node.js">Node</span>
  <span class="badge" data-i18n data-i18n-en="MCP" data-i18n-zh="MCP">MCP</span>
</div>
            <div class="card-actions">
              <a class="btn small" href="#" target="_blank" rel="noopener" data-i18n data-i18n-en="Live" data-i18n-zh="演示" data-i18n-ja="デモ" data-i18n-attrs="aria-label" aria-label="Open AItinerary live preview" data-i18n-aria-label-en="Open AItinerary live preview" data-i18n-aria-label-zh="打开 AItinerary 在线演示" data-i18n-aria-label-ja="AItinerary のライブプレビューを開く">Live</a>
              <a class="btn small outline" href="#" target="_blank" rel="noopener" data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-ja="コード" data-i18n-attrs="aria-label" aria-label="View AItinerary code" data-i18n-aria-label-en="View AItinerary code" data-i18n-aria-label-zh="查看 AItinerary 源码" data-i18n-aria-label-ja="AItinerary のコードを見る">Code</a>
            </div>
          </article>

          <article class="card reveal">
            <div class="thumb">
              <img src="/images/uw.png" alt="Underwater Depth Estimation" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="Underwater Depth Estimation" data-i18n-alt-zh="水下深度估计" data-i18n-alt-ja="水中深度推定" loading="lazy" decoding="async">
            </div>
            <h3 data-i18n data-i18n-en="Underwater Depth (RGB + Sonar)" data-i18n-zh="水下深度估计（RGB + 声呐）" data-i18n-ja="水中深度推定（RGB + ソナー）">Underwater Depth (RGB + Sonar)</h3>
            <p data-i18n data-i18n-html
               data-i18n-en='Research on robust depth estimation in challenging underwater environments. My work extends benchmark studies with experiments on <strong>RGB + sonar fusion</strong>, exploring reliability when vision alone fails in turbid, low-light, or high-scattering conditions.'
               data-i18n-zh='在复杂水下环境中的鲁棒深度估计研究。基于<strong>RGB + 声呐融合</strong>，在浑浊、弱光或强散射等视觉失效条件下评估方法可靠性；覆盖时间同步/空间对齐、噪声与散射强度，并对比主流基线。'
               data-i18n-ja='厳しい水中環境における<strong>堅牢な深度推定</strong>の研究。<strong>RGB とソナーの融合</strong>で、濁り・低照度・強散乱など視覚破綻下でも信頼性を検証。時刻/空間整合やノイズ/散乱強度を含むベンチマークと基準法比較まで。'>
              Research on robust depth estimation in challenging underwater environments.  
My work extends benchmark studies with experiments on <strong>RGB + sonar fusion</strong>, exploring reliability when vision alone fails in turbid, low-light, or high-scattering conditions.
            </p>
            <div class="meta badges">
              <span class="badge" data-i18n data-i18n-en="PyTorch" data-i18n-zh="PyTorch">PyTorch</span>
              <span class="badge" data-i18n data-i18n-en="Depth Anything V2" data-i18n-zh="Depth Anything V2">Depth Anything V2</span>
              <span class="badge" data-i18n data-i18n-en="Multimodal" data-i18n-zh="Multimodal">Multimodal</span>
            </div>
            <div class="card-actions">
              <a class="btn small" href="https://arxiv.org/abs/2507.02148" target="_blank" rel="noopener" data-i18n data-i18n-en="Paper" data-i18n-zh="论文" data-i18n-ja="論文" data-i18n-attrs="aria-label" aria-label="Open paper on arXiv" data-i18n-aria-label-en="Open paper on arXiv" data-i18n-aria-label-zh="在 arXiv 打开论文" data-i18n-aria-label-ja="arXivで論文を開く">Paper</a>
              <a class="btn small outline" href="#" target="_blank" rel="noopener" data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-ja="コード" data-i18n-attrs="aria-label" aria-label="View code for Underwater Depth" data-i18n-aria-label-en="View code for Underwater Depth" data-i18n-aria-label-zh="查看水下深度项目代码" data-i18n-aria-label-ja="Underwater Depth のコードを見る">Code</a>
            </div>
          </article>

          <article class="card reveal">
  <div class="thumb">
    <img src="/images/plan.png" alt="UMD Class Planning Tool" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="UMD Class Planning Tool" data-i18n-alt-zh="马大课程与通勤规划工具" data-i18n-alt-ja="UMD 授業・通学プランナー" loading="lazy" decoding="async">
  </div>
  <h3 data-i18n data-i18n-en="UMD Class & Commute Planner" data-i18n-zh="马里兰大学课程与通勤规划工具" data-i18n-ja="UMD 授業・通学プランナー">UMD Class & Commute Planner</h3>
  <p data-i18n data-i18n-html
     data-i18n-en='An <strong>interactive data visualization tool</strong> to help UMD students design their class schedules and optimize commutes. Features include <strong>bus route overlays</strong>, <strong>prerequisite trees</strong>, and <strong>professor rating & GPA correlation</strong>. Built with open UMD.io and PlanetTerp APIs.'
     data-i18n-zh='用于帮助马里兰大学学生设计课程表并优化通勤的<strong>交互式可视化工具</strong>。功能包括<strong>公交路线叠加</strong>、<strong>先修课关系树</strong>以及<strong>教授评分与 GPA 相关性</strong>；基于开放的 UMD.io 与 PlanetTerp API 构建。'
     data-i18n-ja='UMD 学生の<strong>時間割作成と通学最適化</strong>を支援する<strong>可視化ツール</strong>。<strong>バス路線の重ね合わせ</strong>、<strong>必修関係ツリー</strong>、<strong>教授評価×GPA 相関</strong>などを搭載。UMD.io と PlanetTerp の公開APIで構築、<strong>直感的 UI</strong> で素早く比較・計画。'>
    An <strong>interactive data visualization tool</strong> to help UMD students design their class schedules and optimize commutes.  
    Features include <strong>bus route overlays</strong>, <strong>prerequisite trees</strong>, and <strong>professor rating & GPA correlation</strong>.
    Built with open UMD.io and PlanetTerp APIs.
  </p>
  <div class="meta badges">
    <span class="badge" data-i18n data-i18n-en="HTML/CSS/JS" data-i18n-zh="HTML/CSS/JS">HTML/CSS/JS</span>
    <span class="badge" data-i18n data-i18n-en="UI/UX" data-i18n-zh="UI/UX">UI/UX</span>
    <span class="badge" data-i18n data-i18n-en="APIs" data-i18n-zh="API">APIs</span>
  </div>
  <div class="card-actions">
    <a class="btn small" href="https://zijie-cai.github.io/umd_schedule/" target="_blank" rel="noopener" data-i18n data-i18n-en="Live" data-i18n-zh="演示" data-i18n-ja="デモ" data-i18n-attrs="aria-label" aria-label="Open UMD Class & Commute live" data-i18n-aria-label-en="Open UMD Class & Commute live" data-i18n-aria-label-zh="打开 UMD 选课与通勤规划演示" data-i18n-aria-label-ja="UMD 授業・通学デモを開く">Live</a>
    <a class="btn small outline" href="https://github.com/zijie-cai/umd_schedule" target="_blank" rel="noopener" data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-ja="コード" data-i18n-attrs="aria-label" aria-label="View code on GitHub" data-i18n-aria-label-en="View code on GitHub" data-i18n-aria-label-zh="在 GitHub 查看代码" data-i18n-aria-label-ja="GitHub でコードを見る">Code</a>
  </div>
</article>
        </div>
      </div>
    </section>

    <!-- Projects -->
    <section id="projects" class="section reveal slide-right">
      <div class="container">
        <h2 data-i18n data-i18n-en="Projects" data-i18n-zh="项目" data-i18n-ja="プロジェクト">Projects</h2>
        

<div class="projects-grid" id="projectsGrid">

          <!-- Gesture Control for Apple TV -->
          <article class="project-card reveal" data-tags="cv ai">
            <div class="thumb"><img src="/images/tv.jpg" alt="Gesture Control for Apple TV Screenshot" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="Gesture Control for Apple TV Screenshot" data-i18n-alt-zh="Apple TV 手势控制 截图" data-i18n-alt-ja="Apple TV ジェスチャー操作のスクリーンショット" loading="lazy" decoding="async"></div>
            <h3 data-i18n data-i18n-en="Gesture Control Apple TV" data-i18n-zh="Apple TV 手势控制" data-i18n-ja="Apple TV ジェスチャー操作">Gesture Control Apple TV</h3>
            <p data-i18n data-i18n-html
               data-i18n-en='Real-time hand gesture control using <strong>MediaPipe</strong> and <strong>OpenCV</strong>, integrated with <code>pyatv</code> for mapping remote actions via Wi-Fi (play/pause, navigate, select, etc).'
               data-i18n-zh='使用 <strong>MediaPipe</strong> 与 <strong>OpenCV</strong> 实现实时手势控制，结合 <code>pyatv</code> 通过 Wi‑Fi 映射遥控器操作（播放/暂停、导航、选择等）。'
               data-i18n-ja=' <strong>MediaPipe</strong> と <strong>OpenCV</strong> による<strong>リアルタイム手ぶり認識</strong>。<code>pyatv</code> 連携で Wi‑Fi 経由のリモコン操作（再生/一時停止・ナビゲーション・選択など）にマッピングします。'>
              Real-time hand gesture control using <strong>MediaPipe</strong> and <strong>OpenCV</strong>, integrated with <code>pyatv</code> for mapping remote actions via Wi-Fi (play/pause, navigate, select, etc).
            </p>
            <div class="badges">
              <span class="badge" data-i18n data-i18n-en="Comp Vision" data-i18n-zh="计算机视觉" data-i18n-ja="コンピュータビジョン">Comp Vision</span>
              <span class="badge" data-i18n data-i18n-en="Data Pipeline" data-i18n-zh="数据管线" data-i18n-ja="データパイプライン">Data Pipeline</span>
            </div>
            <div class="card-actions">
              <a class="btn small"
                 href="https://github.com/zijie-cai/Gesture-Control-Apple-TV/assets/74931355/aed56bc2-e850-4b5f-af31-afad62d0eff9"
                 target="_blank" rel="noopener"
                 data-i18n data-i18n-en="Video" data-i18n-zh="视频" data-i18n-ja="動画"
                 data-i18n-attrs="aria-label"
                 aria-label="Watch demo video of Gesture Control for Apple TV"
                 data-i18n-aria-label-en="Watch demo video of Gesture Control for Apple TV"
                 data-i18n-aria-label-zh="观看 Apple TV 手势控制的演示视频"
                 data-i18n-aria-label-ja="Apple TV ジェスチャー操作のデモ動画を見る">Video</a>
              <a class="btn small outline"
                 href="https://github.com/zijie-cai/Gesture-Control-Apple-TV?tab=readme-ov-file"
                 target="_blank" rel="noopener"
                 data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-ja="コード"
                 data-i18n-attrs="aria-label"
                 aria-label="View code on GitHub"
                 data-i18n-aria-label-en="View code on GitHub"
                 data-i18n-aria-label-zh="在 GitHub 查看代码"
                 data-i18n-aria-label-ja="GitHub でコードを見る">Code</a>
            </div>
          </article>

          <!-- N-Queens Playground -->
          <article class="project-card reveal" data-tags="alg">
            <div class="thumb">
              <img src="/images/nq.jpg" alt="N-Queens Playground Screenshot" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="N-Queens Playground Screenshot" data-i18n-alt-zh="N 皇后可视化 截图" data-i18n-alt-ja="N クイーン可視化のスクリーンショット" loading="lazy" decoding="async">
  </div>
  <h3 data-i18n data-i18n-en="N-Queens Playground" data-i18n-zh="N 皇后可视化" data-i18n-ja="N クイーン可視化">N-Queens Playground</h3>
  <p data-i18n data-i18n-html
     data-i18n-en='Interactive visualizer for the <strong>N-Queens problem</strong> with backtracking and heuristics, exploring different algorithms and performance trade-offs.'
     data-i18n-zh='针对 <strong>N 皇后问题</strong> 的交互式可视化工具，包含回溯与启发式方法，探索不同算法及其性能取舍。'
     data-i18n-ja='<strong>N クイーン問題</strong>のためのインタラクティブ可視化。バックトラッキングとヒューリスティクスで、さまざまなアルゴリズムと性能トレードオフを探ります。'>
  Interactive visualizer for the <strong>N-Queens problem</strong> with backtracking and heuristics, exploring different algorithms and performance trade-offs. 
</p>
  <div class="badges">
    <span class="badge" data-i18n data-i18n-en="Algorithms" data-i18n-zh="算法" data-i18n-ja="アルゴリズム">Algorithms</span>
    <span class="badge" data-i18n data-i18n-en="Visualizer" data-i18n-zh="可视化" data-i18n-ja="可視化">Visualizer</span>
  </div>
  <div class="card-actions">
    <a class="btn small" href="https://mybinder.org/v2/gh/zijie-cai/N-Queens-Playground/HEAD?urlpath=%2Fvoila%2Frender%2Fn_queens_playground.ipynb" target="_blank" rel="noopener" aria-label="Try live demo of N-Queens Playground" data-i18n data-i18n-en="Live" data-i18n-zh="演示" data-i18n-ja="デモ" data-i18n-attrs="aria-label" data-i18n-aria-label-en="Try live demo of N-Queens Playground" data-i18n-aria-label-zh="试用 N 皇后可视化的在线演示" data-i18n-aria-label-ja="N クイーン可視化のデモを試す">Live</a>
    <a class="btn small outline" href="https://github.com/zijie-cai/N-Queens-Playground" target="_blank" rel="noopener" aria-label="View code on GitHub" data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-attrs="aria-label" data-i18n-aria-label-en="View code on GitHub" data-i18n-aria-label-zh="在 GitHub 查看代码">Code</a>
  </div>
          </article>

          <!-- Coqui AI Voice Clone GUI -->
          <article class="project-card reveal" data-tags="ai">
            <div class="thumb"><img src="/images/tts.jpg" alt="Coqui Voice Clone GUI Screenshot" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="Coqui Voice Clone GUI Screenshot" data-i18n-alt-zh="Coqui 语音克隆 GUI 截图" data-i18n-alt-ja="Coqui 音声クローン GUI のスクリーンショット" loading="lazy" decoding="async"></div>
            <h3 data-i18n data-i18n-en="Coqui AI Voice Clone GUI" data-i18n-zh="Coqui AI 语音克隆 GUI" data-i18n-ja="Coqui AI 音声クローン GUI">Coqui AI Voice Clone GUI</h3>
            <p data-i18n data-i18n-html
               data-i18n-en='Desktop <strong>GUI</strong> for <strong>voice cloning</strong> with Coqui XTTS-V2, supporting dataset upload, TTS, translation, Hugging Face models, and multilingual audio playback.'
               data-i18n-zh='基于 Coqui XTTS‑V2 的桌面 <strong>GUI</strong>，用于<strong>语音克隆</strong>，支持数据集上传、文本/语音生成、翻译、Hugging Face 模型与多语种音频播放。'
               data-i18n-ja='Coqui XTTS‑V2 による<strong>音声クローン</strong>向けデスクトップ<strong>GUI</strong>。データセットのアップロード、TTS、翻訳、Hugging Face モデル、多言語音声再生に対応。'>
              Desktop <strong>GUI</strong> for <strong>voice cloning</strong> with Coqui XTTS-V2, supporting dataset upload, TTS, translation, Hugging Face models, and multilingual audio playback.
</p>
  <div class="badges">
  <span class="badge" data-i18n data-i18n-en="Voice AI" data-i18n-zh="语音 AI" data-i18n-ja="音声AI">Voice AI</span>
  <span class="badge" data-i18n data-i18n-en="TTS" data-i18n-zh="文本转语音" data-i18n-ja="音声合成">TTS</span>
  </div>
           <div class="card-actions">
  <a class="btn small" href="https://drive.google.com/file/d/164Y7vfm2odXszAvLeGyk59XepTr--j2b/view?usp=drive_link" target="_blank" rel="noopener" aria-label="Watch demo video of Coqui AI Voice Clone GUI" data-i18n data-i18n-en="Video" data-i18n-zh="视频" data-i18n-ja="動画" data-i18n-attrs="aria-label" data-i18n-aria-label-en="Watch demo video of Coqui AI Voice Clone GUI" data-i18n-aria-label-zh="观看 Coqui 语音克隆 GUI 的演示视频" data-i18n-aria-label-ja="Coqui 音声クローン GUI のデモ動画を見る">Video</a>
  <a class="btn small outline" href="https://github.com/zijie-cai/coqui-ai-voice-clone-gui" target="_blank" rel="noopener" aria-label="View code for Coqui AI Voice Clone GUI on GitHub" data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-ja="コード" data-i18n-attrs="aria-label" data-i18n-aria-label-en="View code for Coqui AI Voice Clone GUI on GitHub" data-i18n-aria-label-zh="在 GitHub 查看 Coqui 语音克隆 GUI 的代码" data-i18n-aria-label-ja="GitHub で Coqui 音声クローン GUI のコードを見る">Code</a>
</div>
          </article>

          <!-- ESM Contact Prediction Consistency -->
          <article class="project-card reveal" data-tags="ai alg">
            <div class="thumb"><img src="/images/bio.jpg" alt="ESM Contact Prediction Screenshot" data-i18n data-i18n-attrs="alt" data-i18n-alt-en="ESM Contact Prediction Screenshot" data-i18n-alt-zh="蛋白质接触预测 截图" data-i18n-alt-ja="ESM 接触予測のスクリーンショット" loading="lazy" decoding="async"></div>
            <h3 data-i18n data-i18n-en="Protein Contact Prediction" data-i18n-zh="蛋白质接触预测" data-i18n-ja="タンパク質接触予測">Protein Contact Prediction</h3>
            <p data-i18n data-i18n-html
               data-i18n-en='Framework and <strong>Colab tool</strong> to evaluate protein contact predictions from <strong>ESM-2</strong> models against MSAs, with visual maps and precision/recall metrics.'
               data-i18n-zh='用于评估 <strong>ESM‑2</strong> 模型的蛋白质接触预测与多重序列比对一致性的框架与 <strong>Colab</strong> 工具，包含可视化热图与精确率/召回率指标。'
               data-i18n-ja='<strong>ESM‑2</strong> のタンパク質接触予測を MSA 照合で評価するフレームワーク/<strong>Colab</strong> ツール。ヒートマップ、適合率/再現率に加え、MSA チェック、しきい値、PR 曲線に対応。'>
              Framework and <strong>Colab tool</strong> to evaluate protein contact predictions from <strong>ESM-2</strong> models against MSAs, with visual maps and precision/recall metrics.
</p>
            <div class="badges"><span class="badge" data-i18n data-i18n-en="LLM" data-i18n-zh="大语言模型" data-i18n-ja="大規模言語モデル">LLM</span><span class="badge" data-i18n data-i18n-en="Bio" data-i18n-zh="生物" data-i18n-ja="バイオ">Bio</span></div>
            <div class="card-actions">
    <a class="btn small" href="https://drive.google.com/file/d/1QNVAONPWvy9IYVTtISn9ZubmlLbJJSYk/view?usp=sharing" target="_blank" rel="noopener" aria-label="Watch demo video of Protein Contact Prediction" data-i18n data-i18n-en="Video" data-i18n-zh="视频" data-i18n-ja="動画" data-i18n-attrs="aria-label" data-i18n-aria-label-en="Watch demo video of Protein Contact Prediction" data-i18n-aria-label-zh="观看蛋白质接触预测的演示视频" data-i18n-aria-label-ja="タンパク質接触予測のデモ動画を見る">Video</a>
    <a class="btn small outline" href="https://colab.research.google.com/drive/1-IgCFFLVqFPz2MR8bzCGiXEWHqibWp0B?usp=sharing" target="_blank" rel="noopener" aria-label="Open Protein Contact Prediction in Colab" data-i18n data-i18n-en="Code" data-i18n-zh="代码" data-i18n-ja="コード" data-i18n-attrs="aria-label" data-i18n-aria-label-en="Open Protein Contact Prediction in Colab" data-i18n-aria-label-zh="在 Colab 中打开蛋白质接触预测" data-i18n-aria-label-ja="Colab でタンパク質接触予測を開く">Code</a>
  </div>
          </article>

        </div>
        <div class="projects-cta">
          <a class="btn outline with-icon" href="https://github.com/zijie-cai" target="_blank" rel="noopener" aria-label="More projects on GitHub" data-i18n data-i18n-attrs="aria-label" data-i18n-aria-label-en="More projects on GitHub" data-i18n-aria-label-zh="在 GitHub 上查看更多项目" data-i18n-aria-label-ja="GitHub で他のプロジェクトを見る">
            <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" focusable="false">
              <path d="M12 .5a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58 0-.28-.01-1.02-.02-2-3.34.73-4.04-1.61-4.04-1.61-.55-1.41-1.34-1.79-1.34-1.79-1.09-.74.08-.73.08-.73 1.2.08 1.83 1.23 1.83 1.23 1.07 1.83 2.81 1.3 3.5.99.11-.78.42-1.3.76-1.6-2.66-.3-5.46-1.33-5.46-5.92 0-1.31.47-2.38 1.23-3.22-.12-.3-.53-1.52.12-3.17 0 0 1-.32 3.28 1.23a11.4 11.4 0 0 1 5.97 0c2.28-1.55 3.28-1.23 3.28-1.23.65 1.65.24 2.87.12 3.17.77.84 1.23 1.91 1.23 3.22 0 4.6-2.8 5.62-5.48 5.92.43.37.81 1.1.81 2.23 0 1.61-.02 2.9-.02 3.29 0 .32.22.69.83.57A12 12 0 0 0 12 .5Z"/>
            </svg>
            <span data-i18n data-i18n-en="More Projects" data-i18n-zh="更多项目" data-i18n-ja="その他のプロジェクト">More Projects</span>
            <svg class="chev" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" focusable="false">
              <path d="M13.5 5.5a1 1 0 011.414 0l5.586 5.586a1 1 0 010 1.414L14.914 18.086a1 1 0 11-1.414-1.414L17.172 13H4a1 1 0 110-2h13.172l-3.672-3.672a1 1 0 010-1.414z"/>
            </svg>
          </a>
        </div>
       
      </div>
    </section>

    <!-- Experience -->
    <section id="experience" class="section reveal flip">
      <div class="container">
        <h2 data-i18n data-i18n-en="Experience &amp; Education" data-i18n-zh="经历与教育" data-i18n-ja="経験と学歴">Experience &amp; Education</h2>
        <div class="xp-grid">
          <!-- Left: Experience -->
          <div class="xp-panel">
            <div class="xp-head">
              <div class="xp-icon" aria-hidden="true">
                <!-- Work briefcase icon -->
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M9 3h6a2 2 0 0 1 2 2v1h3a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3V5a2 2 0 0 1 2-2Zm6 3V5H9v1h6Z"/></svg>
              </div>
              <h3 data-i18n data-i18n-en="Experience" data-i18n-zh="经历" data-i18n-ja="経験">Experience</h3>
            </div>
            <ul class="xp-list">
              <li class="xp-item reveal">
                <div class="xp-body">
                  <div class="xp-date" data-i18n data-i18n-en="May 2025 – Present" data-i18n-zh="2025 年 5 月 – 至今" data-i18n-ja="2025 年 5 月 – 現在">May 2025 – Present</div>
                  <div class="xp-role" data-i18n data-i18n-en="Program Lead — AI &amp; Machine Learning" data-i18n-zh="项目负责 — AI 与机器学习" data-i18n-ja="プログラムリード — AI・機械学習">Instructor — AI &amp; Machine Learning</div>
                  <div class="xp-org" data-i18n data-i18n-en="Internal Drive (iD Tech), College Park, MD" data-i18n-zh="Internal Drive（iD Tech），马里兰州科利奇帕克" data-i18n-ja="Internal Drive（iD Tech）, メリーランド州カレッジパーク">Internal Drive (iD Tech), College Park, MD</div>
                  <ul class="xp-desc">
                    <li data-i18n data-i18n-html data-i18n-en="Delivered project-based instruction on <strong>Python</strong>, <strong>ML</strong>, and <strong>prompt engineering</strong> using <strong>OpenAI API</strong>, <strong>Keras</strong>, <strong>NumPy</strong>, and <strong>Pandas</strong>." data-i18n-zh="基于项目教授 <strong>Python</strong> 与 <strong>机器学习</strong>，使用 <strong>OpenAI API</strong>、<strong>Keras</strong>、<strong>NumPy</strong>、<strong>Pandas</strong>；涵盖数据清洗/可视化、训练评估与云端部署。" data-i18n-ja="プロジェクト型で <strong>Python</strong>/<strong>機械学習</strong> を指導。<strong>OpenAI API</strong>・<strong>Keras</strong> などで、データ整形/可視化、学習/評価、クラウド展開まで対応。">Delivered project-based instruction on Python, ML, and prompt engineering using OpenAI API, Keras, NumPy, and Pandas.</li>
                    <li data-i18n data-i18n-html data-i18n-en="Designed and led labs in <strong>computer vision</strong>, <strong>NLP</strong>, and <strong>text/audio generation</strong> with <strong>Neural Networks</strong> and <strong>TTS/STT APIs</strong>." data-i18n-zh="设计并带领 <strong>计算机视觉</strong>、<strong>NLP</strong>、<strong>文本/语音生成</strong> 实验，结合 <strong>TTS/STT</strong> 接口；涵盖分类/检测、情感分析、并从零搭建数据管线与推理脚本。" data-i18n-ja="<strong>計算機視覚</strong>・<strong>NLP</strong>・<strong>テキスト/音声生成</strong> の演習を設計・主導。<strong>TTS/STT</strong> API を活用し、分類/検出・感情分析、データパイプライン/推論スクリプト構築まで、ハンズオンで実装・評価。">Designed and led labs in computer vision, NLP, and text/audio generation with Neural Networks and TTS/STT APIs.</li>
                    <li data-i18n data-i18n-html data-i18n-en="Mentored student teams through full <strong>ML pipelines</strong>: <strong>preprocessing</strong> → <strong>model development</strong> → <strong>API integration</strong> → <strong>debugging</strong>." data-i18n-zh="指导学生团队完成端到端 <strong>流程</strong>：<strong>预处理</strong> → <strong>模型</strong> → <strong>API 集成</strong> → <strong>调试</strong>；并做代码评审、文档与演示，产出可运行 Demo 与报告。" data-i18n-ja="学生チームを E2E の <strong>ML パイプライン</strong>（<strong>前処理</strong>→<strong>モデル</strong>→<strong>API 統合</strong>→<strong>デバッグ</strong>）をメンタリング。コードレビュー/デモまで伴走。">Mentored student teams through full ML pipelines: preprocessing → model development → API integration → debugging.</li>
                  </ul>
                </div>
              </li>
              <li class="xp-item reveal">
                <div class="xp-body">
                  <div class="xp-date" data-i18n data-i18n-en="Apr 2023 – Present" data-i18n-zh="2023 年 4 月 – 至今" data-i18n-ja="2023 年 4 月 – 現在">Apr 2023 – Present</div>
                  <div class="xp-role" data-i18n data-i18n-en="Research Assistant — Multimodal Perception" data-i18n-zh="科研助理 — 多模态感知" data-i18n-ja="研究助手 — マルチモーダル知覚">Research Assistant — Multimodal Perception</div>
                  <div class="xp-org" data-i18n data-i18n-en="Intelligent Sensing Laboratory, University of Maryland" data-i18n-zh="马里兰大学 Intelligent Sensing Laboratory" data-i18n-ja="メリーランド大学 Intelligent Sensing Laboratory">Intelligent Sensing Laboratory, University of Maryland</div>
                  <ul class="xp-desc">
                    <li data-i18n data-i18n-html data-i18n-en="Developed and benchmarked models for underwater <strong>monocular metric depth estimation</strong> using <strong>synthetic RGB data</strong>." data-i18n-zh="基于 <strong>合成 RGB 数据</strong> 开发与评测水下 <strong>单目尺度深度估计</strong> 模型：系统性对比多种基线方法，探索模型在不同场景下的精度与鲁棒性优化策略。" data-i18n-ja="<strong>合成RGBデータ</strong>を用いた水中<strong>単眼メートル深度推定</strong>モデルを開発・ベンチマークし、複数ベースラインを体系的に比較しました。">Developed and benchmarked models for underwater monocular metric depth estimation using synthetic RGB data.</li>
                    <li data-i18n data-i18n-html data-i18n-en="Led experiments on simulating <strong>synthetic</strong> and collecting <strong>real-world</strong> underwater <strong>RGB-D</strong> and <strong>acoustic sonar</strong> datasets." data-i18n-zh="主导水下 <strong>RGB‑D</strong> 与 <strong>声呐</strong> 数据的合成与实采：搭建仿真/标注流程、制定质检标准，并完成设备调试与标定，确保数据的可靠性与可扩展性。" data-i18n-ja="水中の <strong>RGB‑D</strong> と <strong>ソナー</strong> の<strong>合成</strong>および<strong>実測</strong>を主導。シミュレーション/アノテーション手順の構築、品質基準の策定、機器の調整・キャリブレーションを実施し、データの信頼性と拡張性を確保。">Led experiments on simulating synthetic and collecting real-world underwater RGB-D and acoustic sonar datasets.</li>
                    <li data-i18n data-i18n-html data-i18n-en="Presented weekly progress and co-authored <strong>publications</strong> with Prof. Christopher Metzler on <strong>multimodal AUV perception pipelines</strong>." data-i18n-zh="每周向团队汇报进展，参与实验设计与结果分析，并与 Christopher Metzler 教授合著面向 <strong>AUV</strong> 的 <strong>多模态感知管线</strong> 论文。" data-i18n-ja="毎週の進捗を報告し、<strong>マルチモーダルAUV認識パイプライン</strong>に関する<strong>論文</strong>を Metzler 教授と共著しました。">Presented weekly progress and co-authored publications with Prof. Christopher Metzler on multimodal AUV perception pipelines.</li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>

          <!-- Right: Education -->
          <div class="xp-panel">
            <div class="xp-head">
              <div class="xp-icon" aria-hidden="true">
                <!-- School mortarboard icon -->
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 3 2 9l10 6 10-6-10-6Zm6 8.2v4.8L12 20l-6-4v-4.8l6 3.6 6-3.6Z"/></svg>
              </div>
              <h3 data-i18n data-i18n-en="Education" data-i18n-zh="教育" data-i18n-ja="学歴">Education</h3>
            </div>
            <ul class="xp-list">
              <li class="xp-item reveal">
                <div class="xp-body">
                  <div class="xp-date" data-i18n data-i18n-html data-i18n-en="<strong>Aug 2024 – May 2025</strong>" data-i18n-zh="<strong>2024 年 8 月 – 2025 年 5 月</strong>" data-i18n-ja="<strong>2024 年 8 月 – 2025 年 5 月</strong>">Aug 2024 – May 2025</div>
                  <div class="xp-role" data-i18n data-i18n-html data-i18n-en="<strong>M.S. in Computer Science</strong>" data-i18n-zh="<strong>计算机科学硕士</strong>" data-i18n-ja="<strong>計算機科学修士</strong>">M.S. in Computer Science</div>
                  <div class="xp-org" data-i18n data-i18n-html data-i18n-en="University of Maryland, College Park — <strong>GPA: 3.83 / 4.00</strong>" data-i18n-zh="马里兰大学帕克分校 — <strong>GPA：3.83 / 4.00</strong>" data-i18n-ja="メリーランド大学 カレッジパーク校 — <strong>GPA: 3.83 / 4.00</strong>">University of Maryland, College Park — GPA: 3.83 / 4.00</div>
                  <ul class="xp-desc">
                    <li data-i18n data-i18n-html data-i18n-en="<strong>Master’s Paper:</strong> <em>Underwater Monocular Metric Depth Estimation: Benchmarks and Fine-Tuning</em> <a href=&quot;https://arxiv.org/abs/2507.02148&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;><strong>[arXiv]</strong></a>." data-i18n-zh="<strong>硕士论文：</strong><em>Underwater Monocular Metric Depth Estimation: Benchmarks and Fine-Tuning</em> <a href=&quot;https://arxiv.org/abs/2507.02148&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;><strong>[arXiv]</strong></a>。" data-i18n-ja="<strong>修士論文：</strong><em>Underwater Monocular Metric Depth Estimation: Benchmarks and Fine-Tuning</em> <a href=&quot;https://arxiv.org/abs/2507.02148&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;><strong>[arXiv]</strong></a>。">Master’s Paper: <em>Underwater Monocular Metric Depth Estimation: Benchmarks and Fine-Tuning</em> <a href="https://arxiv.org/abs/2507.02148" target="_blank" rel="noopener">[arXiv]</a>.</li>
                    <li data-i18n data-i18n-html data-i18n-en="Graduate Research focus in <strong>Multimodal Foundational Models</strong>." data-i18n-zh="研究方向：<strong>多模态基础模型</strong>。" data-i18n-ja="研究分野：<strong>マルチモーダル基盤モデル</strong>。">Graduate Research focus in Multimodal Foundational Models.</li>
                    <li data-i18n data-i18n-en="Relevant Coursework: Deep Learning Systems, Advanced Computer Graphics, Computational Imaging, Computational Biology" data-i18n-zh="相关课程：深度学习系统、高级计算机图形学、计算成像、计算生物学" data-i18n-ja="関連科目：深層学習システム、高度コンピュータグラフィックス、計算イメージング、計算生物学">Relevant Coursework: Deep Learning Systems, Advanced Computer Graphics, Computational Imaging, Computational Biology</li>
                  </ul>
                </div>
              </li>
              <li class="xp-item reveal">
                <div class="xp-body">
                  <div class="xp-date" data-i18n data-i18n-html data-i18n-en="<strong>Aug 2020 – May 2024</strong>" data-i18n-zh="<strong>2020 年 8 月 – 2024 年 5 月</strong>" data-i18n-ja="<strong>2020 年 8 月 – 2024 年 5 月</strong>">Aug 2020 – May 2024</div>
                  <div class="xp-role" data-i18n data-i18n-html data-i18n-en="<strong>B.S. in Computer Science (Machine Learning)</strong>" data-i18n-zh="<strong>计算机科学学士（机器学习方向）</strong>" data-i18n-ja="<strong>計算機科学学士（機械学習）</strong>">B.S. in Computer Science (Machine Learning)</div>
                  <div class="xp-org" data-i18n data-i18n-html data-i18n-en="University of Maryland, College Park — <strong>GPA: 3.73 / 4.00</strong>" data-i18n-zh="马里兰大学帕克分校 — <strong>GPA：3.73 / 4.00</strong>" data-i18n-ja="メリーランド大学 カレッジパーク校 — <strong>GPA: 3.73 / 4.00</strong>">University of Maryland, College Park — GPA: 3.70 / 4.00</div>
                  <ul class="xp-desc">
                    <li data-i18n data-i18n-html data-i18n-en="<strong>Minor in Mathematics</strong> (<strong>GPA: 3.72</strong>)" data-i18n-zh="<strong>数学辅修</strong>（<strong>GPA：3.72</strong>）" data-i18n-ja="<strong>数学副専攻</strong>（<strong>GPA: 3.72</strong>）">Minor in Mathematics (GPA: 3.72)</li>
                    <li data-i18n data-i18n-html data-i18n-en="<strong>Dean’s List</strong> (multiple semesters)." data-i18n-zh="多学期入选<strong>院长名单</strong>。" data-i18n-ja="<strong>学長表彰</strong>（複数学期）。">Dean’s List (multiple semesters).</li>
                    <li data-i18n data-i18n-html data-i18n-en="Undergraduate Teaching Assistant for <strong>CMSC351</strong> (<strong>Algorithms</strong>)." data-i18n-zh="本科助教：<strong>CMSC351</strong>（<strong>算法</strong>）。" data-i18n-ja="学部ティーチングアシスタント：<strong>CMSC351</strong>（<strong>アルゴリズム</strong>）。">Undergraduate Teaching Assistant for CMSC351 (Algorithms).</li>
                    <li data-i18n data-i18n-en="Relevant Coursework: Object-Oriented Programming, Operating Systems, Networks, Databases, AI, Machine Learning, Computer Vision, NLP, Data Science, Algorithms, Data Structures, Parallel Computing, Applied Probability, Linear Algebra, Advanced Calculus." data-i18n-zh="相关课程：面向对象程序设计、操作系统、计算机网络、数据库、人工智能、机器学习、计算机视觉、自然语言处理、数据科学、算法、数据结构、并行计算、应用概率、线性代数、高等微积分。" data-i18n-ja="関連科目：オブジェクト指向プログラミング、オペレーティングシステム、ネットワーク、データベース、AI、機械学習、コンピュータビジョン、NLP、データサイエンス、アルゴリズム、データ構造、並列計算、応用確率、線形代数、高等微積分。">Relevant Coursework: Object-Oriented Programming, Operating Systems, Networks, Databases, AI, Machine Learning, Computer Vision, NLP, Data Science, Algorithms, Data Structures, Parallel Computing, Applied Probability, Linear Algebra, Advanced Calculus.</li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Skills -->
    <section id="skills" class="section reveal scale-up">
      <div class="container">
        <h2 data-i18n data-i18n-en="Skills" data-i18n-zh="技能" data-i18n-ja="スキル">Skills</h2>
          <div class="skills">
          <div class="skill reveal">
            <div class="skill-head"><strong data-i18n data-i18n-en="Machine Learning" data-i18n-zh="机器学习" data-i18n-ja="機械学習">Machine Learning</strong><span class="level" data-i18n data-i18n-en="Advanced" data-i18n-zh="高级" data-i18n-ja="上級">Advanced</span></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="PyTorch" data-i18n-zh="PyTorch">PyTorch</span>
              <span class="tag" data-i18n data-i18n-en="TensorFlow" data-i18n-zh="TensorFlow">TensorFlow</span>
              <span class="tag" data-i18n data-i18n-en="scikit-learn" data-i18n-zh="scikit-learn">scikit-learn</span>
              <span class="tag" data-i18n data-i18n-en="OpenCV" data-i18n-zh="OpenCV">OpenCV</span>
              <span class="tag" data-i18n data-i18n-en="Transformers" data-i18n-zh="Transformers" data-i18n-ja="Transformers">Transformers</span>
            </div>
            <div class="bar"><i style="--w:85%"></i></div>
          </div>

          <div class="skill reveal">
            <div class="skill-head"><strong data-i18n data-i18n-en="Systems &amp; Optimization" data-i18n-zh="系统与优化" data-i18n-ja="システムと最適化">Systems & Optimization</strong><span class="level" data-i18n data-i18n-en="Intermediate" data-i18n-zh="中级" data-i18n-ja="中級">Intermediate</span></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="CUDA" data-i18n-zh="CUDA">CUDA</span>
              <span class="tag" data-i18n data-i18n-en="Triton" data-i18n-zh="Triton">Triton</span>
              <span class="tag" data-i18n data-i18n-en="TensorRT" data-i18n-zh="TensorRT">TensorRT</span>
              <span class="tag" data-i18n data-i18n-en="C++" data-i18n-zh="C++">C++</span>
              <span class="tag" data-i18n data-i18n-en="Quantization" data-i18n-zh="Quantization" data-i18n-ja="量子化">Quantization</span>
              <span class="tag" data-i18n data-i18n-en="Profiling" data-i18n-zh="Profiling" data-i18n-ja="プロファイリング">Profiling</span>
            </div>
            <div class="bar"><i style="--w:72%"></i></div>
          </div>

          <div class="skill reveal">
            <div class="skill-head"><strong data-i18n data-i18n-en="LLMs &amp; RAG" data-i18n-zh="大语言模型与 RAG" data-i18n-ja="LLM と RAG">LLMs & RAG</strong><span class="level" data-i18n data-i18n-en="Proficient" data-i18n-zh="熟练" data-i18n-ja="熟練">Proficient</span></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="Prompt Engineering" data-i18n-zh="Prompt Engineering" data-i18n-ja="プロンプトエンジニアリング">Prompt Engineering</span>
              <span class="tag" data-i18n data-i18n-en="LangChain" data-i18n-zh="LangChain">LangChain</span>
              <span class="tag" data-i18n data-i18n-en="Fine-tuning" data-i18n-zh="Fine-tuning" data-i18n-ja="ファインチューニング">Fine-tuning</span>
              <span class="tag" data-i18n data-i18n-en="Evaluation" data-i18n-zh="Evaluation" data-i18n-ja="評価">Evaluation</span>
            </div>
            <div class="bar"><i style="--w:76%"></i></div>
          </div>



          <div class="skill reveal">
            <div class="skill-head"><strong data-i18n data-i18n-en="Web Development" data-i18n-zh="Web 开发" data-i18n-ja="Web 開発">Web Development</strong><span class="level" data-i18n data-i18n-en="Proficient" data-i18n-zh="熟练" data-i18n-ja="熟練">Proficient</span></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="HTML" data-i18n-zh="HTML">HTML</span>
              <span class="tag" data-i18n data-i18n-en="CSS" data-i18n-zh="CSS">CSS</span>
              <span class="tag" data-i18n data-i18n-en="JavaScript" data-i18n-zh="JavaScript">JavaScript</span>
              <span class="tag" data-i18n data-i18n-en="TypeScript" data-i18n-zh="TypeScript">TypeScript</span>
              <span class="tag" data-i18n data-i18n-en="React" data-i18n-zh="React">React</span>
              <span class="tag" data-i18n data-i18n-en="Next.js" data-i18n-zh="Next.js">Next.js</span>
              <span class="tag" data-i18n data-i18n-en="Node/Express" data-i18n-zh="Node/Express">Node/Express</span>
            </div>
            <div class="bar"><i style="--w:75%"></i></div>
          </div>

          <div class="skill reveal">
            <div class="skill-head"><strong data-i18n data-i18n-en="Data &amp; MLOps" data-i18n-zh="数据与 MLOps" data-i18n-ja="データと MLOps">Data & MLOps</strong><span class="level" data-i18n data-i18n-en="Proficient" data-i18n-zh="熟练" data-i18n-ja="熟練">Proficient</span></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="SQL" data-i18n-zh="SQL">SQL</span>
              <span class="tag" data-i18n data-i18n-en="Docker" data-i18n-zh="Docker">Docker</span>
              <span class="tag" data-i18n data-i18n-en="CI/CD" data-i18n-zh="CI/CD">CI/CD</span>
              <span class="tag" data-i18n data-i18n-en="PyTest" data-i18n-zh="PyTest">PyTest</span>
             
            </div>
            <div class="bar"><i style="--w:74%"></i></div>
          </div>

          <div class="skill reveal">
            <div class="skill-head"><strong data-i18n data-i18n-en="Cloud" data-i18n-zh="云计算" data-i18n-ja="クラウド">Cloud</strong><span class="level" data-i18n data-i18n-en="Proficient" data-i18n-zh="熟练" data-i18n-ja="熟練">Proficient</span></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="GCP" data-i18n-zh="GCP">GCP</span>
              <span class="tag" data-i18n data-i18n-en="AWS" data-i18n-zh="AWS">AWS</span>
              <span class="tag" data-i18n data-i18n-en="Cloud Run" data-i18n-zh="Cloud Run">Cloud Run</span>
              <span class="tag" data-i18n data-i18n-en="Lambda" data-i18n-zh="Lambda">Lambda</span>
            </div>
            <div class="bar"><i style="--w:70%"></i></div>
          </div>

          <div class="skill reveal no-bar">
            <div class="skill-head"><strong data-i18n data-i18n-en="Languages" data-i18n-zh="语言" data-i18n-ja="言語">Languages</strong></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="Mandarin Chinese — Native" data-i18n-zh="中文 — 母语" data-i18n-ja="中国語 — ネイティブ">Mandarin Chinese — Native</span>
              <span class="tag" data-i18n data-i18n-en="English — Fluent" data-i18n-zh="英语 — 流利" data-i18n-ja="英語 — 流暢">English — Fluent</span>
              <span class="tag" data-i18n data-i18n-en="Japanese — Beginner" data-i18n-zh="日语 — 入门" data-i18n-ja="日本語 — 初級">Japanese — Beginner</span>
            </div>
          </div>

          <div class="skill reveal no-bar">
            <div class="skill-head"><strong data-i18n data-i18n-en="Soft Skills" data-i18n-zh="软技能" data-i18n-ja="ソフトスキル">Soft Skills</strong></div>
            <div class="tags">
              <span class="tag" data-i18n data-i18n-en="Communication" data-i18n-zh="沟通" data-i18n-ja="コミュニケーション">Communication</span>
              <span class="tag" data-i18n data-i18n-en="Teaching" data-i18n-zh="教学" data-i18n-ja="指導">Teaching</span>
              <span class="tag" data-i18n data-i18n-en="Teamwork" data-i18n-zh="协作" data-i18n-ja="チームワーク">Teamwork</span>
              <span class="tag" data-i18n data-i18n-en="Problem‑Solving" data-i18n-zh="解决问题" data-i18n-ja="問題解決">Problem‑Solving</span>
              <span class="tag" data-i18n data-i18n-en="Leadership" data-i18n-zh="领导力" data-i18n-ja="リーダーシップ">Leadership</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Writing -->
    <section id="writing" class="section reveal fade-in">
      <div class="container talks">
        <div class="talks-header">
          <h2 data-i18n data-i18n-en="Writing &amp; Talks" data-i18n-zh="写作与演讲" data-i18n-ja="記事・発表">Writing &amp; Talks</h2>
        </div>


        <div class="talks-grid" id="talksGrid">
          <article class="talk-card reveal" data-type="paper">
            <span class="talk-type" data-i18n data-i18n-en="Paper & Talk" data-i18n-zh="论文与演讲" data-i18n-ja="論文・発表">Paper & Talk</span>
            <h3 data-i18n data-i18n-en="CCT with FlashAttention + Triton" data-i18n-zh="CCT 与 FlashAttention + Triton" data-i18n-ja="CCT × FlashAttention + Triton">CCT with FlashAttention + Triton</h3>
            <div class="talk-meta">
              <span data-i18n data-i18n-en="2025" data-i18n-zh="2025">2025</span>
              <span>•</span>
              <span data-i18n data-i18n-en="Systems, Optimization, Transformers" data-i18n-zh="系统、优化、Transformers" data-i18n-ja="システム、最適化、Transformer">Systems, Optimization, Transformers</span>
            </div>
            <p class="muted" data-i18n data-i18n-en="Optimizing Compact Convolutional Transformers with FlashAttention and fused Triton MLP kernels, reducing memory without accuracy loss." data-i18n-zh="基于 FlashAttention 与 Triton 融合 MLP 内核优化 CCT，在不降精度的前提下显著降低显存，同时重构注意力路径与内存访问并提供可复现实验建议。" data-i18n-ja="FlashAttention と Triton の融合 MLP カーネルで CCT を最適化。精度を落とさずメモリ削減、注意経路・メモリアクセスを再設計。再現手順と推奨設定を提示し、推論速度と安定性も改善。">Optimizing Compact Convolutional Transformers with FlashAttention and fused Triton MLP kernels, reducing memory without accuracy loss.</p>
            <div class="talk-actions">
              <a class="btn small" href="/cct.pdf" target="_blank" rel="noopener" data-i18n data-i18n-en="PDF" data-i18n-zh="论文" data-i18n-ja="PDF">PDF</a>
              <a class="btn small outline" href="https://docs.google.com/presentation/d/1_oMC8Y44DjjrM5ykMxsfRABoHZar_dccVmkZdVIiIA0/edit?usp=sharing" target="_blank" rel="noopener" data-i18n data-i18n-en="Slides" data-i18n-zh="幻灯片" data-i18n-ja="スライド">Slides</a>
            </div>
          </article>

          <article class="talk-card reveal" data-type="talk">
            <span class="talk-type" data-i18n data-i18n-en="Paper" data-i18n-zh="论文" data-i18n-ja="論文">Paper</span>
            <h3 data-i18n data-i18n-en="NeRF Ablations" data-i18n-zh="NeRF 消融实验" data-i18n-ja="NeRF アブレーション">NeRF Ablations</h3>
            <div class="talk-meta">
            <span data-i18n data-i18n-en="2024" data-i18n-zh="2024">2024</span>
            <span>•</span>
            <span data-i18n data-i18n-en="Neural Rendering, 3D Reconstruction" data-i18n-zh="神经渲染、三维重建" data-i18n-ja="ニューラルレンダリング、3次元再構成">Neural Rendering, 3D Reconstruction</span>
          </div>
          <p class="muted" data-i18n data-i18n-en="Ablation study of Neural Radiance Fields across hyperparameters, samplers, dataset size, and resolution, analyzing efficiency vs. quality." data-i18n-zh="神经辐射场（NeRF）消融：评估超参数、采样器、数据规模/分辨率，报告 PSNR/SSIM 与训练时间/显存曲线，并给出配置建议及渲染对比。" data-i18n-ja="NeRF のアブレーション：ハイパーパラメータ等を横断し、効率と画質のトレードオフを分析。PSNR/SSIM と学習コスト（時間・VRAM）を可視化し、設定指針も提示。">Ablation study of Neural Radiance Fields across hyperparameters, samplers, dataset size, and resolution, analyzing efficiency vs. quality.</p>
          <div class="talk-actions">
            <a class="btn small" href="/nerf.pdf" target="_blank" rel="noopener" data-i18n data-i18n-en="PDF" data-i18n-zh="论文" data-i18n-ja="PDF">PDF</a>
          </div>
        </article>

          <article class="talk-card reveal" data-type="talk">
            <span class="talk-type" data-i18n data-i18n-en="Paper & Talk" data-i18n-zh="论文与演讲" data-i18n-ja="論文・発表">Paper & Talk</span>
            <h3 data-i18n data-i18n-en="Lensless Real-Time Reconstruction" data-i18n-zh="无透镜实时成像" data-i18n-ja="レンズレス実時間再構成">Lensless Real-Time Reconstruction</h3>
  <div class="talk-meta">
    <span data-i18n data-i18n-en="2024" data-i18n-zh="2024">2024</span>
    <span>•</span>
    <span data-i18n data-i18n-en="GD/ADMM, U-Net, DiffuserCam" data-i18n-zh="GD/ADMM、U-Net、DiffuserCam">GD/ADMM, U-Net, DiffuserCam</span>
  </div>
  <p class="muted" data-i18n data-i18n-en="Benchmarks of lensless camera reconstructions with GD/ADMM and learning-based methods on DiffuserCam, balancing speed and quality." data-i18n-zh="在 DiffuserCam 上评测无透镜实时成像：比较 GD/ADMM 与 U-Net 的速度与质量，报告帧率/延迟与 PSNR/LPIPS，并给出 GPU/CPU 部署建议。" data-i18n-ja="DiffuserCam 上で GD/ADMM と学習ベース手法を比較し、レンズレス再構成の速度と画質のバランスを評価。FPS/遅延や画質指標を報告し、GPU/CPU 展開の指針を示します。">Benchmarks of lensless camera reconstructions with GD/ADMM and learning-based methods on DiffuserCam, balancing speed and quality.</p>
  
  
  <div class="talk-actions">
    <a class="btn small" href="lensless.pdf" target="_blank" rel="noopener" aria-label="View Lensless Imaging Benchmarks paper PDF" data-i18n data-i18n-en="PDF" data-i18n-zh="论文" data-i18n-ja="PDF">PDF</a>
  
  <a class="btn small outline" href="https://docs.google.com/presentation/d/1yEyKeakbBQTWjffiDoojU19GuY4Gfth0lEMu9cAKP_g/edit?usp=sharing" target="_blank" rel="noopener" aria-label="View Lensless Imaging Benchmarks slides on Google Slides" data-i18n data-i18n-en="Slides" data-i18n-zh="幻灯片" data-i18n-ja="スライド">Slides</a>
</div>
          </article>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="section reveal fade-in">
      <div class="container">
        <h2 data-i18n data-i18n-en="Contact" data-i18n-zh="联系" data-i18n-ja="連絡先">Contact</h2>
        <p class="muted" data-i18n data-i18n-en="Let’s build something together." data-i18n-zh="一起做点有趣的东西吧。" data-i18n-ja="一緒に何か面白いものを作りましょう。">Let’s build something together.</p>

        <div class="contact-card">
  <div class="contact-left">
    <form id="contactForm" class="contact-form" novalidate>
      <!-- Honeypot to catch bots -->
      <input type="text" id="company" name="company" autocomplete="organization" class="hidden-hp" tabindex="-1" aria-hidden="true">

      <div class="contact-grid">
        <div>
          <label for="name" data-i18n data-i18n-en="Your Name" data-i18n-zh="你的名字" data-i18n-ja="お名前">Your Name</label>
          <input id="name" name="name" type="text" autocomplete="name" placeholder="Jane Doe" required data-i18n data-i18n-attrs="placeholder" data-i18n-placeholder-en="Jane Doe" data-i18n-placeholder-zh="张三" data-i18n-placeholder-ja="山田太郎">
        </div>
        <div>
          <label for="email" data-i18n data-i18n-en="Your Email" data-i18n-zh="你的邮箱" data-i18n-ja="メールアドレス">Your Email</label>
          <input id="email" name="email" type="email" autocomplete="email" placeholder="jane@example.com" required data-i18n data-i18n-attrs="placeholder" data-i18n-placeholder-en="jane@example.com" data-i18n-placeholder-zh="zhangsan@example.com" data-i18n-placeholder-ja="taro@example.com">
        </div>
      </div>

      <div>
        <label for="subject" data-i18n data-i18n-html data-i18n-en='Subject <span class="sr-only">(optional)</span>' data-i18n-zh='主题 <span class="sr-only">（可选）</span>' data-i18n-ja='件名 <span class="sr-only">（任意）</span>'>Subject <span class="sr-only">(optional)</span></label>
        <input id="subject" name="subject" type="text" placeholder="What’s this about?" data-i18n data-i18n-attrs="placeholder" data-i18n-placeholder-en="What’s this about?" data-i18n-placeholder-zh="这是关于什么？" data-i18n-placeholder-ja="どのようなご用件ですか？">
      </div>

      <div>
        <label for="message" data-i18n data-i18n-en="Message" data-i18n-zh="留言" data-i18n-ja="メッセージ">Message</label>
        <textarea id="message" name="message" rows="6" maxlength="1200" placeholder="Tell me about your idea, timeline, and goals…" required data-i18n data-i18n-attrs="placeholder" data-i18n-placeholder-en="Tell me about your idea, timeline, and goals…" data-i18n-placeholder-zh="介绍一下你的想法、时间规划和目标…" data-i18n-placeholder-ja="アイデア、スケジュール、目標について教えてください…"></textarea>
        <div class="char-counter" id="charCounter">0 / 1200</div>
      </div>

      <div class="contact-actions">
        <button type="submit" class="btn" id="sendBtn" data-i18n data-i18n-en="Send Message" data-i18n-zh="发送" data-i18n-ja="送信">Send Message</button>
      </div>
    </form>
  </div>

  <div class="contact-right">
    <div class="visitor-map-head">
      <h3 class="visitor-map-title">
  <img src="/images/map.png" 
       alt="" 
       style="width:1.2em; height:1.2em; vertical-align:middle; margin-right:.35rem; position:relative; top:-2px;">
  <span data-i18n data-i18n-en="Live Visitor Map" data-i18n-zh="实时访客地图" data-i18n-ja="リアルタイム訪問者マップ">Live Visitor Map</span>
</h3>
      <div class="map-legend">
        <span class="legend-item"><span class="legend-dot legend-recent"></span> <span data-i18n data-i18n-en="Recent" data-i18n-zh="最近" data-i18n-ja="最近">Recent</span></span>
        <span class="legend-item"><span class="legend-dot legend-past"></span> <span data-i18n data-i18n-en="Past" data-i18n-zh="历史" data-i18n-ja="過去">Past</span></span>
      </div>
    </div>
    <p class="muted small" data-i18n data-i18n-en="See where visitors are coming from." data-i18n-zh="查看访客来自哪里。" data-i18n-ja="訪問者がどこから来ているかを確認できます。">See where visitors are coming from.</p>
    <div class="visitor-map-frame">
      <div class="map-spinner" id="mapSpinner" role="status" aria-label="Loading map"></div>
      <div id="visitorMapPlaceholder"></div>
    </div>
  </div>
</div>

      </div>
    </section>
  </main>

  <script>
  // Minimal i18n content applier. Use:
  //  - data-i18n with data-i18n-en/zh/ja for text
  //  - data-i18n-html to set innerHTML instead of textContent
  //  - data-i18n-attrs="placeholder,title,aria-label" and corresponding
  //    data-i18n-<attr>-<lang> for attribute translations
  (function () {
    function applyI18n(lang) {
      try {
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const html = el.hasAttribute('data-i18n-html');
          // Fallback chain: exact lang -> zh -> en -> keep existing
          const pref = [lang, 'zh', 'en'].filter((v, i, a) => a.indexOf(v) === i);
          let textVal = null;
          for (const l of pref) {
            const v = el.getAttribute(`data-i18n-${l}`);
            if (v != null) { textVal = v; break; }
          }
          if (textVal != null) { if (html) el.innerHTML = textVal; else el.textContent = textVal; }
          // Optional attribute translations
          const attrsList = (el.getAttribute('data-i18n-attrs') || '').split(',').map(s => s.trim()).filter(Boolean);
          if (attrsList.length) {
            attrsList.forEach(attr => {
              // Fallback chain for attributes as well
              let attrVal = null;
              for (const l of pref) {
                const candidate = el.getAttribute(`data-i18n-${attr}-${l}`);
                if (candidate != null) { attrVal = candidate; break; }
              }
              if (attrVal != null) el.setAttribute(attr, attrVal);
            });
          }
        });
      } catch (_) {}
    }
    // Expose applier so other UI (e.g., overlay) can live-apply without reload
    try {
      window.__i18n = window.__i18n || {};
      window.__i18n.apply = applyI18n;
    } catch (_) {}
    const lang = (window.__i18n && window.__i18n.getInitialLang && window.__i18n.getInitialLang()) || (document.documentElement.getAttribute('lang')||'en');
    applyI18n(lang);
  })();
  </script>

  <!-- Optional audio files; drop your real MP3s at /audio and these will be used automatically -->
  <audio id="nameAudioEn" preload="auto">
    <source src="zijie-cai.m4a" type="audio/mpeg">
  </audio>
  <audio id="nameAudioZh" preload="auto">
    <source src="zijie-cai.m4a" type="audio/mpeg">
  </audio>

  <script>
    // --- Custom cursor ripple effect only (system cursor remains) ---
    window.addEventListener('click', e => {
      const ripple = document.createElement('div');
      ripple.className = 'cursor-ripple';
      ripple.style.left = e.clientX + 'px';
      ripple.style.top = e.clientY + 'px';
      document.body.appendChild(ripple);
      setTimeout(() => ripple.remove(), 600);
    });

  // --- Scroll restore: start at top, then return to where you left off ---
  // Ensure browser doesn't auto-restore
  try { history.scrollRestoration = 'manual'; } catch (_) {}

  const SCROLL_KEY = 'scrollPos';

  // Save position right before unloading
  window.addEventListener('beforeunload', () => {
    const y = window.scrollY || window.pageYOffset || 0;
    sessionStorage.setItem(SCROLL_KEY, String(y));
  });

  // Always start at top on reload
  window.scrollTo(0, 0);

  // After load + initial animations settle, restore prior position smoothly
  window.addEventListener('load', () => {
    const saved = sessionStorage.getItem(SCROLL_KEY);
    if (saved !== null) {
      // Wait for next frame and a short delay so layout/animations are ready
      requestAnimationFrame(() => {
        setTimeout(() => {
          window.scrollTo({ top: parseInt(saved, 10) || 0, behavior: 'smooth' });
        }, 350); // tweak 250–450ms to taste
      });
    }
  });

  // Handle bfcache (back-forward cache) restores consistently
  window.addEventListener('pageshow', (e) => {
    if (e.persisted) {
      window.scrollTo(0, 0);
      const saved = sessionStorage.getItem(SCROLL_KEY);
      if (saved !== null) {
        setTimeout(() => {
          window.scrollTo({ top: parseInt(saved, 10) || 0, behavior: 'smooth' });
        }, 200);
      }
    }
  });
  /* Load-in bootstrap */
  // --- Name pronunciation logic ---
  (function(){
    let currentEl = null;
    const btns = [document.getElementById('pronounceHero'), document.getElementById('pronounceNav')].filter(Boolean);
    if (!btns.length) return;

    const langSelect = document.getElementById('languageSelect');
    const audioEn = document.getElementById('nameAudioEn');
    const audioZh = document.getElementById('nameAudioZh');

    // Choose which variant to play based on current language
    const pickVariant = () => {
      const current = (window.__i18n && window.__i18n.getInitialLang && window.__i18n.getInitialLang()) || (langSelect && langSelect.value) || (document.documentElement.getAttribute('lang')||'en');
      return current === 'zh' ? 'zh' : 'en';
    };

    let speaking = false;
    const setSpeaking = (on) => {
  speaking = on;
  btns.forEach(b => {
    b.classList.toggle('is-speaking', on);
    b.classList.toggle('is-playing', on);
    b.setAttribute('aria-pressed', String(on));
    b.title = on ? 'Pause pronunciation' : 'Hear pronunciation';
  });
};
    document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    try { if (currentEl) { currentEl.pause(); currentEl.currentTime = 0; } } catch(_) {}
    try { window.speechSynthesis.cancel(); } catch(_) {}
    setSpeaking(false);
  }
});

    const speakWithWebAPI = async (variant) => {
      if (!('speechSynthesis' in window)) return false;
      const utter = new SpeechSynthesisUtterance('Zijie Cai');
      // Try to be helpful: Chinese voice if zh, otherwise English
      utter.lang = (variant === 'zh') ? 'zh-CN' : 'en-US';
      // Slightly slower for clarity
      utter.rate = 0.95;
      utter.onstart = () => setSpeaking(true);
      utter.onend = () => setSpeaking(false);
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
      return true;
    };

    const playAudio = async (variant) => {
      const el = (variant === 'zh') ? audioZh : audioEn;
      if (speaking && currentEl === el && !el.paused) {
  try { el.pause(); el.currentTime = 0; } catch(_) {}
  setSpeaking(false);
  return true;
}
try {
  if (currentEl && currentEl !== el) { currentEl.pause(); currentEl.currentTime = 0; }
} catch(_) {}
currentEl = el;

el.currentTime = 0;
setSpeaking(true);
await el.play();
el.onpause = () => setSpeaking(false);
el.onended = () => setSpeaking(false);
      if (el && el.querySelector('source') && el.querySelector('source').getAttribute('src')) {
        try {
          el.currentTime = 0;
          setSpeaking(true);
          await el.play();
          el.onended = () => setSpeaking(false);
          return true;
        } catch(e) {
          // fall through to Web Speech
        }
      }
      return speakWithWebAPI(variant);
    };

    const handleClick = async () => {
      const v = pickVariant();
      if (speaking && (!currentEl || (typeof currentEl.paused === 'boolean' && currentEl.paused))) {
  try { window.speechSynthesis.cancel(); } catch(_) {}
  setSpeaking(false);
  return;
}
      await playAudio(v);
      // brief ripple for feedback
      try {
        const rect = btns[0].getBoundingClientRect();
        const evt = new MouseEvent('click', {clientX: rect.left + rect.width/2, clientY: rect.top + rect.height/2, bubbles: true});
        window.dispatchEvent(evt);
      } catch(_) {}
    };

    btns.forEach(btn => {
      // ARIA helper
      const helper = document.getElementById('namePronounceHelper');
      if (helper) btn.setAttribute('aria-describedby', 'namePronounceHelper');
      btn.addEventListener('click', handleClick);
      btn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); handleClick(); }
      });
    });
  })();
  document.body.classList.add('preload');
  window.addEventListener('load', () => {
    document.body.classList.remove('preload');
    document.body.classList.add('loaded');
  });
  /* Scroll reveal observer */
  (function(){
    const els = document.querySelectorAll('.reveal');
    if (!('IntersectionObserver' in window) || !els.length) {
      els.forEach(el => el.classList.add('visible'));
      return;
    }
    const io = new IntersectionObserver((entries, obs) => {
      entries.forEach((entry, idx) => {
        if (entry.isIntersecting) {
          setTimeout(() => {
            entry.target.classList.add('visible');
            obs.unobserve(entry.target);
          }, idx * 150); // stagger each by 150ms
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -8% 0px' });
    els.forEach(el => io.observe(el));
  })();
  /* Theme preference + rope logic (unchanged) */
  const storageKey='theme-preference';
  const onClick=()=>{theme.value=theme.value==='light'?'dark':'light';setPreference();};
  const getColorPreference = () => {
    const stored = localStorage.getItem(storageKey);
    if (stored) return stored; // user-picked theme persists
    return 'light'; // default theme
  };
  const setPreference=()=>{localStorage.setItem(storageKey,theme.value);reflectPreference();};
  const reflectPreference = () => {
    document.firstElementChild.setAttribute('data-theme', theme.value);
    document.querySelector('.theme-toggle').setAttribute('aria-label', theme.value);
    document.documentElement.style.setProperty('--on', theme.value === 'dark' ? 1 : 0);
    window.dispatchEvent(new CustomEvent('themechange', { detail: { theme: theme.value } }));
  }
  // Hint: Pronunciation uses this selector — set to 中文 for Chinese TTS
  try { document.getElementById('languageSelect').title = 'Pronunciation follows this language (EN/中文/日本語)'; } catch(_) {}
  const theme={value:getColorPreference()};
  reflectPreference();
  window.addEventListener('load',()=>{
    reflectPreference();
    document.querySelector('.theme-toggle').addEventListener('click',onClick);
  });
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change',({matches})=>{
    if (localStorage.getItem(storageKey)) return; // respect user choice if set
    theme.value = matches ? 'dark' : 'light';
    reflectPreference();
  });

  
  /* Smooth scroll for in-page header links */
  document.querySelectorAll('a[href^="#"]').forEach(a => {
    a.addEventListener('click', e => {
      const id = a.getAttribute('href').slice(1);
      const target = document.getElementById(id);
      if (target) {
        e.preventDefault();
        if (id === 'about') {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        } else {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
    });
  });

  /* Project filters */
  const grid = document.getElementById('projectsGrid');
  const filterBtns = document.querySelectorAll('.filter-btn');
  if (grid && filterBtns.length) {
    filterBtns.forEach(btn => btn.addEventListener('click', () => {
      const tag = btn.dataset.filter;
      filterBtns.forEach(b => b.classList.toggle('outline', b !== btn));
      filterBtns.forEach(b => b.setAttribute('aria-pressed', String(b === btn)));
      grid.querySelectorAll('.project-card').forEach(card => {
        const tags = (card.dataset.tags || '').split(' ');
        const show = tag === 'all' || tags.includes(tag);
        card.style.display = show ? '' : 'none';
      });
    }));
    filterBtns.forEach((btn, i) => btn.addEventListener('keydown', (e) => {
      if(e.key==='ArrowRight'){ (filterBtns[i+1]||filterBtns[0]).focus(); }
      if(e.key==='ArrowLeft'){ (filterBtns[i-1]||filterBtns[filterBtns.length-1]).focus(); }
    }));
  }

  /* Talks filters */
  const talksGrid = document.getElementById('talksGrid');
  const talkFilterWrap = document.querySelector('.talks-filter');
  if (talksGrid && talkFilterWrap) {
    const talkBtns = talkFilterWrap.querySelectorAll('.filter-btn');
    talkBtns.forEach(btn => btn.addEventListener('click', () => {
      const type = btn.dataset.filter;
      talkBtns.forEach(b => b.classList.toggle('outline', b !== btn));
      talkBtns.forEach(b => b.setAttribute('aria-selected', String(b === btn)));
      talksGrid.querySelectorAll('.talk-card').forEach(card => {
        const show = type === 'all' || card.dataset.type === type;
        card.style.display = show ? '' : 'none';
      });
    }));
  }

  /* Copy email */
  const copyBtn = document.getElementById('copyEmail');
  if (copyBtn) {
    copyBtn.addEventListener('click', async () => {
      const email = copyBtn.dataset.email;
      try {
        await navigator.clipboard.writeText(email);
        const old = copyBtn.textContent;
        copyBtn.textContent = 'Copied!';
        setTimeout(() => (copyBtn.textContent = old), 1200);
      } catch {
        window.location.href = 'mailto:' + email;
      }
    });
  }

  /* Contact form logic */
  const contactForm = document.getElementById('contactForm');
  const formStatus = document.getElementById('formStatus');
  const sendBtn = document.getElementById('sendBtn');
  const sendMailtoBtn = document.getElementById('sendMailto');
  const messageEl = document.getElementById('message');
  const nameEl = document.getElementById('name');
  const emailEl = document.getElementById('email');
  const subjectEl = document.getElementById('subject');
  const hpEl = document.getElementById('company');
  const charCounter = document.getElementById('charCounter');

  if (messageEl && charCounter) {
    const updateCount = () => { charCounter.textContent = `${messageEl.value.length} / ${messageEl.maxLength}`; };
    messageEl.addEventListener('input', updateCount);
    updateCount();
  }

  const setStatus = (msg, type='') => {
    if (!formStatus) return;
    formStatus.textContent = msg || '';
    formStatus.classList.remove('success','error');
    if (type) formStatus.classList.add(type);
  };

  const enc = (s) => encodeURIComponent(s || '').replace(/%20/g, '+');

  // Build and open a mailto: link with the form contents
  const openMailto = () => {
    const to = 'zijiecai@umd.edu';
    const subjBase = subjectEl?.value?.trim() || `Portfolio Contact from ${nameEl?.value?.trim() || 'Visitor'}`;
    const subject = enc(subjBase);
    const body = enc(`Name: ${nameEl?.value || ''}\nEmail: ${emailEl?.value || ''}\n\n${messageEl?.value || ''}`);
    window.location.href = `mailto:${to}?subject=${subject}&body=${body}`;
  };

  if (sendMailtoBtn) {
    sendMailtoBtn.addEventListener('click', openMailto);
  }

  if (contactForm) {
    contactForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      setStatus('');
      if (hpEl && hpEl.value) { setStatus('Spam detected.', 'error'); return; }
      if (!nameEl.value.trim() || !emailEl.value.trim() || !messageEl.value.trim()) {
        setStatus('Please fill out all required fields.', 'error');
        return;
      }
      sendBtn.disabled = true; sendBtn.textContent = 'Sending…';
      try {
        // Placeholder: integrate Formspree/EmailJS/fetch to your backend here.
        openMailto();
        setStatus('Opened your email app with a pre‑filled message. Ready to send!', 'success');
        contactForm.reset();
        if (charCounter) charCounter.textContent = `0 / ${messageEl.maxLength}`;
      } catch (err) {
        setStatus('Something went wrong. Please try again or use the quick Email button below.', 'error');
      } finally {
        sendBtn.disabled = false; sendBtn.textContent = 'Send Message';
      }
    });
  }


  /* Mobile menu */
  const menuBtn = document.getElementById('menuToggle');
  const nav = document.querySelector('.site-nav');
  if (menuBtn) {
    menuBtn.addEventListener('click', () => {
      const open = document.body.classList.toggle('nav-open');
      menuBtn.setAttribute('aria-expanded', String(open));
    });
  }
  /* Active link highlight */
  const sections = ['about','featured','projects','experience','writing','contact'].map(id => document.getElementById(id)).filter(Boolean);
  const links = document.querySelectorAll('.nav-links a');
  const io = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        links.forEach(a => a.removeAttribute('aria-current'));
        const active = document.querySelector('.nav-links a[href="#'+e.target.id+'"]');
        if (active) active.setAttribute('aria-current','true');
      }
    });
  }, { rootMargin: '-45% 0px -50% 0px', threshold: 0.01 });
  sections.forEach(s => io.observe(s));

  /* Back to top */
  const back = document.getElementById('backToTop');
  if (back) {
    const toggleBack = () => back.classList.toggle('show', window.scrollY > 600);
    window.addEventListener('scroll', toggleBack);
    back.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
    toggleBack();
  }

  /* Year */
  const yearEl = document.getElementById('year');
  if (yearEl) {
    yearEl.textContent = new Date().getFullYear();
  }

  // Lazy-load visitor map
(() => {
  const placeholder = document.getElementById('visitorMapPlaceholder');
  const contactSection = document.getElementById('contact');
  if (!placeholder || !contactSection) return;

  let mapLoaded = false;

  // Helper to create the script tag for the correct theme
  function createVisitorMapScript(theme) {
    const s = document.createElement('script');
    s.type = 'text/javascript';
    s.id = 'mapmyvisitors';
    if (theme === 'dark') {
      s.src =
        'https://mapmyvisitors.com/map.js?cl=e6e2d3&w=576&t=tt&d=n9B-F38tw8Sz8sAqMKR0vQjAqv7EbVcBMJ1qaYXcjCc&co=35312b&cmo=22c55e&cmn=ff8a00&ct=e6e2d3';
    } else {
      s.src =
        'https://mapmyvisitors.com/map.js?cl=2b2a27&w=576&t=tt&d=n9B-F38tw8Sz8sAqMKR0vQjAqv7EbVcBMJ1qaYXcjCc&co=ffffff&cmo=22c55e&cmn=ff8a00&ct=2b2a27';
    }
    return s;
  }

  // Insert the map script for the current theme with fade-out/in effect
  // Insert the map script for the current theme with fade-out/in effect
  function insertVisitorMap(theme) {
    placeholder.style.transition = "opacity 0s ease";
    placeholder.style.opacity = "0";
    setTimeout(() => {
      placeholder.innerHTML = "";
      placeholder.appendChild(createVisitorMapScript(theme));
      // fade back in
      requestAnimationFrame(() => {
        placeholder.style.transition = "opacity 2s ease";
        placeholder.style.opacity = "0";
        setTimeout(() => { placeholder.style.opacity = "1"; }, 1000);
      });
    }, 350);
  }

  // Lazy load on scroll into view
  const io = new IntersectionObserver((entries, obs) => {
    entries.forEach(entry => {
      if (entry.isIntersecting && !mapLoaded) {
        mapLoaded = true;
        insertVisitorMap(document.documentElement.getAttribute("data-theme") || "light");
        obs.disconnect();
      }
    });
  }, { threshold: 0.1 });
  io.observe(contactSection);

  // Update instantly when theme changes, if map is already loaded
  window.addEventListener("themechange", (e) => {
    if (mapLoaded) {
      insertVisitorMap(e.detail.theme);
    }
  });
})();
  /* ——— Interactive, animated background (multi‑style) ——— */
  (() => {
    const canvas = document.getElementById('bgfx');
    const modeBtn = document.getElementById('bgfx-mode');
    if (!canvas || !modeBtn) return;
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) { 
      canvas.style.display = 'none'; 
      modeBtn.style.display = 'none';
      return; 
    }
    const ctx = canvas.getContext('2d', { alpha: true });
    const DPR = Math.min(window.devicePixelRatio || 1, 2);

    // ---- theming helpers
    const getColors = () => {
      const cs = getComputedStyle(document.documentElement);
      return {
        a: cs.getPropertyValue('--accent-color').trim() || '#007AFF',
        b: cs.getPropertyValue('--accent-2').trim() || '#5856D6',
        text: cs.getPropertyValue('--text-color').trim() || '#ffffff',
        bg: cs.getPropertyValue('--bg').trim() || '#111111'
      };
    };
    let colors = getColors();
    let themeName = document.documentElement.getAttribute('data-theme') || 'light';
    window.addEventListener('themechange', (e) => { 
      colors = getColors();
      themeName = (e.detail && e.detail.theme) ? e.detail.theme : themeName;
      computeSafeRects();
    });

    // ---- canvas + state
    let W = 0, H = 0, running = true, t = 0;
    // Define areas where blobs should not overlap important content
    let safeRects = [];
    function computeSafeRects(){
      const sels = ['.hello', '.hello-meta'];
      safeRects = [];
      for (const sel of sels){
        const el = document.querySelector(sel);
        if (!el) continue;
        const r = el.getBoundingClientRect();
        // Inflate by 24px padding and convert to DPR space (canvas is fixed to viewport)
        const pad = 24;
        safeRects.push({
          x: (r.left - pad) * DPR,
          y: (r.top - pad) * DPR,
          w: (r.width + pad*2) * DPR,
          h: (r.height + pad*2) * DPR,
        });
      }
    }
    function resize(){
      W = canvas.width = Math.floor(innerWidth * DPR);
      H = canvas.height = Math.floor(innerHeight * DPR);
      canvas.style.width = innerWidth + 'px';
      canvas.style.height = innerHeight + 'px';
      computeSafeRects();
    }
    window.addEventListener('resize', resize);
    window.addEventListener('scroll', computeSafeRects, { passive: true });
    document.addEventListener('visibilitychange', () => { running = !document.hidden; if (running) raf(step); });
    resize();

    // ---- utils
    const rand = (min, max) => min + Math.random() * (max - min);
    const clamp = (x, a, b) => Math.max(a, Math.min(b, x));
    const lerp = (a, b, p) => a + (b - a) * p;
    const hexToRgb = (hex) => {
      const m = hex.replace('#',''); 
      const i = parseInt(m.length === 3 ? m.split('').map(c=>c+c).join('') : m, 16);
      return { r:(i>>16)&255, g:(i>>8)&255, b:i&255 };
    };
    const mixRGB = (c1, c2, p) => {
      const r = Math.round(lerp(c1.r,c2.r,p)), g = Math.round(lerp(c1.g,c2.g,p)), b = Math.round(lerp(c1.b,c2.b,p));
      return `rgb(${r},${g},${b})`;
    };
    const colA = hexToRgb(colors.a), colB = hexToRgb(colors.b);

    // ---- mouse/touch
    const mouse = { x: -1e9, y: -1e9, down: false };
    const getPos = (e) => {
      const r = canvas.getBoundingClientRect();
      if (e.touches?.[0]) return { x:(e.touches[0].clientX - r.left) * DPR, y:(e.touches[0].clientY - r.top) * DPR };
      return { x:(e.clientX - r.left) * DPR, y:(e.clientY - r.top) * DPR };
    };
    window.addEventListener('mousemove', (e)=>Object.assign(mouse, getPos(e)), {passive:true});
    window.addEventListener('mouseleave', ()=>{ mouse.x = mouse.y = -1e9; });
    window.addEventListener('touchmove', (e)=>Object.assign(mouse, getPos(e)), {passive:true});
    window.addEventListener('touchend', ()=>{ mouse.x = mouse.y = -1e9; });
    canvas.addEventListener('pointerdown', (e)=>{ mouse.down = true; burst(getPos(e)); });
    window.addEventListener('pointerup', ()=>{ mouse.down = false; });

    // ==========================================================
    // MODES
    // 2: Gooey Blobs (metaball glow)
    // ==========================================================
    const MODES = ['Gooey'];
    let mode = 2; // Gooey only
    const setModeLabel = () => (modeBtn.textContent = `Style: Gooey`);
    setModeLabel();
    // Hide style switcher since only one mode
    modeBtn.style.display = 'none';

    // ---- shared pools
    let particles = [];
    let linesRange = 140;
    let flowFieldZ = 0;

    function initMode(reset=false){
      particles.length = 0;
      if (mode === 0) { // constellation
        const target = Math.min(100, Math.max(40, Math.floor((innerWidth*innerHeight)/20000)));
        for (let i=0;i<target;i++) particles.push({
          x: Math.random()*W, y: Math.random()*H,
          vx: rand(-0.25,0.25)*DPR, vy: rand(-0.25,0.25)*DPR,
          r: rand(1.2, 2.4)*DPR, hueT: Math.random()
        });
        linesRange = Math.max(90, Math.min(200, Math.hypot(innerWidth, innerHeight)*0.08));
      }
      if (mode === 1) { // flow field ribbons
        const target = Math.min(180, Math.max(80, Math.floor((innerWidth*innerHeight)/16000)));
        for (let i=0;i<target;i++) particles.push({
          x: Math.random()*W, y: Math.random()*H, a: Math.random()*Math.PI*2, speed: rand(.6,1.4)*DPR, life: rand(200, 800), r: rand(0.8,1.6)*DPR
        });
      }
      if (mode === 2) { // gooey blobs
        const target = Math.min(22, Math.max(12, Math.floor(Math.sqrt(innerWidth*innerHeight)/140)));
        for (let i=0;i<target;i++) particles.push({
          x: Math.random()*W, y: Math.random()*H,
          vx: rand(-0.22,0.22)*DPR, vy: rand(-0.22,0.22)*DPR,
          r: rand(24, 54)*DPR, hueT: Math.random()
        });
      }
      if (mode === 3) { // emoji float
        const EMOJI = ['✈️','🗺️','⭐️','✨','🌊','🎒','📍'];
        const target = Math.min(36, Math.max(18, Math.floor((innerWidth*innerHeight)/45000)));
        for (let i=0;i<target;i++) particles.push({
          x: Math.random()*W, y: Math.random()*H, vy: rand(0.15,0.4)*DPR, vx: rand(-0.15,0.15)*DPR,
          s: rand(18, 38)*DPR, e: EMOJI[Math.floor(Math.random()*EMOJI.length)], r: rand(.6, 1.4), spin: rand(-.02,.02)
        });
      }
      if (reset) ctx.clearRect(0,0,W,H);
    }

    // --- simple pseudo noise (fast, no Perlin import)
    function noise2D(x,y){
      // value noise via sine hash
      const s = Math.sin(x*12.9898 + y*78.233) * 43758.5453;
      return s - Math.floor(s);
    }

    function burst(pos){
      if (!pos) return;
      // Add a handful of energized particles according to mode
      if (mode === 0 || mode === 1) {
        for (let i=0;i<16;i++){
          particles.push({
            x: pos.x, y: pos.y,
            vx: Math.cos(i/16*Math.PI*2)*rand(1,2.5)*DPR,
            vy: Math.sin(i/16*Math.PI*2)*rand(1,2.5)*DPR,
            r: rand(1.2,2.2)*DPR, hueT: Math.random(), life: 120
          });
        }
      } else if (mode === 2) {
        for (let i=0;i<4;i++){
          particles.push({
            x: pos.x+rand(-20,20)*DPR, y: pos.y+rand(-20,20)*DPR,
            vx: rand(-0.6,0.6)*DPR, vy: rand(-0.6,0.6)*DPR,
            r: rand(16,30)*DPR, hueT: Math.random()
          });
        }
      } else if (mode === 3) {
        // spawn sparkles
        for (let i=0;i<10;i++){
          particles.push({ x: pos.x, y: pos.y, vy: -rand(1.2,2.4)*DPR, vx: rand(-.6,.6)*DPR, e:'✨', s: rand(10,22)*DPR, fade: 1.0 });
        }
      }
    }

    function drawConstellation(){
      const cA = hexToRgb(colors.a), cB = hexToRgb(colors.b);
      // background vignette
      const grad = ctx.createRadialGradient(W*0.1, H*0.9, 10, W*0.3, H*0.7, Math.max(W, H));
      grad.addColorStop(0, colors.bg + '00');
      grad.addColorStop(1, colors.bg + '10');
      ctx.fillStyle = grad; ctx.fillRect(0,0,W,H);

      for (let p of particles){
        // attraction to mouse
        const dx = mouse.x - p.x, dy = mouse.y - p.y, d2 = dx*dx + dy*dy;
        if (d2 < 200*200*DPR) { p.vx += dx * 0.0005; p.vy += dy * 0.0005; }
        p.x += p.vx; p.y += p.vy;
        if (p.x < -10) p.x = W+10; if (p.x > W+10) p.x=-10;
        if (p.y < -10) p.y = H+10; if (p.y > H+10) p.y=-10;

        ctx.beginPath();
        ctx.shadowBlur = 18 * DPR;
        ctx.shadowColor = mixRGB(cA, cB, p.hueT);
        ctx.fillStyle = mixRGB(cA, cB, p.hueT);
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();
        ctx.shadowBlur = 0;
      }

      // lines
      ctx.lineWidth = 0.9 * DPR;
      for (let i=0;i<particles.length;i++){
        for (let j=i+1;j<particles.length;j++){
          const a = particles[i], b = particles[j];
          const dx = a.x-b.x, dy = a.y-b.y, dist = Math.hypot(dx,dy);
          if (dist < linesRange){
            const t = 1 - (dist/linesRange);
            ctx.strokeStyle = `rgba(255,255,255,${0.06*t})`;
            ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke();
          }
        }
      }
    }

    function drawFlowField(){
      flowFieldZ += 0.002;
      ctx.globalCompositeOperation = 'source-over';
      ctx.fillStyle = colors.bg + '08';
      ctx.fillRect(0,0,W,H);
      ctx.globalCompositeOperation = 'lighter';

      for (let p of particles){
        const n = noise2D((p.x*0.002)+flowFieldZ, (p.y*0.002)-flowFieldZ);
        const ang = n * Math.PI * 2;
        p.x += Math.cos(ang) * p.speed;
        p.y += Math.sin(ang) * p.speed;
        if (mouse.down){ p.x += (mouse.x - p.x)*0.01; p.y += (mouse.y - p.y)*0.01; }

        if (p.x < 0) p.x = W; if (p.x > W) p.x = 0;
        if (p.y < 0) p.y = H; if (p.y > H) p.y = 0;

        ctx.beginPath();
        ctx.lineWidth = p.r;
        ctx.strokeStyle = `rgba(255,255,255,.05)`;
        ctx.moveTo(p.x, p.y);
        ctx.lineTo(p.x - Math.cos(ang)*6*DPR, p.y - Math.sin(ang)*6*DPR);
        ctx.stroke();

        if (p.life !== undefined) { p.life -= 1; }
      }
      // prune short‑lived burst lines
      particles = particles.filter(p => p.life === undefined || p.life > 0);
      ctx.globalCompositeOperation = 'source-over';
    }

    // Helper to get random radius
function randRadius() {
  return 60 + Math.random() * 100;
}

// Reinitialize particles with edge anchors + interior blobs
function initParticles(count) {
  particles = [];
  for (let i = 0; i < count; i++) {
    let p;
    if (i % 4 === 0) {
      // Edge-anchored blob
      p = {
        x: (Math.random() < 0.5 ? -50 : W + 50),
        y: Math.random() * H,
        r: randRadius(),
        vx: (Math.random() < 0.5 ? 0.4 : -0.4),
        vy: (Math.random() - 0.5) * 0.3,
        hueT: Math.random()
      };
    } else {
      // Interior blob
      p = {
        x: Math.random() * W,
        y: Math.random() * H,
        r: randRadius(),
        vx: (Math.random() - 0.5) * 0.6,
        vy: (Math.random() - 0.5) * 0.6,
        hueT: Math.random()
      };
    }

    // Check for overlaps before adding
    let tooClose = false;
    for (const q of particles) {
      const dx = p.x - q.x;
      const dy = p.y - q.y;
      const dist = Math.sqrt(dx * dx + dy * dy);
      if (dist < p.r + q.r * 0.6) {
        tooClose = true;
        break;
      }
    }
    if (!tooClose) particles.push(p);
  }
}

function drawGooey() {
  ctx.clearRect(0, 0, W, H);
  const scrollParallaxY = (window.scrollY || 0) * 0.08 * DPR;
  const alphaScale = (themeName === 'light') ? 0.7 : 1.0;
  ctx.globalCompositeOperation = 'lighter';

  for (let p of particles) {
    p.x += p.vx;
    p.y += p.vy;

    // wrap-around
    if (p.x < -p.r) p.x = W + p.r;
    if (p.x > W + p.r) p.x = -p.r;
    if (p.y < -p.r) p.y = H + p.r;
    if (p.y > H + p.r) p.y = -p.r;

    // theme filter
    if (themeName === 'light') {
      ctx.filter = 'saturate(1.6) brightness(1.25)';
    } else {
      ctx.filter = 'none';
    }

    // color mix: add slight random hue shift for variety
    const baseMix = mixRGB(hexToRgb(colors.a), hexToRgb(colors.b), p.hueT);
    const hueMix = baseMix.replace('rgb','rgba').replace(')',`,` + (0.9 * alphaScale).toFixed(3) + `)`);

    const g = ctx.createRadialGradient(
      p.x, p.y + scrollParallaxY, 0,
      p.x, p.y + scrollParallaxY, p.r * 3.0
    );
    g.addColorStop(0, hueMix);
    g.addColorStop(1, baseMix.replace('rgb','rgba').replace(')',`,0)`));

    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.arc(p.x, p.y + scrollParallaxY, p.r * 3.0, 0, Math.PI * 2);
    ctx.fill();

    ctx.filter = 'none'; // reset filter

    // gentle damping
    p.vx *= 0.998;
    p.vy *= 0.998;
  }

  // Safe zones
  ctx.globalCompositeOperation = 'destination-out';
  ctx.fillStyle = 'rgba(0,0,0,0.98)';
  for (const r of safeRects) {
    ctx.fillRect(r.x, r.y, r.w, r.h);
  }
  ctx.globalCompositeOperation = 'source-over';
}
    function drawEmoji(){
      ctx.clearRect(0,0,W,H);
      ctx.font = `${24*DPR}px system-ui, Apple Color Emoji, Segoe UI Emoji`;
      for (let p of particles){
        p.y -= p.vy; p.x += p.vx + Math.sin((p.y + t)*0.002)*0.2*DPR;
        p.vx = clamp(p.vx + (mouse.x - p.x)*1e-6, -0.6*DPR, 0.6*DPR);
        if (p.y < -40*DPR) p.y = H + 20*DPR;
        if (p.x < -40*DPR) p.x = W + 20*DPR;
        if (p.x > W + 40*DPR) p.x = -20*DPR;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.spin * t);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.font = `${p.s}px system-ui, Apple Color Emoji, Segoe UI Emoji`;
        ctx.fillText(p.e, 0, 0);
        ctx.restore();
as
        if (p.fade){ p.fade -= 0.02; if (p.fade <= 0) p.fade = undefined; }
      }
    }

    function step(){
      if (!running) return;
      t += 1;
      if (mode === 0) { ctx.clearRect(0,0,W,H); drawConstellation(); }
      else if (mode === 1) { drawFlowField(); }
      else if (mode === 2) { drawGooey(); }
      else { drawEmoji(); }
      raf(step);
    }

    const raf = window.requestAnimationFrame.bind(window);
    initMode(false);
    raf(step);
  })();
  </script>

  <footer class="site-footer">
    <p>© <span id="year"></span> Zijie Cai • Built with love and lots of JS</p>
  </footer>
  
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const spinner = document.querySelector(".map-spinner");
    const themeToggle = document.getElementById("theme-toggle");
    if (spinner) {
      spinner.classList.remove("fade-out"); // show immediately
      setTimeout(() => {
        spinner.classList.add("fade-out"); // hide after 3s
      }, 2500);
    }
    if (themeToggle) {
      themeToggle.addEventListener("click", () => {
        if (!spinner) return;
        spinner.classList.remove("fade-out"); // show immediately
        setTimeout(() => {
          spinner.classList.add("fade-out"); // hide after 3s
        }, 1500);
      });
    }
    
  });
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const sections = document.querySelectorAll("section[id]");
  const navLinks = document.querySelectorAll(".nav-links a");

  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      const id = entry.target.getAttribute("id");
      if (entry.isIntersecting) {
        // Remove highlight from all
        navLinks.forEach(link => link.removeAttribute("aria-current"));
        // Highlight the current
        const activeLink = document.querySelector(`.nav-links a[href="#${id}"]`);
        if (activeLink) {
          activeLink.setAttribute("aria-current", "true");
        }
      }
    });
  }, { rootMargin: "-40% 0px -55% 0px", threshold: 0.1 });

  sections.forEach(section => observer.observe(section));
});
</script>

<script>
  // ===== Scroll-linked animations (dialed down on small screens or reduced motion) =====
  const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  const isSmallScreen = window.matchMedia('(max-width: 900px)').matches;
  const lightAnimations = prefersReduced || isSmallScreen;
  if (!lightAnimations) {
    gsap.registerPlugin(ScrollTrigger);
    gsap.defaults({ ease: "none" }); // scrubbed animations should be linear

    // Helper to read the --w CSS var used by skill bars (e.g., 85%)
    function getVarWidth(el) {
      const v = getComputedStyle(el).getPropertyValue('--w').trim();
      return v ? parseFloat(v) : 0;
    }

    // Base fade-up for .reveal (without variant classes)
    document.querySelectorAll('.reveal:not(.slide-left):not(.slide-right):not(.flip):not(.scale-up):not(.fade-in)')
      .forEach((el) => {
        gsap.fromTo(el,
          { opacity: 0, y: 24 },
          {
            opacity: 1, y: 0,
            scrollTrigger: {
              trigger: el,
              start: 'top 85%',
              end:   'top 30%',
              scrub: true,
              fastScrollEnd: true
            }
          }
        );
      });

    // fade-in
    document.querySelectorAll('.reveal.fade-in').forEach((el) => {
      gsap.fromTo(el,
        { opacity: 0 },
        {
          opacity: 1,
          scrollTrigger: { trigger: el, start: 'top 85%', end: 'top 30%', scrub: true }
        }
      );
    });

    // slide-left
    document.querySelectorAll('.reveal.slide-left').forEach((el) => {
      gsap.fromTo(el,
        { opacity: 0, x: -30 },
        {
          opacity: 1, x: 0,
          scrollTrigger: { trigger: el, start: 'top 85%', end: 'top 30%', scrub: true }
        }
      );
    });

    // slide-right
    document.querySelectorAll('.reveal.slide-right').forEach((el) => {
      gsap.fromTo(el,
        { opacity: 0, x: 30 },
        {
          opacity: 1, x: 0,
          scrollTrigger: { trigger: el, start: 'top 85%', end: 'top 30%', scrub: true }
        }
      );
    });

    // flip (rotateY)
    document.querySelectorAll('.reveal.flip').forEach((el) => {
      gsap.fromTo(el,
        { opacity: 0, rotateY: 90, transformOrigin: 'left center' },
        {
          opacity: 1, rotateY: 0,
          scrollTrigger: { trigger: el, start: 'top 85%', end: 'top 30%', scrub: true }
        }
      );
    });

    // scale-up
    document.querySelectorAll('.reveal.scale-up').forEach((el) => {
      gsap.fromTo(el,
        { opacity: 0, scale: 0.8 },
        {
          opacity: 1, scale: 1,
          scrollTrigger: { trigger: el, start: 'top 85%', end: 'top 30%', scrub: true }
        }
      );
    });

    // Gentle parallax on card/project thumbnails (tied to scroll)
    document.querySelectorAll('.card .thumb, .project-card .thumb').forEach((el) => {
      gsap.fromTo(el,
        { yPercent: -6 },
        {
          yPercent: 6,
          scrollTrigger: { trigger: el, start: 'top 90%', end: 'bottom 10%', scrub: true }
        }
      );
    });

    // Skill bars fill with scroll progress
    document.querySelectorAll('.skill .bar > i').forEach((bar) => {
      const target = getVarWidth(bar); // numeric percent
      gsap.fromTo(bar,
        { width: '0%' },
        {
          width: target + '%',
          scrollTrigger: {
            trigger: bar.closest('.skill') || bar,
            start: 'top 85%',
            end:   'top 30%',
            scrub: true
          }
        }
      );
    });

    // Back-to-top visibility polish (optional)
    const btt = document.getElementById('backToTop');
    if (btt) {
      ScrollTrigger.create({
        start: 200,
        onUpdate: (self) => {
          if (self.scroll() > 200) btt.classList.add('show');
          else btt.classList.remove('show');
        }
      });
    }
    // ===== Extra fun per-section animations (all scrubbed) =====

// 1) ABOUT — Avatar parallax + gentle tilt
const avatar = document.querySelector('.hello .avatar');
if (avatar) {
  gsap.fromTo(avatar,
    { yPercent: -6, rotate: -2 },
    { yPercent: 6, rotate: 2,
      scrollTrigger: { trigger: '#about', start: 'top top', end: 'bottom top', scrub: true }
    }
  );
}

// 1a) ABOUT — Pill chips float & brighten as you scroll in
gsap.utils.toArray('.hello .pill').forEach((pill) => {
  gsap.fromTo(pill,
    { y: 12, opacity: 0.6 },
    { y: -12, opacity: 1,
      scrollTrigger: { trigger: '#about', start: 'top 80%', end: 'top 20%', scrub: true }
    }
  );
});

// 2) FEATURED — Cards fade/slide in (no scrub for smoother perf)
if (document.querySelector('#featured .cards')) {
  gsap.set('#featured .card', { transformPerspective: 600 });
  gsap.fromTo('#featured .card',
    { opacity: 0, y: 24 },
    { opacity: 1, y: 0, stagger: 0.12, duration: 0.8,
      scrollTrigger: { trigger: '#featured', start: 'top 80%', toggleActions: 'play none none none' }
    }
  );
}

// 3) PROJECTS — Cascade rise (no scrub)
gsap.fromTo('#projects .project-card',
  { opacity: 0, y: 26 },
  { opacity: 1, y: 0, stagger: 0.08, duration: 0.7,
    scrollTrigger: { trigger: '#projects', start: 'top 75%', toggleActions: 'play none none none' }
  }
);

// 3a) PROJECTS — Thumb scale-in once (no scrub)
gsap.utils.toArray('#projects .project-card .thumb').forEach((thumb) => {
  gsap.fromTo(thumb, { scale: 0.98 }, {
    scale: 1.0, duration: 0.5,
    scrollTrigger: { trigger: thumb.closest('.project-card'), start: 'top 85%', toggleActions: 'play none none none' }
  });
});

// 4) EXPERIENCE — Timeline items slide in (no scrub)
gsap.fromTo('#experience .xp-item',
  { opacity: 0, x: -14 },
  { opacity: 1, x: 0, stagger: 0.1, duration: 0.6,
    scrollTrigger: { trigger: '#experience', start: 'top 80%', toggleActions: 'play none none none' }
  }
);

// 4a) EXPERIENCE — Fade in the timeline dots as the items appear
gsap.utils.toArray('#experience .xp-item').forEach((li) => {
  gsap.fromTo(li, { '--dot-opacity': 0 }, {
    '--dot-opacity': 1,
    scrollTrigger: { trigger: li, start: 'top 90%', end: 'top 50%', scrub: true },
    onUpdate: (self) => {
      if (self && typeof self.progress === 'function') {
        li.style.setProperty('--dot-opacity', self.progress().toFixed(3));
      }
    }
  });
});

// 5) SKILLS — Percentage counters that rise with the bar fill
document.querySelectorAll('#skills .skill .bar').forEach((wrap) => {
  let label = wrap.querySelector('.bar-label');
  const fill = wrap.querySelector('i');
  if (!label && fill) {
    label = document.createElement('span');
    label.className = 'bar-label';
    wrap.style.position = 'relative';
    label.style.position = 'absolute';
    label.style.right = '8px';
    label.style.top = '-22px';
    label.style.fontWeight = '800';
    label.style.fontSize = '.8rem';
    label.style.opacity = '0.9';
    wrap.appendChild(label);
  }
  if (fill && label) {
    const target = parseFloat(getComputedStyle(fill).getPropertyValue('--w')) || 0;
    const obj = { val: 0 };
    gsap.to(obj, {
      val: target,
      scrollTrigger: { trigger: wrap.closest('.skill') || wrap, start: 'top 85%', end: 'top 30%', scrub: true },
      onUpdate: () => { label.textContent = Math.round(obj.val) + '%'; }
    });
  }
});

// 6) WRITING — Cards rise (no scrub)
gsap.fromTo('#writing .talk-card',
  { opacity: 0, y: 20 },
  { opacity: 1, y: 0, stagger: 0.08, duration: 0.6,
    scrollTrigger: { trigger: '#writing', start: 'top 80%', toggleActions: 'play none none none' }
  }
);

// 7) CONTACT — Visitor map frame lifts slightly
const mapFrame = document.querySelector('.visitor-map-frame');
if (mapFrame) {
  gsap.fromTo(mapFrame, { y: 20, boxShadow: '0 0 0 rgba(0,0,0,0)' }, {
    y: 0, boxShadow: '0 12px 28px rgba(0,0,0,.22)', duration: 0.5,
    scrollTrigger: { trigger: '#contact', start: 'top 85%', toggleActions: 'play none none none' }
  });
}

// 8) NAV — Active link highlight based on scroll position (fixes Skills highlighting ask)
['about','featured','projects','experience','skills','writing','contact'].forEach((id) => {
  const link = document.querySelector(`.nav-links a[href="#${id}"]`);
  if (!link) return;
  ScrollTrigger.create({
    trigger: `#${id}`,
    start: 'top 40%',
    end: 'bottom 40%',
    onEnter: () => link.setAttribute('aria-current', 'true'),
    onEnterBack: () => link.setAttribute('aria-current', 'true'),
    onLeave: () => link.removeAttribute('aria-current'),
    onLeaveBack: () => link.removeAttribute('aria-current')
  });
});
  } else {
    // Light animation mode: rely on CSS reveal (IntersectionObserver above) and skip GSAP
    document.querySelectorAll('.reveal').forEach(el => el.classList.add('visible'));
  }

</script>
<script>
// As a safety net, refresh ScrollTrigger after full load
window.addEventListener('load', () => {
  try { if (window.ScrollTrigger) ScrollTrigger.refresh(); } catch(_) {}
});
</script>
</body>
</html>

    
